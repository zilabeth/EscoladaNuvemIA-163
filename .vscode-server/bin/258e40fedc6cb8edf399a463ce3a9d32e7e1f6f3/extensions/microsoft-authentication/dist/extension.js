/*! For license information please see extension.js.LICENSE.txt */
(()=>{var e={8197:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Environment:()=>n});var n=function(){function e(e){if(this.validateAuthority=!0,!e||"object"!=typeof e)throw new Error("'parameters' is a required parameter and must be of type 'object'.");["name","portalUrl","managementEndpointUrl","resourceManagerEndpointUrl","activeDirectoryEndpointUrl","activeDirectoryResourceId"].forEach((function(t){if(!e[t]||"string"!=typeof e[t].valueOf())throw new Error('Please provide "'+t+'" for the environment and it must be of type "string".')})),this.name=e.name,this.portalUrl=e.portalUrl,this.managementEndpointUrl=e.managementEndpointUrl,this.resourceManagerEndpointUrl=e.resourceManagerEndpointUrl,this.activeDirectoryEndpointUrl=e.activeDirectoryEndpointUrl,this.activeDirectoryResourceId=e.activeDirectoryResourceId,this.activeDirectoryGraphApiVersion&&(this.activeDirectoryGraphApiVersion=e.activeDirectoryGraphApiVersion),this.activeDirectoryGraphResourceId&&(this.activeDirectoryGraphResourceId=e.activeDirectoryGraphResourceId),this.azureDataLakeAnalyticsCatalogAndJobEndpointSuffix&&(this.azureDataLakeAnalyticsCatalogAndJobEndpointSuffix=e.azureDataLakeAnalyticsCatalogAndJobEndpointSuffix),this.azureDataLakeStoreFileSystemEndpointSuffix&&(this.azureDataLakeStoreFileSystemEndpointSuffix=e.azureDataLakeStoreFileSystemEndpointSuffix),this.batchResourceId&&(this.batchResourceId=e.batchResourceId),this.galleryEndpointUrl&&(this.galleryEndpointUrl=e.galleryEndpointUrl),this.keyVaultDnsSuffix&&(this.keyVaultDnsSuffix=e.keyVaultDnsSuffix),this.publishingProfileUrl&&(this.publishingProfileUrl=e.publishingProfileUrl),this.sqlManagementEndpointUrl&&(this.sqlManagementEndpointUrl=e.sqlManagementEndpointUrl),this.sqlServerHostnameSuffix&&(this.sqlServerHostnameSuffix=e.sqlServerHostnameSuffix),this.storageEndpointSuffix&&(this.storageEndpointSuffix=e.storageEndpointSuffix)}return e.add=function(t){var r={},n=new e(t);r[t.name]=n,Object.assign(e,r)},e.get=function(t){if(!t)throw new TypeError("name cannot be null or undefined and must be of type string.");return e[t]},e.AzureCloud={name:"AzureCloud",portalUrl:"https://portal.azure.com",publishingProfileUrl:"https://go.microsoft.com/fwlink/?LinkId=254432",managementEndpointUrl:"https://management.core.windows.net",resourceManagerEndpointUrl:"https://management.azure.com/",sqlManagementEndpointUrl:"https://management.core.windows.net:8443/",sqlServerHostnameSuffix:".database.windows.net",galleryEndpointUrl:"https://gallery.azure.com/",activeDirectoryEndpointUrl:"https://login.microsoftonline.com/",activeDirectoryResourceId:"https://management.core.windows.net/",activeDirectoryGraphResourceId:"https://graph.windows.net/",batchResourceId:"https://batch.core.windows.net/",activeDirectoryGraphApiVersion:"2013-04-05",storageEndpointSuffix:"core.windows.net",keyVaultDnsSuffix:".vault.azure.net",azureDataLakeStoreFileSystemEndpointSuffix:"azuredatalakestore.net",azureDataLakeAnalyticsCatalogAndJobEndpointSuffix:"azuredatalakeanalytics.net",validateAuthority:!0},e.ChinaCloud={name:"AzureChinaCloud",portalUrl:"https://portal.azure.cn",publishingProfileUrl:"https://go.microsoft.com/fwlink/?LinkID=301774",managementEndpointUrl:"https://management.core.chinacloudapi.cn",resourceManagerEndpointUrl:"https://management.chinacloudapi.cn",sqlManagementEndpointUrl:"https://management.core.chinacloudapi.cn:8443/",sqlServerHostnameSuffix:".database.chinacloudapi.cn",galleryEndpointUrl:"https://gallery.chinacloudapi.cn/",activeDirectoryEndpointUrl:"https://login.chinacloudapi.cn/",activeDirectoryResourceId:"https://management.core.chinacloudapi.cn/",activeDirectoryGraphResourceId:"https://graph.chinacloudapi.cn/",activeDirectoryGraphApiVersion:"2013-04-05",batchResourceId:"https://batch.chinacloudapi.cn/",storageEndpointSuffix:"core.chinacloudapi.cn",keyVaultDnsSuffix:".vault.azure.cn",azureDataLakeStoreFileSystemEndpointSuffix:"N/A",azureDataLakeAnalyticsCatalogAndJobEndpointSuffix:"N/A",validateAuthority:!0},e.USGovernment={name:"AzureUSGovernment",portalUrl:"https://portal.azure.us",publishingProfileUrl:"https://manage.windowsazure.us/publishsettings/index",managementEndpointUrl:"https://management.core.usgovcloudapi.net",resourceManagerEndpointUrl:"https://management.usgovcloudapi.net",sqlManagementEndpointUrl:"https://management.core.usgovcloudapi.net:8443/",sqlServerHostnameSuffix:".database.usgovcloudapi.net",galleryEndpointUrl:"https://gallery.usgovcloudapi.net/",activeDirectoryEndpointUrl:"https://login.microsoftonline.us/",activeDirectoryResourceId:"https://management.core.usgovcloudapi.net/",activeDirectoryGraphResourceId:"https://graph.windows.net/",batchResourceId:"https://batch.core.usgovcloudapi.net/",activeDirectoryGraphApiVersion:"2013-04-05",storageEndpointSuffix:"core.usgovcloudapi.net",keyVaultDnsSuffix:".vault.usgovcloudapi.net",azureDataLakeStoreFileSystemEndpointSuffix:"N/A",azureDataLakeAnalyticsCatalogAndJobEndpointSuffix:"N/A",validateAuthority:!0},e.GermanCloud={name:"AzureGermanCloud",portalUrl:"https://portal.microsoftazure.de/",publishingProfileUrl:"https://manage.microsoftazure.de/publishsettings/index",managementEndpointUrl:"https://management.core.cloudapi.de",resourceManagerEndpointUrl:"https://management.microsoftazure.de",sqlManagementEndpointUrl:"https://management.core.cloudapi.de:8443/",sqlServerHostnameSuffix:".database.cloudapi.de",galleryEndpointUrl:"https://gallery.cloudapi.de/",activeDirectoryEndpointUrl:"https://login.microsoftonline.de/",activeDirectoryResourceId:"https://management.core.cloudapi.de/",activeDirectoryGraphResourceId:"https://graph.cloudapi.de/",batchResourceId:"https://batch.microsoftazure.de/",activeDirectoryGraphApiVersion:"2013-04-05",storageEndpointSuffix:"core.cloudapi.de",keyVaultDnsSuffix:".vault.microsoftazure.de",azureDataLakeStoreFileSystemEndpointSuffix:"N/A",azureDataLakeAnalyticsCatalogAndJobEndpointSuffix:"N/A",validateAuthority:!0},e}()},956:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ActiveStatus:()=>k.f,AppInsightsCore:()=>p,BaseTelemetryPlugin:()=>T.s,DiagnosticLogger:()=>c.wq,EventLatency:()=>v,EventPersistence:()=>w,EventPropertyType:()=>y,EventsDiscardedReason:()=>b.x,FullVersionString:()=>d.xE,InternalAppInsightsCore:()=>u._,LoggingSeverity:()=>S,MinChannelPriorty:()=>A,NotificationManager:()=>E.h,PerfEvent:()=>s.Q6,PerfManager:()=>s.NS,ProcessTelemetryContext:()=>_.W0,SenderPostManager:()=>H.v,TraceLevel:()=>C,Undefined:()=>N.bA,ValueKind:()=>m,ValueSanitizer:()=>I,Version:()=>d.Rx,_InternalLogMessage:()=>c.WD,__getRegisteredEvents:()=>P.El,_appendHeader:()=>R.LU,_getAllResponseHeaders:()=>R.w3,_logInternalMessage:()=>c.Oc,_testHookMaxUnloadHooksCb:()=>B.d,_throwInternal:()=>c.ZP,_warnToConsole:()=>c.OG,addEventHandler:()=>P.So,addEventListeners:()=>P.lQ,addPageHideEventListener:()=>P.Fc,addPageShowEventListener:()=>P.oS,addPageUnloadEventListener:()=>P.ee,areCookiesSupported:()=>D.gi,arrForEach:()=>o.Iuo,arrIndexOf:()=>o.rDm,arrMap:()=>o.W$7,arrReduce:()=>o.KTd,attachEvent:()=>P.Q3,blockDynamicConversion:()=>q.V9,convertAllHeadersToMap:()=>R.IL,cookieAvailable:()=>D.gi,createCookieMgr:()=>D.xN,createDynamicConfig:()=>a.e,createEnumStyle:()=>g.H,createGuid:()=>d.gj,createProcessTelemetryContext:()=>_.i8,createTraceParent:()=>F.wk,createUniqueNamespace:()=>L.Z,createUnloadHandlerContainer:()=>U.P,dateNow:()=>o.f0d,detachEvent:()=>P.Ym,disallowsSameSiteNone:()=>D.It,doPerf:()=>s.r2,dumpObj:()=>o.mmD,eventOff:()=>P.ML,eventOn:()=>P.mB,extend:()=>d.X$,findW3cTraceParent:()=>F.ef,forceDynamicConversion:()=>q.Hf,formatErrorMessageXdr:()=>R.HU,formatErrorMessageXhr:()=>R.r4,formatTraceParent:()=>F.L0,generateW3CId:()=>O.cL,getCommonSchemaMetaData:()=>d.Go,getConsole:()=>x.U5,getCookieValue:()=>d.UM,getCrypto:()=>x.MY,getDocument:()=>o.YEm,getDynamicConfigHandler:()=>q.QA,getExceptionName:()=>R.lL,getFieldValueType:()=>d.cq,getGlobal:()=>o.mS$,getGlobalInst:()=>o.zS2,getHistory:()=>o.JKf,getIEVersion:()=>x.L0,getISOString:()=>R._u,getJSON:()=>x.hm,getLocation:()=>x.g$,getMsCrypto:()=>x.iN,getNavigator:()=>o.w3n,getPerformance:()=>o.FJj,getResponseText:()=>R.Lo,getSetValue:()=>R.c2,getTenantId:()=>d.EO,getTime:()=>d.WB,getWindow:()=>o.zkX,hasDocument:()=>o.Wtk,hasHistory:()=>o.twz,hasJSON:()=>x.Z,hasNavigator:()=>o.w9M,hasOwnProperty:()=>o.v0u,hasWindow:()=>o.Vdv,isArray:()=>o.cyL,isArrayValid:()=>d.wJ,isBeaconsSupported:()=>x.Uf,isBoolean:()=>o.Lmq,isChromium:()=>d.F2,isDate:()=>o.$PY,isDocumentObjectAvailable:()=>d.g8,isError:()=>o.bJ7,isFetchSupported:()=>x.R7,isFunction:()=>o.Tnt,isGreaterThanZero:()=>d.ei,isIE:()=>x.lT,isLatency:()=>d.Hh,isNotTruthy:()=>o.woc,isNullOrUndefined:()=>o.hXl,isNumber:()=>o.EtT,isObject:()=>o.Gvm,isReactNative:()=>x.lV,isSampledFlag:()=>F.N7,isString:()=>o.KgX,isTruthy:()=>o.zzB,isTypeof:()=>o.Edw,isUint8ArrayAvailable:()=>d.h3,isUndefined:()=>o.b07,isValidSpanId:()=>F.wN,isValidTraceId:()=>F.hX,isValidTraceParent:()=>F.mJ,isValueAssigned:()=>d.yD,isValueKind:()=>d.m0,isWindowObjectAvailable:()=>d.P$,isXhrSupported:()=>x.xk,mergeEvtNamespace:()=>P.Hm,newGuid:()=>O.aq,newId:()=>M.Si,normalizeJsName:()=>R.cH,objDefineAccessors:()=>o.raO,objForEachKey:()=>o.zav,objFreeze:()=>o.N6t,objKeys:()=>o.cGk,objSeal:()=>o.jsL,onConfigChange:()=>a.a,openXhr:()=>d.H$,optimizeObject:()=>R.hW,parseResponse:()=>j.x,parseTraceParent:()=>F.ZI,perfNow:()=>o.UUD,prependTransports:()=>R.jL,proxyAssign:()=>R.qz,proxyFunctionAs:()=>R.RF,proxyFunctions:()=>R.o$,random32:()=>M.VN,randomValue:()=>M.Z1,removeEventHandler:()=>P.zh,removeEventListeners:()=>P.Wg,removePageHideEventListener:()=>P.sq,removePageShowEventListener:()=>P.vF,removePageUnloadEventListener:()=>P.Ds,safeGetCookieMgr:()=>D.um,safeGetLogger:()=>c.y0,sanitizeProperty:()=>d.TC,setEnableEnvMocks:()=>x.cU,setProcessTelemetryTimings:()=>d.u9,setValue:()=>R.KY,strContains:()=>R.Ju,strEndsWith:()=>o.Cv9,strFunction:()=>N.hW,strObject:()=>N._1,strPrototype:()=>N.vR,strStartsWith:()=>o.tGl,strTrim:()=>o.EHq,strUndefined:()=>N.bA,throwError:()=>o.$8,toISOString:()=>R._u,useXDomainRequest:()=>x.PV});var n=r(659),i=r(8279),o=r(269),s=r(8156),a=r(9749),c=r(3775),u=r(2774),l=r(937),d=r(4822),h=r(1739),f=(0,o.ZHX)({endpointUrl:l.S,propertyStorageOverride:{isVal:function(e){return!e||e.getProperty&&e.setProperty||(0,o.$8)("Invalid property storage override passed."),!0}}}),p=function(e){function t(){var r=e.call(this)||this;return(0,i.A)(t,r,(function(e,t){e[h.mE]=function(r,n,i,u){(0,s.r2)(e,(function(){return"AppInsightsCore.initialize"}),(function(){try{t[h.mE]((0,a.e)(r,f,i||e[h.Uw],!1).cfg,n,i,u)}catch(t){var s=e[h.Uw],l=(0,o.mmD)(t);-1!==l[h.Sj]("channels")&&(l+="\n - Channels must be provided through config.channels only!"),(0,c.ZP)(s,1,514,"SDK Initialization Failed - no telemetry will be sent: "+l)}}),(function(){return{config:r,extensions:n,logger:i,notificationManager:u}}))},e.track=function(r){(0,s.r2)(e,(function(){return"AppInsightsCore.track"}),(function(){var n=r;if(n){n[h.dg]=n[h.dg]||{},n[h.dg].trackStart=(0,d.WB)(),(0,d.Hh)(n.latency)||(n.latency=1);var i=n.ext=n.ext||{};i.sdk=i.sdk||{},i.sdk.ver=d.xE;var o=n.baseData=n.baseData||{};o[l._0]=o[l._0]||{};var s=o[l._0];s[l.hj]=s[l.hj]||e.pluginVersionString||l.m5}t.track(n)}),(function(){return{item:r}}),!r.sync)},e[h.h4]=function(e){return t[h.h4](e||"InternalLog")}})),r}return(0,n.qU)(t,e),t.__ieDyn=1,t}(u._),g=r(4282),m=(0,g.H)({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,Pii_IPv6ScrubLastHextets:14,Pii_DropValue:15,CustomerContent_GenericContent:32}),v=(0,g.H)({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),y=(0,g.H)({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),w=(0,g.H)({Normal:1,Critical:2}),C=(0,g.H)({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),I=function(){function e(e){var t=this,r={},n=[],i=[];function s(e,t){var s,a=r[e];if(a&&(s=a[t]),!s&&null!==s){if((0,o.KgX)(e)&&(0,o.KgX)(t))if(i[h.oI]>0){for(var c=0;c<i[h.oI];c++)if(i[c][h.hF](e,t)){s={canHandle:!0,fieldHandler:i[c]};break}}else 0===n[h.oI]&&(s={canHandle:!0});if(!s&&null!==s)for(s=null,c=0;c<n[h.oI];c++)if(n[c][h.hF](e,t)){s={canHandle:!0,handler:n[c],fieldHandler:null};break}a||(a=r[e]={}),a[t]=s}return s}function a(e,t,r,n,i,s){if(e.handler)return e.handler.property(t,r,i,s);if(!(0,o.hXl)(i[h.QV])){if(!(4096&~n&&(0,d.m0)(i[h.QV])))return null;i[h.pF]=i[h.pF].toString()}return u(e.fieldHandler,t,r,n,i)}function c(e,t,r){return(0,d.yD)(r)?{value:r}:null}function u(e,r,n,i,s){if(s&&e){var a=e.getSanitizer(r,n,i,s[h.QV],s.propertyType);if(a)if(4===i){var l={},f=s[h.pF];(0,o.zav)(f,(function(t,i){var o=r+"."+n;if((0,d.yD)(i)){var s=c(0,0,i);(s=u(e,o,t,(0,d.cq)(i),s))&&(l[t]=s[h.pF])}})),s[h.pF]=l}else{var p={path:r,name:n,type:i,prop:s,sanitizer:t};s=a.call(t,p)}}return s}e&&i.push(e),t.clearCache=function(){r={}},t.addSanitizer=function(e){e&&((0,o.Nq2)(n,e)||n.push(e),r={})},t.addFieldSanitizer=function(e){e&&((0,o.Nq2)(i,e)||i.push(e),r={})},t[h.Rl]=function(e){if(e){var t=(0,o.rDm)(n,e);-1!==t&&(n.splice(t,1),r={}),(0,o.Iuo)(n,(function(t){t&&t[h.Rl]&&t[h.Rl](e)}))}},t[h.Mr]=function(e){if(e){var t=(0,o.rDm)(i,e);-1!==t&&(i.splice(t,1),r={}),(0,o.Iuo)(n,(function(t){t&&t[h.Mr]&&t[h.Mr](e)}))}},t.isEmpty=function(){return(0,o.R3R)(n)+(0,o.R3R)(i)===0},t[h.hF]=function(e,t){var r=s(e,t);return!!r&&r[h.nw]},t[h.pF]=function(e,t,r,n){var i=s(e,t);if(i&&i[h.nw]){if(!i||!i[h.nw])return null;if(i.handler)return i.handler[h.pF](e,t,r,n);if(!(0,o.KgX)(t)||(0,o.hXl)(r)||r===l.m5)return null;var u=null,f=(0,d.cq)(r);if(8192&~f)1!==f&&2!==f&&3!==f&&4096&~f?4===f&&(u=c(0,0,n?JSON.stringify(r):r)):u=c(0,0,r);else{var p=-8193&f;if(u=r,!(0,d.yD)(u[h.pF])||1!==p&&2!==p&&3!==p&&4096&~p)return null}if(u)return a(i,e,t,f,u,n)}return null},t.property=function(e,t,r,n){var i=s(e,t);if(!i||!i[h.nw])return null;if(!(0,o.KgX)(t)||(0,o.hXl)(r)||!(0,d.yD)(r[h.pF]))return null;var c=(0,d.cq)(r[h.pF]);return 0===c?null:a(i,e,t,c,r,n)}}return e.getFieldType=d.cq,e}(),A=100,S=(0,g.H)({DISABLED:0,CRITICAL:1,WARNING:2,DEBUG:3}),E=r(1356),T=r(8257),_=r(2317),b=r(3662),k=r(4875),P=r(6149),R=r(3673),O=r(9882),M=r(6535),x=r(7292),N=r(5664),D=r(5034),L=r(4276),U=r(836),F=r(1864),q=r(9147),H=r(856),j=r(1190),B=r(8969)},937:(e,t,r)=>{"use strict";r.d(t,{S:()=>i,_0:()=>s,hj:()=>o,m5:()=>n});var n="",i="https://browser.events.data.microsoft.com/OneCollector/1.0/",o="version",s="properties"},4822:(e,t,r)=>{"use strict";r.d(t,{EO:()=>I,F2:()=>N,Go:()=>T,H$:()=>D,Hh:()=>S,P$:()=>w,Rx:()=>l,TC:()=>E,UM:()=>_,WB:()=>P,X$:()=>k,cq:()=>x,ei:()=>L,g8:()=>y,gj:()=>b,h3:()=>A,m0:()=>R,u9:()=>M,wJ:()=>O,xE:()=>d,yD:()=>C});var n,i=r(269),o=r(7292),s=r(9882),a=r(5664),c=r(937),u=r(1739),l="4.3.4",d="1DS-Web-JS-"+l,h=a.Wy.hasOwnProperty,f="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",p="withCredentials",g="timeout",m=((n={})[0]=0,n[2]=6,n[1]=1,n[3]=7,n[4098]=6,n[4097]=1,n[4099]=7,n),v=null,y=(0,i.Wtk)(),w=(0,i.Vdv)();function C(e){return!(e===c.m5||(0,i.hXl)(e))}function I(e){if(e){var t=(0,i.HzD)(e,"-");if(t>-1)return(0,i.ZWZ)(e,t)}return c.m5}function A(){return null===v&&(v=!(0,i.b07)(Uint8Array)&&!function(){var e=(0,i.w3n)();if(!(0,i.b07)(e)&&e.userAgent){var t=e.userAgent.toLowerCase();if((t[u.Sj]("safari")>=0||t[u.Sj]("firefox")>=0)&&t[u.Sj]("chrome")<0)return!0}return!1}()&&!(0,o.lV)()),v}function S(e){return!!(e&&(0,i.EtT)(e)&&e>=1&&e<=4)}function E(e,t,r){if(!t&&!C(t)||"string"!=typeof e)return null;var n=typeof t;if("string"===n||"number"===n||"boolean"===n||(0,i.cyL)(t))t={value:t};else if("object"!==n||h.call(t,"value")){if((0,i.hXl)(t[u.pF])||t[u.pF]===c.m5||!(0,i.KgX)(t[u.pF])&&!(0,i.EtT)(t[u.pF])&&!(0,i.Lmq)(t[u.pF])&&!(0,i.cyL)(t[u.pF]))return null}else t={value:r?JSON.stringify(t):t};if((0,i.cyL)(t[u.pF])&&!O(t[u.pF]))return null;if(!(0,i.hXl)(t[u.QV])){if((0,i.cyL)(t[u.pF])||!R(t[u.QV]))return null;t[u.pF]=t[u.pF].toString()}return t}function T(e,t,r){var n=-1;if(!(0,i.b07)(e))if(t>0&&(32===t?n=8192:t<=13&&(n=t<<5)),function(e){return e>=0&&e<=9}(r))-1===n&&(n=0),n|=r;else{var o=m[x(e)]||-1;-1!==n&&-1!==o?n|=o:6===o&&(n=o)}return n}function _(e,t,r){var n;return void 0===r&&(r=!0),e&&(n=e.get(t),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||c.m5}function b(e){void 0===e&&(e="D");var t=(0,s.aq)();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,c.m5)),t}function k(e,t,r,n,o){var s={},a=!1,c=0,l=arguments[u.oI],d=arguments;for((0,i.Lmq)(d[0])&&(a=d[0],c++);c<l;c++)e=d[c],(0,i.zav)(e,(function(e,t){a&&t&&(0,i.Gvm)(t)?(0,i.cyL)(t)?(s[e]=s[e]||[],(0,i.Iuo)(t,(function(t,r){t&&(0,i.Gvm)(t)?s[e][r]=k(!0,s[e][r],t):s[e][r]=t}))):s[e]=k(!0,s[e],t):s[e]=t}));return s}var P=i.UUD;function R(e){return 0===e||e>0&&e<=13||32===e}function O(e){return e[u.oI]>0}function M(e,t){var r=e;r[u.dg]=r[u.dg]||{},r[u.dg][u.Jg]=r[u.dg][u.Jg]||{},r[u.dg][u.Jg][t]=P()}function x(e){var t=0;if(null!=e){var r=typeof e;"string"===r?t=1:"number"===r?t=2:"boolean"===r?t=3:r===a._1&&(t=4,(0,i.cyL)(e)?(t=4096,e[u.oI]>0&&(t|=x(e[0]))):h.call(e,"value")&&(t=8192|x(e[u.pF])))}return t}function N(){return!!(0,i.zS2)("chrome")}function D(e,t,r,n,i,o){function s(e,t,r){try{e[t]=r}catch(e){}}void 0===n&&(n=!1),void 0===i&&(i=!1);var a=new XMLHttpRequest;return n&&s(a,f,n),r&&s(a,p,r),a.open(e,t,!i),r&&s(a,p,r),!i&&o&&s(a,g,o),a}function L(e){return e>0}},1739:(e,t,r)=>{"use strict";r.d(t,{Jg:()=>d,Mr:()=>p,QV:()=>u,Rl:()=>f,Sj:()=>o,Uw:()=>i,dg:()=>s,h4:()=>a,hF:()=>h,mE:()=>n,nw:()=>g,oI:()=>l,pF:()=>c});var n="initialize",i="logger",o="indexOf",s="timings",a="pollInternalLogs",c="value",u="kind",l="length",d="processTelemetryStart",h="handleField",f="rmSanitizer",p="rmFieldSanitizer",g="canHandle"},8916:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BE_PROFILE:()=>o,NRT_PROFILE:()=>i,PostChannel:()=>It,RT_PROFILE:()=>n});var n="REAL_TIME",i="NEAR_REAL_TIME",o="BEST_EFFORT",s=r(659),a=r(8279),c=r(4822),u=r(269),l=r(8156),d=r(6149),h=r(4276),f=r(9749),p=r(2317),g=r(3673),m=r(3662),v=r(3775),y=r(8257),w=r(8205),C="",I="drop",A="requeue",S="no-cache, no-store",E="application/x-json-stream",T="cache-control",_="content-type",b="client-version",k="client-id",P="time-delta-to-apply-millis",R="upload-time",O="apikey",M="AuthMsaDeviceTicket",x="WebAuthToken",N="AuthXToken",D="msfpc",L="trace",U="user",F="allowRequestSending",q="firstRequestSent",H="shouldAddClockSkewHeaders",j="getClockSkewHeaderValue",B="setClockSkew",$="length",z="concat",V="iKey",K="count",G="events",W="push",X="split",Y="splice",Q="toLowerCase",J="hdrs",Z="useHdrs",ee="initialize",te="setTimeoutOverride",re="clearTimeoutOverride",ne="overrideEndpointUrl",ie="avoidOptions",oe="enableCompoundKey",se="disableXhrSync",ae="disableFetchKeepAlive",ce="useSendBeacon",ue="fetchCredentials",le="alwaysUseXhrOverride",de="serializeOfflineEvt",he="getOfflineRequestDetails",fe="createPayload",pe="createOneDSPayload",ge="payloadBlob",me="headers",ve="_thePayload",ye="urlString",we="batches",Ce="sendType",Ie="addHeader",Ae="canSendRequest",Se="sendQueuedRequests",Ee="isCompletelyIdle",Te="setUnloading",_e="resume",be="sendSynchronousBatch",ke="_transport",Pe="getWParam",Re="isBeacon",Oe="timings",Me="isTeardown",xe="isSync",Ne="data",De="_sendReason",Le="setKillSwitchTenants",Ue="_backOffTransmission",Fe="identifier",qe="eventsLimitInMem",He="autoFlushEventsLimit",je="baseData",Be="sendAttempt",$e="latency",ze="sync";function Ve(e){var t=(e.ext||{}).intweb;return t&&(0,c.yD)(t[D])?t[D]:null}function Ke(e){for(var t=null,r=0;null===t&&r<e[$];r++)t=Ve(e[r]);return t}var Ge=function(){function e(t,r){var n=r?[][z](r):[],i=this,o=Ke(n);i[V]=function(){return t},i.Msfpc=function(){return o||C},i[K]=function(){return n[$]},i[G]=function(){return n},i.addEvent=function(e){return!!e&&(n[W](e),o||(o=Ve(e)),!0)},i[X]=function(r,i){var s;if(r<n[$]){var a=n[$]-r;(0,u.hXl)(i)||(a=i<a?i:a),s=n[Y](r,a),o=Ke(n)}return new e(t,s)}}return e.create=function(t,r){return new e(t,r)},e}(),We=r(7292),Xe=r(856),Ye=r(5664),Qe=function(){function e(){var t=!0,r=!0,n=!0,i="use-collector-delta",o=!1;(0,a.A)(e,this,(function(e){e[F]=function(){return t},e[q]=function(){n&&(n=!1,o||(t=!1))},e[H]=function(){return r},e[j]=function(){return i},e[B]=function(e){o||(e?(i=e,r=!0,o=!0):r=!1,t=!0)}}))}return e.__ieDyn=1,e}(),Je=function(){function e(){var t={};(0,a.A)(e,this,(function(e){e[Le]=function(e,r){if(e&&r)try{var n=(s=e[X](","),a=[],s&&(0,u.Iuo)(s,(function(e){a[W]((0,u.EHq)(e))})),a);if("this-request-only"===r)return n;for(var i=1e3*parseInt(r,10),o=0;o<n[$];++o)t[n[o]]=(0,u.f0d)()+i}catch(e){return[]}var s,a;return[]},e.isTenantKilled=function(e){var r=t,n=(0,u.EHq)(e);return void 0!==r[n]&&r[n]>(0,u.f0d)()||(delete r[n],!1)}}))}return e.__ieDyn=1,e}();function Ze(e){var t,r=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*r,Math.min(t,6e5)}var et,tt=2e6,rt=Math.min(tt,65e3),nt="metadata",it="f",ot=/\./,st=function(){function e(t,r,n,i,o,s){var d="data",h="baseData",f=!!i,p=!0,g=r,m={},v=!!s,y=o||c.Go;(0,a.A)(e,this,(function(e){function r(e,t,i,o,s,a,l){(0,u.zav)(e,(function(e,d){var h=null;if(d||(0,c.yD)(d)){var p=i,v=e,y=s,w=t;if(f&&!o&&ot.test(e)){var C=e.split("."),I=C.length;if(I>1){y&&(y=y.slice());for(var A=0;A<I-1;A++){var S=C[A];w=w[S]=w[S]||{},p+="."+S,y&&y.push(S)}v=C[I-1]}}var E=o&&function(e,t){var r=m[e];return void 0===r&&(e.length>=7&&(r=(0,u.tGl)(e,"ext.metadata")||(0,u.tGl)(e,"ext.web")),m[e]=r),r}(p);if(h=!E&&g&&g.handleField(p,v)?g.value(p,v,d,n):(0,c.TC)(v,d,n)){var T=h.value;if(w[v]=T,a&&a(y,v,h),l&&"object"==typeof T&&!(0,u.cyL)(T)){var _=y;_&&(_=_.slice()).push(v),r(d,T,p+"."+v,o,_,a,l)}}}}))}e.createPayload=function(e,t,r,n,i,o){return{apiKeys:[],payloadBlob:C,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:r,isBeacon:n,sendType:o,sendReason:i}},e.appendPayload=function(r,n,i){var o=r&&n&&!r.overflow;return o&&(0,l.r2)(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=n.events(),o=r.payloadBlob,s=r.numEvents,a=!1,c=[],l=[],d=r.isBeacon,h=d?65e3:3984588,f=d?rt:tt,p=0,g=0;p<t.length;){var m=t[p];if(m){if(s>=i){r.overflow=n.split(p);break}var v=e.getEventBlob(m);if(v&&v.length<=f){var y=v.length;if(o.length+y>h){r.overflow=n.split(p);break}o&&(o+="\n"),o+=v,++g>20&&((0,u.hKY)(o,0,1),g=0),a=!0,s++}else v?c.push(m):l.push(m),t.splice(p,1),p--}p++}if(c.length>0&&r.sizeExceed.push(Ge.create(n.iKey(),c)),l.length>0&&r.failedEvts.push(Ge.create(n.iKey(),l)),a){r.batches.push(n),r.payloadBlob=o,r.numEvents=s;var w=n.iKey();-1===(0,u.rDm)(r.apiKeys,w)&&r.apiKeys.push(w)}}),(function(){return{payload:r,theBatch:{iKey:n.iKey(),evts:n.events()},max:i}})),o},e.getEventBlob=function(e){try{return(0,l.r2)(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+(0,c.EO)(e.iKey);var n,i={};v||(n=function(e,t,r){!function(e,t,r,n,i){if(i&&t){var o=e(i.value,i.kind,i.propertyType);if(o>-1){var s=t[nt];s||(s=t[nt]={f:{}});var a=s[it];if(a||(a=s[it]={}),r)for(var c=0;c<r.length;c++){var l=r[c];a[l]||(a[l]={f:{}});var d=a[l][it];d||(d=a[l][it]={}),a=d}a=a[n]={},(0,u.cyL)(i.value)?a.a={t:o}:a.t=o}}}(y,i,e,t,r)});var o=e.ext;o&&(t.ext=i,(0,u.zav)(o,(function(e,t){r(t,i[e]={},"ext."+e,!0,null,null,!0)})));var s=t[d]={};s.baseType=e.baseType;var a=s[h]={};return r(e.baseData,a,h,!1,[h],n,p),r(e.data,s,d,!1,[],n,p),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function at(e,t){return{set:function(r,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];return(0,u.vKV)([e,t],r,n,i)}}}var ct="sendAttempt",ut="?cors=true&"+_[Q]()+"="+E,lt=((et={})[1]=A,et[100]=A,et[200]="sent",et[8004]=I,et[8003]=I,et),dt={},ht={};function ft(e,t,r){dt[e]=t,!1!==r&&(ht[t]=e)}function pt(e,t){var r=!1;if(e&&t){var n=(0,u.cGk)(e);if(n&&n[$]>0)for(var i=t[Q](),o=0;o<n[$];o++){var s=n[o];if(s&&(0,u.v0u)(t,s)&&s[Q]()===i){r=!0;break}}}return r}function gt(e,t,r,n){t&&r&&r[$]>0&&(n&&dt[t]?(e[J][dt[t]]=r,e[Z]=!0):e.url+="&"+t+"="+r)}ft(M,M,!1),ft(b,b),ft(k,"Client-Id"),ft(O,O),ft(P,P),ft(R,R),ft(N,N);var mt=function(){function e(t,r,n,i){var o,s,d,h,p,m,y,w,A,M,x,N,L,U,Q,Fe,qe,He,je,Be,$e,ze,Ve,Ke,et,tt,rt,nt,it,ot,dt,ft,mt=!1;(0,a.A)(e,this,(function(e){function a(e,t){try{return dt&&dt.getSenderInst(e,t)}catch(e){}return null}function vt(){try{return{enableSendPromise:!1,isOneDs:!0,disableCredentials:!1,fetchCredentials:ft,disableXhr:!1,disableBeacon:!mt,disableBeaconSync:!mt,disableFetchKeepAlive:$e,timeWrapper:it,addNoResponse:Ve,senderOnCompleteCallBack:{xdrOnComplete:yt,fetchOnComplete:wt,xhrOnComplete:Ct,beaconOnRetry:At}}}catch(e){}return null}function yt(e,t,r){var n=(0,g.Lo)(e);It(t,200,{},n),Nt(n)}function wt(e,t,r,n){var i={},o=e[me];o&&o.forEach((function(e,t){i[t]=e})),function(e,r,n){It(t,e,r,n),Nt(n)}(e.status,i,r||C)}function Ct(e,t,r){var n=(0,g.Lo)(e);It(t,e.status,(0,g.w3)(e,!0),n),Nt(n)}function It(e,t,r,n){try{e(t,r,n)}catch(e){(0,v.ZP)(y,2,518,(0,u.mmD)(e))}}function At(e,t,r){var n=200,i=e[ve],o=e[ye]+(Ve?"&NoResponseBody=true":C);try{var s=(0,u.w3n)();if(i){var a=!!A.getPlugin("LocalStorage"),c=[],l=[];(0,u.Iuo)(i[we],(function(e){if(c&&e&&e[K]()>0)for(var t=e[G](),r=0;r<t[$];r++){if(!s.sendBeacon(o,U.getEventBlob(t[r]))){c[W](e[X](r));break}l[W](e[r])}else c[W](e[X](0))})),l[$]>0&&(i.sentEvts=l),a||Dt(c,8003,i[Ce],!0)}else n=0}catch(e){(0,v.OG)(y,"Failed to send telemetry using sendBeacon API. Ex:"+(0,u.mmD)(e)),n=0}finally{It(t,n,{},C)}}function St(e){return 2===e||3===e}function Et(e){return qe&&St(e)&&(e=2),e}function Tt(){return!d&&p<r}function _t(){var e=L;return L=[],e}function bt(e,t,r){var n=!1;return e&&e[$]>0&&!d&&w[t]&&U&&(n=0!==t||Tt()&&(r>0||h[F]())),n}function kt(e){var t={};return e&&(0,u.Iuo)(e,(function(e,r){t[r]={iKey:e[V](),evts:e[G]()}})),t}function Pt(e,r,n,i,o){if(e&&0!==e[$])if(d)Dt(e,1,i);else{i=Et(i);try{var a=e,h=0!==i;(0,l.r2)(A,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var u=[],l=null,d=(0,c.WB)(),f=w[i]||(h?w[1]:w[0]),p=f&&f[ke],g=ze&&(qe||St(i)||3===p||f._isSync&&2===p);bt(e,i,r);){var m=e.shift();m&&m[K]()>0&&(s.isTenantKilled(m[V]())?u[W](m):(l=l||U[fe](r,n,h,g,o,i),U.appendPayload(l,m,t)?null!==l.overflow&&(e=[l.overflow][z](e),l.overflow=null,Mt(l,d,(0,c.WB)(),o),d=(0,c.WB)(),l=null):(Mt(l,d,(0,c.WB)(),o),d=(0,c.WB)(),e=[m][z](e),l=null)))}l&&Mt(l,d,(0,c.WB)(),o),e[$]>0&&(L=e[z](L)),Dt(u,8004,i)}),(function(){return{batches:kt(a),retryCount:r,isTeardown:n,isSynchronous:h,sendReason:o,useSendBeacon:St(i),sendType:i}}),!h)}catch(e){(0,v.ZP)(y,2,48,"Unexpected Exception sending batch: "+(0,u.mmD)(e))}}}function Rt(e,t){var r={url:o,hdrs:{},useHdrs:!1};t?(r[J]=(0,c.X$)(r[J],N),r.useHdrs=(0,u.cGk)(r.hdrs)[$]>0):(0,u.zav)(N,(function(e,t){ht[e]?gt(r,ht[e],t,!1):(r[J][e]=t,r[Z]=!0)})),gt(r,k,"NO_AUTH",t),gt(r,b,c.xE,t);var n=C;(0,u.Iuo)(e.apiKeys,(function(e){n[$]>0&&(n+=","),n+=e})),gt(r,O,n,t),gt(r,R,(0,u.f0d)().toString(),t);var i=function(e){for(var t=0;t<e.batches[$];t++){var r=e[we][t].Msfpc();if(r)return encodeURIComponent(r)}return C}(e);if((0,c.yD)(i)&&(r.url+="&ext.intweb.msfpc="+i),h[H]()&&gt(r,P,h[j](),t),A[Pe]){var s=A[Pe]();s>=0&&(r.url+="&w="+s)}for(var a=0;a<x[$];a++)r.url+="&"+x[a].name+"="+x[a].value;return r}function Ot(e,t,r){e[t]=e[t]||{},e[t][m.identifier]=r}function Mt(t,r,i,o){if(t&&t.payloadBlob&&t.payloadBlob[$]>0){var a=!!et,d=w[t.sendType];!St(t[Ce])&&t[Re]&&2===t.sendReason&&(d=w[2]||w[3]||d);var f=He;(t.isBeacon||3===d[ke])&&(f=!1);var g=Rt(t,f);f=f||g[Z];var C=(0,c.WB)();(0,l.r2)(A,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var w=0;w<t.batches[$];w++)for(var I=t[we][w][G](),b=0;b<I[$];b++){var k=I[b];if(Q){var P=k[Oe]=k[Oe]||{};Ot(P,"sendEventStart",C),Ot(P,"serializationStart",r),Ot(P,"serializationCompleted",i)}k[ct]>0?k[ct]++:k[ct]=1}Dt(t[we],1e3+(o||0),t[Ce],!0);var R={data:t[ge],urlString:g.url,headers:g[J],_thePayload:t,_sendReason:o,timeout:je,disableXhrSync:Be,disableFetchKeepAlive:$e};f&&(pt(R[me],T)||(R[me][T]=S),pt(R[me],_)||(R[me][_]=E));var O=null;d&&(O=function(r){h[q]();var i=function(r,i){!function(t,r,i,o){var a,l=9e3,d=null,f=!1,g=!1;try{var v=!0;if(typeof t!==Ye.bA){if(r){h[B](r["time-delta-millis"]);var y=r["kill-duration"]||r["kill-duration-seconds"];(0,u.Iuo)(s[Le](r["kill-tokens"],y),(function(e){(0,u.Iuo)(i[we],(function(t){if(t[V]()===e){d=d||[];var r=t[X](0);i.numEvents-=r[K](),d[W](r)}}))}))}if(200==t||204==t)return void(l=200);((a=t)>=300&&a<500&&429!=a||501==a||505==a||i.numEvents<=0)&&(v=!1),l=9e3+t%1e3}if(v){l=100;var w=i.retryCnt;0===i[Ce]&&(w<n?(f=!0,xt((function(){0===i[Ce]&&p--,Pt(i[we],w+1,i[Me],qe?2:i[Ce],5)}),qe,Ze(w))):(g=!0,qe&&(l=8001)))}}finally{f||(h[B](),function(t,r,n,i){try{i&&m[Ue]();var o=t[we];200===r&&(o=t.sentEvts||t[we],i||t[xe]||m._clearBackOff(),function(e){if(Q){var t=(0,c.WB)();(0,u.Iuo)(e,(function(e){e&&e[K]()>0&&function(e,t){Q&&(0,u.Iuo)(e,(function(e){Ot(e[Oe]=e[Oe]||{},"sendEventCompleted",t)}))}(e[G](),t)}))}}(o)),Dt(o,r,t[Ce],!0)}finally{0===t[Ce]&&(p--,5!==n&&e.sendQueuedRequests(t[Ce],n))}}(i,l,o,g)),Dt(d,8004,i[Ce])}}(r,i,t,o)},a=t[Me]||t[xe];try{d.sendPOST(r,i,a),tt&&tt(R,r,a,t[Re])}catch(e){(0,v.OG)(y,"Unexpected exception sending payload. Ex:"+(0,u.mmD)(e)),It(i,0,{})}}),(0,l.r2)(A,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(O)if(0===t[Ce]&&p++,a&&!t.isBeacon&&3!==d[ke]){var e={data:R[Ne],urlString:R[ye],headers:(0,c.X$)({},R[me]),timeout:R.timeout,disableXhrSync:R[se],disableFetchKeepAlive:R[ae]},r=!1;(0,l.r2)(A,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{et(e,(function(e){r=!0,M||e[ve]||(e[ve]=e[ve]||R[ve],e[De]=e[De]||R[De]),O(e)}),t.isSync||t[Me])}catch(e){r||O(R)}}))}else O(R)}))}),(function(){return{thePayload:t,serializationStart:r,serializationCompleted:i,sendReason:o}}),t[xe])}t.sizeExceed&&t.sizeExceed[$]>0&&Dt(t.sizeExceed,8003,t[Ce]),t.failedEvts&&t.failedEvts[$]>0&&Dt(t.failedEvts,8002,t[Ce])}function xt(e,t,r){t?e():it.set(e,r)}function Nt(e){var t=rt;try{for(var r=0;r<t[$];r++)try{t[r](e)}catch(e){(0,v.ZP)(y,1,519,"Response handler failed: "+e)}if(e){var n=JSON.parse(e);(0,c.yD)(n.webResult)&&(0,c.yD)(n.webResult[D])&&Fe.set("MSFPC",n.webResult[D],31536e3)}}catch(e){}}function Dt(e,t,r,n){if(e&&e[$]>0&&i){var o=i[(a=t,u=lt[a],(0,c.yD)(u)||(u="oth",a>=9e3&&a<=9999?u="rspFail":a>=8e3&&a<=8999?u=I:a>=1e3&&a<=1999&&(u="send")),u)];if(o){var s=0!==r;(0,l.r2)(A,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){xt((function(){try{o.call(i,e,t,s,r)}catch(e){(0,v.ZP)(y,1,74,"send request notification failed: "+e)}}),n||s,0)}),(function(){return{batches:kt(e),reason:t,isSync:s,sendSync:n,sendType:r}}),!s)}}var a,u}!function(){var e;o=null,s=new Je,d=!1,h=new Qe,mt=!1,p=0,m=null,y=null,w=null,A=null,M=!0,x=[],N={},L=[],U=null,Q=!1,Fe=null,qe=!1,He=!1,je=e,Be=e,$e=e,ze=e,Ve=e,Ke=[],et=e,tt=e,rt=[],nt=!1,it=at(),ot=!1,dt=null}(),e[ee]=function(e,t,r){nt||(A=t,Fe=t.getCookieMgr(),y=(m=r).diagLog(),(0,u.Yny)(Ke,(0,f.a)(e,(function(e){var n,i=e.cfg,s=e.cfg.extensionConfig[r.identifier];it=at(s[te],s[re]),(0,c.yD)(i.anonCookieName)?function(e,t,r){for(var n=0;n<e[$];n++)if(e[n].name===t)return void(e[n].value=r);e[W]({name:t,value:r})}(x,"anoncknm",i.anonCookieName):function(e,t){for(var r=0;r<e[$];r++)if("anoncknm"===e[r].name)return void e[Y](r,1)}(x),et=s.payloadPreprocessor,tt=s.payloadListener;var l=s.httpXHROverride,d=s[ne]?s[ne]:i.endpointUrl;o=d+ut,He=!!(0,u.b07)(s[ie])||!s[ie],Q=!s.disableEventTimings;var h=s.valueSanitizer,f=s.stringifyObjects,p=!!i[oe];(0,u.b07)(s[oe])||(p=!!s[oe]),je=s.xhrTimeout,Be=!!s[se],$e=!!s[ae],Ve=!1!==s.addNoResponse,ot=!!s.excludeCsMetaData,t.getPlugin("LocalStorage")&&($e=!0),mt=!(0,We.lV)(),U=new st(A,h,f,p,c.Go,ot),(0,u.hXl)(s[ce])||(mt=!!s[ce]),s[ue]&&(ft=s[ue]);var m=vt();dt?dt.SetConfig(m):(dt=new Xe.v)[ee](m,y);var C=l,I=s[le]?l:null,S=s[le]?l:null,E=[3,2];if(!l){M=!1;var T=[];(0,We.lV)()?(T=[2,1],E=[2,1,3]):T=[1,2,3],(l=a(T=(0,g.jL)(T,s.transports),!1))||(0,v.OG)(y,"No available transport to send events"),C=a(T,!0)}I||(I=a(E=(0,g.jL)(E,s.unloadTransports),!0)),ze=!M&&(mt&&(0,We.Uf)()||!$e&&(0,We.R7)(!0)),(n={})[0]=l,n[1]=C||a([1,2,3],!0),n[2]=I||C||a([1],!0),n[3]=S||a([2,3],!0)||C||a([1],!0),w=n}))),nt=!0)},e.addResponseHandler=function(e){return rt[W](e),{rm:function(){var t=rt.indexOf(e);t>=0&&rt[Y](t,1)}}},e[de]=function(e){try{if(U)return U.getEventBlob(e)}catch(e){}return C},e[he]=function(){try{return Rt(U&&U[fe](0,!1,!1,!1,1,0),He)}catch(e){}return null},e[pe]=function(e,r){try{var n=[];(0,u.Iuo)(e,(function(e){r&&(e=(0,g.hW)(e));var t=Ge.create(e[V],[e]);n[W](t)}));for(var i=null;n[$]>0&&U;){var o=n.shift();o&&o[K]()>0&&(i=i||U[fe](0,!1,!1,!1,1,0),U.appendPayload(i,o,t))}var s=Rt(i,He),a={data:i[ge],urlString:s.url,headers:s[J],timeout:je,disableXhrSync:Be,disableFetchKeepAlive:$e};return He&&(pt(a[me],T)||(a[me][T]=S),pt(a[me],_)||(a[me][_]=E)),a}catch(e){}return null},e._getDbgPlgTargets=function(){return[w[0],s,U,w,vt(),o]},e[Ie]=function(e,t){N[e]=t},e.removeHeader=function(e){delete N[e]},e[Ae]=function(){return Tt()&&h[F]()},e[Se]=function(e,t){(0,u.b07)(e)&&(e=0),qe&&(e=Et(e),t=2),bt(L,e,0)&&Pt(_t(),0,!1,e,t||0)},e[Ee]=function(){return!d&&0===p&&0===L[$]},e[Te]=function(e){qe=e},e.addBatch=function(e){if(e&&e[K]()>0){if(s.isTenantKilled(e[V]()))return!1;L[W](e)}return!0},e.teardown=function(){L[$]>0&&Pt(_t(),0,!0,2,2),(0,u.Iuo)(Ke,(function(e){e&&e.rm&&e.rm()})),Ke=[]},e.pause=function(){d=!0},e[_e]=function(){d=!1,e[Se](0,4)},e[be]=function(e,t,r){e&&e[K]()>0&&((0,u.hXl)(t)&&(t=1),qe&&(t=Et(t),r=2),Pt([e],0,!1,t,r||0))}}))}return e.__ieDyn=1,e}(),vt=1e4,yt="eventsDiscarded",wt=void 0,Ct=(0,u.ZHX)({eventsLimitInMem:{isVal:c.ei,v:vt},immediateEventLimit:{isVal:c.ei,v:500},autoFlushEventsLimit:{isVal:c.ei,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:function(e){return e&&e.sendPOST},v:wt},overrideInstrumentationKey:wt,overrideEndpointUrl:wt,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:wt,clearTimeoutOverride:wt,payloadPreprocessor:wt,payloadListener:wt,disableEventTimings:wt,valueSanitizer:wt,stringifyObjects:wt,enableCompoundKey:wt,disableOptimizeObj:!1,fetchCredentials:wt,transports:wt,unloadTransports:wt,useSendBeacon:wt,disableFetchKeepAlive:wt,avoidOptions:!1,xhrTimeout:wt,disableXhrSync:wt,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:u.EtT,v:6},maxUnloadEventRetryAttempts:{isVal:u.EtT,v:2},addNoResponse:wt,excludeCsMetaData:wt}),It=function(e){function t(){var r,s=e.call(this)||this;s.identifier="PostChannel",s.priority=1011,s.version="4.3.4";var y,C,I,A,S,E,T,_,b,k,P,R,O,N,D,F,q,H,j,B,Q,J,Z,ne,ie,oe=!1,se=[],ae=!1,ce=0,ue=0,le={},fe=n;return(0,a.A)(t,s,(function(e,t){function s(){(0,d.Ds)(null,H),(0,d.sq)(null,H),(0,d.vF)(null,H)}function a(e){var t="";return e&&e[$]&&(0,u.Iuo)(e,(function(e){t&&(t+="\n"),t+=e})),t}function ge(e){var t="";try{ye(e),t=_[de](e)}catch(e){}return t}function me(e){"beforeunload"!==(e||(0,u.zkX)().event).type&&(D=!0,_[Te](D)),Le(2,2)}function ve(e){D=!1,_[Te](D)}function ye(e){e.ext&&e.ext[L]&&delete e.ext[L],e.ext&&e.ext[U]&&e.ext[U].id&&delete e.ext[U].id,N&&(e.ext=(0,g.hW)(e.ext),e[je]&&(e[je]=(0,g.hW)(e[je])),e[Ne]&&(e[Ne]=(0,g.hW)(e[Ne])))}function Ce(e,t){if(e[Be]||(e[Be]=0),e[$e]||(e[$e]=1),ye(e),e[ze])if(E||ae)e[$e]=3,e[ze]=!1;else if(_)return N&&(e=(0,g.hW)(e)),void _[be](Ge.create(e[V],[e]),!0===e[ze]?1:e[ze],3);var r=e[$e],n=ue,i=I;4===r&&(n=ce,i=C);var o=!1;if(n<i)o=!We(e,t);else{var s=1,a=20;4===r&&(s=4,a=1),o=!0,function(e,t,r,n){for(;r<=t;){var i=Ve(e,t,!0);if(i&&i[K]()>0){var o=i[X](0,n),s=o[K]();if(s>0)return 4===r?ce-=s:ue-=s,it(yt,[o],m.x.QueueFull),!0}r++}return Xe(),!1}(e[V],e[$e],s,a)&&(o=!We(e,t))}o&&nt(yt,[e],m.x.QueueFull)}function ke(e,t,r){var n=Ye(e,t,r);return _[Se](t,r),n}function Re(){return ue>0}function Oe(){if(R>=0&&Ye(R,0,O)&&_[Se](0,O),ce>0&&!S&&!ae){var e=le[fe][2];e>=0&&(S=xe((function(){S=null,ke(4,0,1),Oe()}),e))}var t=le[fe][1];!A&&!y&&t>=0&&!ae&&(Re()?A=xe((function(){A=null,ke(0===T?3:1,0,1),T++,T%=2,Oe()}),t):T=0)}function Me(){r=null,oe=!1,se=[],y=null,ae=!1,ce=0,C=500,ue=0,I=vt,le={},fe=n,A=null,S=null,E=0,T=0,b={},k=0,Z=!1,P=0,R=-1,O=null,N=!0,D=!1,F=6,q=2,H=null,ne=null,ie=!1,j=at(),_=new mt(500,2,1,{requeue:tt,send:ot,sent:st,drop:ct,rspFail:ut,oth:lt}),et(),b[4]={batches:[],iKeyMap:{}},b[3]={batches:[],iKeyMap:{}},b[2]={batches:[],iKeyMap:{}},b[1]={batches:[],iKeyMap:{}},dt()}function xe(e,t){0===t&&E&&(t=1);var r=1e3;return E&&(r=Ze(E-1)),j.set(e,t*r)}function De(){return null!==A&&(A.cancel(),A=null,T=0,!0)}function Le(e,t){De(),y&&(y.cancel(),y=null),ae||ke(1,e,t)}function Ve(e,t,r){var n=b[t];n||(n=b[t=1]);var i=n.iKeyMap[e];return!i&&r&&(i=Ge.create(e),n.batches[W](i),n.iKeyMap[e]=i),i}function Ke(t,r){_[Ae]()&&!E&&(k>0&&ue>k&&(r=!0),r&&null==y&&e.flush(t,(function(){}),20))}function We(e,t){N&&(e=(0,g.hW)(e));var r=e[$e],n=Ve(e[V],r,!0);return!!n.addEvent(e)&&(4!==r?(ue++,t&&0===e[Be]&&Ke(!e.sync,P>0&&n[K]()>=P)):ce++,!0)}function Xe(){for(var e=0,t=0,r=function(r){var n=b[r];n&&n[we]&&(0,u.Iuo)(n[we],(function(n){4===r?e+=n[K]():t+=n[K]()}))},n=1;n<=4;n++)r(n);ue=t,ce=e}function Ye(t,r,n){var i=!1,o=0===r;return!o||_[Ae]()?(0,l.r2)(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],r=4;r>=t;){var n=b[r];n&&n.batches&&n.batches[$]>0&&((0,u.Iuo)(n[we],(function(t){_.addBatch(t)?i=i||t&&t[K]()>0:e=e[z](t[G]()),4===r?ce-=t[K]():ue-=t[K]()})),n[we]=[],n.iKeyMap={}),r--}e[$]>0&&nt(yt,e,m.x.KillSwitch),i&&R>=t&&(R=-1,O=0)}),(function(){return{latency:t,sendType:r,sendReason:n}}),!o):(R=R>=0?Math.min(R,t):t,O=Math.max(O,n)),i}function Qe(e,t){ke(1,0,t),Xe(),Je((function(){e&&e(),se[$]>0?y=xe((function(){y=null,Qe(se.shift(),t)}),0):(y=null,Oe())}))}function Je(e){_[Ee]()?e():y=xe((function(){y=null,Je(e)}),.25)}function et(){(le={})[n]=[2,1,0],le[i]=[6,3,0],le[o]=[18,9,0]}function tt(t,r){var n=[],i=F;D&&(i=q),(0,u.Iuo)(t,(function(t){t&&t[K]()>0&&(0,u.Iuo)(t[G](),(function(t){t&&(t[ze]&&(t[$e]=4,t[ze]=!1),t[Be]<i?((0,c.u9)(t,e[Fe]),Ce(t,!1)):n[W](t))}))})),n[$]>0&&nt(yt,n,m.x.NonRetryableStatus),D&&Le(2,2)}function rt(t,r){var n=J||{},i=n[t];if(i)try{i.apply(n,r)}catch(r){(0,v.ZP)(e.diagLog(),1,74,t+" notification failed: "+r)}}function nt(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t[$]>0&&rt(e,[t][z](r))}function it(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t[$]>0&&(0,u.Iuo)(t,(function(t){t&&t[K]()>0&&rt(e,[t.events()][z](r))}))}function ot(e,t,r){e&&e[$]>0&&rt("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==r])}function st(e,t){it("eventsSent",e,t),Oe()}function ct(e,t){it(yt,e,t>=8e3&&t<=8999?t-8e3:m.x.Unknown)}function ut(e){it(yt,e,m.x.NonRetryableStatus),Oe()}function lt(e,t){it(yt,e,m.x.Unknown),Oe()}function dt(){P=Q?0:Math.max(1500,I/6)}Me(),e._getDbgPlgTargets=function(){return[_,r]},e[ee]=function(n,i,o){(0,l.r2)(i,(function(){return"PostChannel:initialize"}),(function(){t[ee](n,i,o),J=i.getNotifyMgr();try{H=(0,d.Hm)((0,h.Z)(e[Fe]),i.evtNamespace&&i.evtNamespace()),e._addHook((0,f.a)(n,(function(t){var n=t.cfg,o=(0,p.i8)(null,n,i);r=o.getExtCfg(e[Fe],Ct),j=at(r[te],r[re]),N=!r.disableOptimizeObj&&(0,c.F2)(),B=r.ignoreMc1Ms0CookieProcessing,function(e){var t=e[Pe];e[Pe]=function(){var r=0;return B&&(r|=2),r|t.call(e)}}(i),I=r[qe],C=r.immediateEventLimit,k=r[He],F=r.maxEventRetryAttempts,q=r.maxUnloadEventRetryAttempts,Q=r.disableAutoBatchFlushLimit,(0,u.$XS)(n.endpointUrl)?e.pause():ae&&e[_e](),dt(),ne=r.overrideInstrumentationKey,ie=!!r.disableTelemetry,Z&&s();var a=n.disablePageUnloadEvents||[];Z=(0,d.ee)(me,a,H),Z=(0,d.Fc)(me,a,H)||Z,Z=(0,d.oS)(ve,n.disablePageShowEvents,H)||Z}))),_[ee](n,e.core,e)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{theConfig:n,core:i,extensions:o}}))},e.processTelemetry=function(t,r){(0,c.u9)(t,e[Fe]),r=r||e._getTelCtx(r);var n=t;ie||oe||(ne&&(n[V]=ne),Ce(n,!0),D?Le(2,2):Oe()),e.processNext(n,r)},e.getOfflineSupport=function(){try{var e=_&&_[he]();if(_)return{getUrl:function(){return e?e.url:null},serialize:ge,batch:a,shouldProcess:function(e){return!ie},createPayload:function(e){return null},createOneDSPayload:function(e){if(_[pe])return _[pe](e,N)}}}catch(e){}return null},e._doTeardown=function(e,t){Le(2,2),oe=!0,_.teardown(),s(),Me()},e.setEventQueueLimits=function(e,t){r[qe]=I=(0,c.ei)(e)?e:vt,r[He]=k=(0,c.ei)(t)?t:0,dt();var n=ue>e;if(!n&&P>0)for(var i=1;!n&&i<=3;i++){var o=b[i];o&&o[we]&&(0,u.Iuo)(o[we],(function(e){e&&e[K]()>=P&&(n=!0)}))}Ke(!0,n)},e.pause=function(){De(),ae=!0,_&&_.pause()},e[_e]=function(){ae=!1,_&&_[_e](),Oe()},e._loadTransmitProfiles=function(e){De(),et(),fe=n,Oe(),(0,u.zav)(e,(function(e,t){var r=t[$];if(r>=2){var n=r>2?t[2]:0;if(t[Y](0,r-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}n>=0&&t[1]>=0&&n>t[1]&&(n=t[1]),t[W](n),le[e]=t}}))},e.flush=function(e,t,r){var n;if(void 0===e&&(e=!0),!ae)if(r=r||1,e)t||(n=(0,w.Qo)((function(e){t=e}))),null==y?(De(),Ye(1,0,r),y=xe((function(){y=null,Qe(t,r)}),0)):se[W](t);else{var i=De();ke(1,1,r),t&&t(),i&&Oe()}return n},e.setMsaAuthTicket=function(e){_[Ie](M,e)},e.setAuthPluginHeader=function(e){_[Ie](x,e)},e.removeAuthPluginHeader=function(){_.removeHeader(x)},e.hasEvents=Re,e._setTransmitProfile=function(e){fe!==e&&void 0!==le[e]&&(De(),fe=e,Oe())},(0,g.o$)(e,(function(){return _}),["addResponseHandler"]),e[Ue]=function(){E<4&&(E++,De(),Oe())},e._clearBackOff=function(){E&&(E=0,De(),Oe())}})),s}return(0,s.qU)(t,e),t.__ieDyn=1,t}(y.s)},4484:(e,t,r)=>{"use strict";r.d(t,{F:()=>u,H:()=>c});var n=r(269),i=r(5025),o=r(5130),s=";",a="=";function c(e){if(!e)return{};var t=e[o.sY](s),r=(0,n.KTd)(t,(function(e,t){var r=t[o.sY](a);if(2===r[o.oI]){var n=r[0][o.OL](),i=r[1];e[n]=i}return e}),{});if((0,n.cGk)(r)[o.oI]>0){if(r.endpointsuffix){var c=r.location?r.location+".":"";r[o.zV]=r[o.zV]||"https://"+c+"dc."+r.endpointsuffix}r[o.zV]=r[o.zV]||i._G,(0,n.Cv9)(r[o.zV],"/")&&(r[o.zV]=r[o.zV].slice(0,-1))}return r}var u={parse:c}},5025:(e,t,r)=>{"use strict";r.d(t,{R2:()=>u,_G:()=>a,jp:()=>o,ks:()=>l,tU:()=>i,wc:()=>c,xF:()=>n,ym:()=>s});var n="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i="sampleRate",o="ProcessLegacy",s="http.method",a="https://dc.services.visualstudio.com",c="/v2/track",u="not_specified",l="iKey"},7374:(e,t,r)=>{"use strict";r.d(t,{eL:()=>i,iD:()=>s,uG:()=>o});var n=r(4282),i=(0,n.H)({LocalStorage:0,SessionStorage:1}),o=(0,n.H)({AI:0,AI_AND_W3C:1,W3C:2}),s=(0,n.H)({Normal:1,Critical:2})},87:(e,t,r)=>{"use strict";r.d(t,{Dt:()=>s,Y8:()=>c,bb:()=>a,vv:()=>u});var n=r(269),i=r(5130),o="";function s(e,t){return void 0===t&&(t=!1),null==e?t:"true"===e.toString()[i.OL]()}function a(e){(isNaN(e)||e<0)&&(e=0),e=Math.round(e);var t=o+e%1e3,r=o+Math.floor(e/1e3)%60,n=o+Math.floor(e/6e4)%60,s=o+Math.floor(e/36e5)%24,a=Math.floor(e/864e5);return t=1===t[i.oI]?"00"+t:2===t[i.oI]?"0"+t:t,r=r[i.oI]<2?"0"+r:r,n=n[i.oI]<2?"0"+n:n,s=s[i.oI]<2?"0"+s:s,(a>0?a+".":o)+s+":"+n+":"+r+"."+t}function c(e,t){var r=null;return(0,n.Iuo)(e,(function(e){if(e.identifier===t)return r=e,-1})),r}function u(e,t,r,i,o){return!o&&(0,n.KgX)(e)&&("Script error."===e||"Script error"===e)}},8596:(e,t,r)=>{"use strict";r.d(t,{o:()=>p});var n=r(659),i=r(3673);function o(e){var t="ai."+e+".";return function(e){return t+e}}var s=o("application"),a=o("device"),c=o("location"),u=o("operation"),l=o("session"),d=o("user"),h=o("cloud"),f=o("internal"),p=function(e){function t(){return e.call(this)||this}return(0,n.qU)(t,e),t}((0,i.SZ)({applicationVersion:s("ver"),applicationBuild:s("build"),applicationTypeId:s("typeId"),applicationId:s("applicationId"),applicationLayer:s("layer"),deviceId:a("id"),deviceIp:a("ip"),deviceLanguage:a("language"),deviceLocale:a("locale"),deviceModel:a("model"),deviceFriendlyName:a("friendlyName"),deviceNetwork:a("network"),deviceNetworkName:a("networkName"),deviceOEMName:a("oemName"),deviceOS:a("os"),deviceOSVersion:a("osVersion"),deviceRoleInstance:a("roleInstance"),deviceRoleName:a("roleName"),deviceScreenResolution:a("screenResolution"),deviceType:a("type"),deviceMachineName:a("machineName"),deviceVMName:a("vmName"),deviceBrowser:a("browser"),deviceBrowserVersion:a("browserVersion"),locationIp:c("ip"),locationCountry:c("country"),locationProvince:c("province"),locationCity:c("city"),operationId:u("id"),operationName:u("name"),operationParentId:u("parentId"),operationRootId:u("rootId"),operationSyntheticSource:u("syntheticSource"),operationCorrelationVector:u("correlationVector"),sessionId:l("id"),sessionIsFirst:l("isFirst"),sessionIsNew:l("isNew"),userAccountAcquisitionDate:d("accountAcquisitionDate"),userAccountId:d("accountId"),userAgent:d("userAgent"),userId:d("id"),userStoreRegion:d("storeRegion"),userAuthUserId:d("authUserId"),userAnonymousUserAcquisitionDate:d("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:d("authUserAcquisitionDate"),cloudName:h("name"),cloudRole:h("role"),cloudRoleVer:h("roleVer"),cloudRoleInstance:h("roleInstance"),cloudEnvironment:h("environment"),cloudLocation:h("location"),cloudDeploymentUnit:h("deploymentUnit"),internalNodeName:f("nodeName"),internalSdkVersion:f("sdkVersion"),internalAgentVersion:f("agentVersion"),internalSnippet:f("snippet"),internalSdkSrc:f("sdkSrc")}))},9762:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var n=(0,r(4282).H)({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})},1575:(e,t,r)=>{"use strict";r.d(t,{F:()=>i,O:()=>o});var n=r(8596),i={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},o=new n.o},7952:(e,t,r)=>{"use strict";r.d(t,{G:()=>c});var n=r(6149),i=r(269),o=r(4276),s=r(5130);function a(e,t){(0,n.ML)(e,null,null,t)}function c(e){var t=(0,i.YEm)(),r=(0,i.w3n)(),c=!1,u=[],l=1;!r||(0,i.hXl)(r.onLine)||r.onLine||(l=2);var d=0,h=m(),f=(0,n.Hm)((0,o.Z)("OfflineListener"),e);try{if(g((0,i.zkX)())&&(c=!0),t){var p=t.body||t;p.ononline&&g(p)&&(c=!0)}}catch(e){c=!1}function g(e){var t=!1;return e&&(t=(0,n.mB)(e,"online",y,f))&&(0,n.mB)(e,"offline",w,f),t}function m(){return 2!==d&&2!==l}function v(){var e=m();h!==e&&(h=e,(0,i.Iuo)(u,(function(e){var t={isOnline:h,rState:l,uState:d};try{e(t)}catch(e){}})))}function y(){l=1,v()}function w(){l=2,v()}return{isOnline:function(){return h},isListening:function(){return c},unload:function(){var e=(0,i.zkX)();if(e&&c){if(a(e,f),t){var r=t.body||t;(0,i.b07)(r.ononline)||a(r,f)}c=!1}},addListener:function(e){return u[s.y5](e),{rm:function(){var t=u.indexOf(e);return t>-1?u.splice(t,1):void 0}}},setOnlineState:function(e){d=e,v()}}}},2910:(e,t,r)=>{"use strict";r.d(t,{a:()=>n});var n=(0,r(4282).o)({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})},4658:(e,t,r)=>{"use strict";r.d(t,{AN:()=>I,BW:()=>v,Dt:()=>E,Nu:()=>p,Se:()=>y,T9:()=>A,_M:()=>w,iw:()=>m,tm:()=>C,v7:()=>T,vH:()=>S,vh:()=>g});var n=r(269),i=r(3775),o=r(3673),s=r(7374),a=r(5130),c=void 0,u=void 0,l="";function d(){return v()?h(s.eL.LocalStorage):null}function h(e){try{if((0,n.hXl)((0,n.mS$)()))return null;var t=(new Date)[a.xE](),r=(0,n.zS2)(e===s.eL.LocalStorage?"localStorage":"sessionStorage"),i=l+t;r.setItem(i,t);var o=r.getItem(i)!==t;if(r[a.AZ](i),!o)return r}catch(e){}return null}function f(){return I()?h(s.eL.SessionStorage):null}function p(){c=!1,u=!1}function g(e){l=e||""}function m(){c=v(!0),u=I(!0)}function v(e){return(e||void 0===c)&&(c=!!h(s.eL.LocalStorage)),c}function y(e,t){var r=d();if(null!==r)try{return r.getItem(t)}catch(t){c=!1,(0,i.ZP)(e,2,1,"Browser failed read of local storage. "+(0,o.lL)(t),{exception:(0,n.mmD)(t)})}return null}function w(e,t,r){var s=d();if(null!==s)try{return s.setItem(t,r),!0}catch(t){c=!1,(0,i.ZP)(e,2,3,"Browser failed write to local storage. "+(0,o.lL)(t),{exception:(0,n.mmD)(t)})}return!1}function C(e,t){var r=d();if(null!==r)try{return r[a.AZ](t),!0}catch(t){c=!1,(0,i.ZP)(e,2,5,"Browser failed removal of local storage item. "+(0,o.lL)(t),{exception:(0,n.mmD)(t)})}return!1}function I(e){return(e||void 0===u)&&(u=!!h(s.eL.SessionStorage)),u}function A(){var e=[];return I()&&(0,n.zav)((0,n.zS2)("sessionStorage"),(function(t){e[a.y5](t)})),e}function S(e,t){var r=f();if(null!==r)try{return r.getItem(t)}catch(t){u=!1,(0,i.ZP)(e,2,2,"Browser failed read of session storage. "+(0,o.lL)(t),{exception:(0,n.mmD)(t)})}return null}function E(e,t,r){var s=f();if(null!==s)try{return s.setItem(t,r),!0}catch(t){u=!1,(0,i.ZP)(e,2,4,"Browser failed write to session storage. "+(0,o.lL)(t),{exception:(0,n.mmD)(t)})}return!1}function T(e,t){var r=f();if(null!==r)try{return r[a.AZ](t),!0}catch(t){u=!1,(0,i.ZP)(e,2,6,"Browser failed removal of session storage item. "+(0,o.lL)(t),{exception:(0,n.mmD)(t)})}return!1}},7358:(e,t,r)=>{"use strict";r.d(t,{B:()=>n});var n=function(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}},7975:(e,t,r)=>{"use strict";r.d(t,{HQ:()=>g,Rr:()=>u,Vj:()=>p,Vk:()=>d,Vt:()=>h,_T:()=>m,lq:()=>c,pJ:()=>l,qW:()=>v,xP:()=>f,zx:()=>a});var n=r(269),i=r(3775),o=r(7292),s=r(5130);function a(e,t,r){var i=t[s.oI],o=c(e,t);if(o[s.oI]!==i){for(var a=0,u=o;void 0!==r[u];)a++,u=(0,n.P0f)(o,0,147)+v(a);o=u}return o}function c(e,t){var r;return t&&(t=(0,n.EHq)((0,n.oJg)(t)))[s.oI]>150&&(r=(0,n.P0f)(t,0,150),(0,i.ZP)(e,2,57,"name is too long.  It has been truncated to 150 characters.",{name:t},!0)),r||t}function u(e,t,r){var o;return void 0===r&&(r=1024),t&&(r=r||1024,(t=(0,n.EHq)((0,n.oJg)(t)))[s.oI]>r&&(o=(0,n.P0f)(t,0,r),(0,i.ZP)(e,2,61,"string value is too long. It has been truncated to "+r+" characters.",{value:t},!0))),o||t}function l(e,t){return m(e,t,2048,66)}function d(e,t){var r;return t&&t[s.oI]>32768&&(r=(0,n.P0f)(t,0,32768),(0,i.ZP)(e,2,56,"message is too long, it has been truncated to 32768 characters.",{message:t},!0)),r||t}function h(e,t){var r;if(t){var o=""+t;o[s.oI]>32768&&(r=(0,n.P0f)(o,0,32768),(0,i.ZP)(e,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:t},!0))}return r||t}function f(e,t){if(t){var r={};(0,n.zav)(t,(function(t,c){if((0,n.Gvm)(c)&&(0,o.Z)())try{c=(0,o.hm)()[s.Jj](c)}catch(t){(0,i.ZP)(e,2,49,"custom property is not valid",{exception:t},!0)}c=u(e,c,8192),t=a(e,t,r),r[t]=c})),t=r}return t}function p(e,t){if(t){var r={};(0,n.zav)(t,(function(t,n){t=a(e,t,r),r[t]=n})),t=r}return t}function g(e,t){return t?m(e,t,128,69)[s.xE]():t}function m(e,t,r,o){var a;return t&&(t=(0,n.EHq)((0,n.oJg)(t)))[s.oI]>r&&(a=(0,n.P0f)(t,0,r),(0,i.ZP)(e,2,o,"input is too long, it has been truncated to "+r+" characters.",{data:t},!0)),a||t}function v(e){var t="00"+e;return(0,n.hKY)(t,t[s.oI]-3)}},1062:(e,t,r)=>{"use strict";r.d(t,{L:()=>a});var n=r(3673),i=r(5025),o=r(5130),s=r(7975),a=function(e,t,r){var a=this,c=this;c.ver=1,c.sampleRate=100,c.tags={},c[o.RS]=(0,s.Rr)(e,r)||i.R2,c.data=t,c.time=(0,n._u)(new Date),c.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return 100===a.sampleRate?4:1},tags:1,data:1}}},3072:(e,t,r)=>{"use strict";r.d(t,{J:()=>s});var n=r(5025),i=r(5130),o=r(7975),s=function(){function e(e,t,r,s){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var a=this;a.ver=2,a[i.RS]=(0,o.Rr)(e,t)||n.R2,a[i.$y]=(0,o.xP)(e,r),a[i.XA]=(0,o.Vj)(e,s)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}()},5397:(e,t,r)=>{"use strict";r.d(t,{WJ:()=>I});var n=r(659),i=r(269),o=r(5025),s=r(5130),a=r(7975),c="error",u="stack",l="stackDetails",d="errorSrc",h="message",f="description";function p(e,t){var r=e;return r&&!(0,i.KgX)(r)&&(JSON&&JSON[s.Jj]?(r=JSON[s.Jj](e),!t||r&&"{}"!==r||(r=(0,i.Tnt)(e[s.xE])?e[s.xE]():""+e)):r=e+" - (Missing JSON.stringify)"),r||""}function g(e,t){var r=e;return e&&(r&&!(0,i.KgX)(r)&&(r=e[h]||e[f]||r),r&&!(0,i.KgX)(r)&&(r=p(r,!0)),e.filename&&(r=r+" @"+(e.filename||"")+":"+(e.lineno||"?")+":"+(e.colno||"?"))),t&&"String"!==t&&"Object"!==t&&"Error"!==t&&-1===(0,i.HzD)(r||"",t)&&(r=t+": "+r),r||""}function m(e){return e&&e.src&&(0,i.KgX)(e.src)&&e.obj&&(0,i.cyL)(e.obj)}function v(e){var t=e||"";(0,i.KgX)(t)||(t=(0,i.KgX)(t[u])?t[u]:""+t);var r=t[s.sY]("\n");return{src:t,obj:r}}function y(e){var t=null;if(e)try{if(e[u])t=v(e[u]);else if(e[c]&&e[c][u])t=v(e[c][u]);else if(e.exception&&e.exception[u])t=v(e.exception[u]);else if(m(e))t=e;else if(m(e[l]))t=e[l];else if((0,i.zkX)()&&(0,i.zkX)().opera&&e[h])t=function(e){for(var t=[],r=e[s.sY]("\n"),n=0;n<r[s.oI];n++){var i=r[n];r[n+1]&&(i+="@"+r[n+1],n++),t[s.y5](i)}return{src:e,obj:t}}(e[s.pM]);else if(e.reason&&e.reason[u])t=v(e.reason[u]);else if((0,i.KgX)(e))t=v(e);else{var r=e[h]||e[f]||"";(0,i.KgX)(e[d])&&(r&&(r+="\n"),r+=" from "+e[d]),r&&(t=v(r))}}catch(e){t=v(e)}return t||{src:"",obj:null}}function w(e){var t="";if(e&&!(t=e.typeName||e[s.RS]||""))try{var r=/function (.{1,200})\(/.exec(e.constructor[s.xE]());t=r&&r[s.oI]>1?r[1]:""}catch(e){}return t}function C(e){if(e)try{if(!(0,i.KgX)(e)){var t=w(e),r=p(e,!1);return r&&"{}"!==r||(e[c]&&(t=w(e=e[c])),r=p(e,!0)),0!==(0,i.HzD)(r,t)&&"String"!==t?t+":"+r:r}}catch(e){}return""+(e||"")}var I=function(){function e(e,t,r,n,o,c){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var u=this;u.ver=2,function(e){try{if((0,i.Gvm)(e))return"ver"in e&&"exceptions"in e&&"properties"in e}catch(e){}return!1}(t)?(u[s.OK]=t[s.OK]||[],u[s.$y]=t[s.$y],u[s.XA]=t[s.XA],t[s.Ur]&&(u[s.Ur]=t[s.Ur]),t.id&&(u.id=t.id,t[s.$y].id=t.id),t[s.Fq]&&(u[s.Fq]=t[s.Fq]),(0,i.hXl)(t[s.r1])||(u[s.r1]=t[s.r1])):(r||(r={}),c&&(r.id=c),u[s.OK]=[new A(e,t,r)],u[s.$y]=(0,a.xP)(e,r),u[s.XA]=(0,a.Vj)(e,n),o&&(u[s.Ur]=o),c&&(u.id=c))}return e.CreateAutoException=function(e,t,r,n,i,o,a,c){var u,l=w(i||o||e);return(u={})[s.pM]=g(e,l),u.url=t,u.lineNumber=r,u.columnNumber=n,u.error=C(i||o||e),u.evt=C(o||e),u[s.qg]=l,u.stackDetails=y(a||i||o),u.errorSrc=c,u},e.CreateFromInterface=function(t,r,o,a){var c=r[s.OK]&&(0,i.W$7)(r[s.OK],(function(e){return A[s.vu](t,e)}));return new e(t,(0,n.Im)((0,n.Im)({},r),{exceptions:c}),o,a)},e.prototype.toInterface=function(){var e,t=this,r=t.exceptions,n=t.properties,o=t.measurements,a=t.severityLevel,c=t.problemGroup,u=t.id,l=t.isManual,d=r instanceof Array&&(0,i.W$7)(r,(function(e){return e.toInterface()}))||void 0;return(e={ver:"4.0"})[s.OK]=d,e.severityLevel=a,e.properties=n,e.measurements=o,e.problemGroup=c,e.id=u,e.isManual=l,e},e.CreateSimpleException=function(e,t,r,n,i,o){var a;return{exceptions:[(a={},a[s.lW]=!0,a.message=e,a.stack=i,a.typeName=t,a)]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=C,e}(),A=function(){function e(e,t,r){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var n=this;if(function(e){try{if((0,i.Gvm)(e))return"hasFullStack"in e&&"typeName"in e}catch(e){}return!1}(t))n[s.qg]=t[s.qg],n[s.pM]=t[s.pM],n[u]=t[u],n[s.on]=t[s.on]||[],n[s.lW]=t[s.lW];else{var d=t,h=d&&d.evt;(0,i.bJ7)(d)||(d=d[c]||h||d),n[s.qg]=(0,a.Rr)(e,w(d))||o.R2,n[s.pM]=(0,a.Vk)(e,g(t||d,n[s.qg]))||o.R2;var f=t[l]||y(t);n[s.on]=function(e){var t,r=e.obj;if(r&&r[s.oI]>0){t=[];var n=0,o=0;if((0,i.Iuo)(r,(function(e){var r=e[s.xE]();if(S.regex.test(r)){var i=new S(r,n++);o+=i[s.J$],t[s.y5](i)}})),o>32768)for(var a=0,c=t[s.oI]-1,u=0,l=a,d=c;a<c;){if((u+=t[a][s.J$]+t[c][s.J$])>32768){var h=d-l+1;t.splice(l,h);break}l=a,d=c,a++,c--}}return t}(f),(0,i.cyL)(n[s.on])&&(0,i.W$7)(n[s.on],(function(t){t[s.QE]=(0,a.Rr)(e,t[s.QE]),t[s.IE]=(0,a.Rr)(e,t[s.IE])})),n[u]=(0,a.Vt)(e,function(e){var t="";return e&&(e.obj?(0,i.Iuo)(e.obj,(function(e){t+=e+"\n"})):t=e.src||""),t}(f)),n.hasFullStack=(0,i.cyL)(n.parsedStack)&&n.parsedStack[s.oI]>0,r&&(r[s.qg]=r[s.qg]||n[s.qg])}}return e.prototype.toInterface=function(){var e,t=this,r=t[s.on]instanceof Array&&(0,i.W$7)(t[s.on],(function(e){return e.toInterface()}));return(e={id:t.id,outerId:t.outerId,typeName:t[s.qg],message:t[s.pM],hasFullStack:t[s.lW],stack:t[u]})[s.on]=r||void 0,e},e.CreateFromInterface=function(t,r){var o=r[s.on]instanceof Array&&(0,i.W$7)(r[s.on],(function(e){return S[s.vu](e)}))||r[s.on];return new e(t,(0,n.Im)((0,n.Im)({},r),{parsedStack:o}))},e}(),S=function(){function e(t,r){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[s.J$]=0,"string"==typeof t){var o=t;n[s.Av]=r,n[s.lx]="<no_method>",n[s.QE]=(0,i.EHq)(o),n[s.IE]="",n[s.h_]=0;var a=o.match(e.regex);a&&a[s.oI]>=5&&(n[s.lx]=(0,i.EHq)(a[2])||n[s.lx],n[s.IE]=(0,i.EHq)(a[4]),n[s.h_]=parseInt(a[5])||0)}else n[s.Av]=t[s.Av],n[s.lx]=t[s.lx],n[s.QE]=t[s.QE],n[s.IE]=t[s.IE],n[s.h_]=t[s.h_],n[s.J$]=0;n.sizeInBytes+=n.method[s.oI],n.sizeInBytes+=n.fileName[s.oI],n.sizeInBytes+=n.assembly[s.oI],n[s.J$]+=e.baseSize,n.sizeInBytes+=n.level.toString()[s.oI],n.sizeInBytes+=n.line.toString()[s.oI]}return e.CreateFromInterface=function(t){return new e(t,null)},e.prototype.toInterface=function(){var e=this;return{level:e[s.Av],method:e[s.lx],assembly:e[s.QE],fileName:e[s.IE],line:e[s.h_]}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}()},5014:(e,t,r)=>{"use strict";r.d(t,{J:()=>a});var n=r(5025),i=r(5130),o=function(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0},s=r(7975),a=function(){function e(e,t,r,a,c,u,l,d,h){this.aiDataContract={ver:1,metrics:1,properties:0};var f=this;f.ver=2;var p=new o;p[i.F2]=a>0?a:void 0,p.max=isNaN(u)||null===u?void 0:u,p.min=isNaN(c)||null===c?void 0:c,p[i.RS]=(0,s.Rr)(e,t)||n.R2,p.value=r,p.stdDev=isNaN(l)||null===l?void 0:l,f.metrics=[p],f[i.$y]=(0,s.xP)(e,d),f[i.XA]=(0,s.Vj)(e,h)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}()},1448:(e,t,r)=>{"use strict";r.d(t,{h:()=>a});var n=r(5025),i=r(87),o=r(5130),s=r(7975),a=function(){function e(e,t,r,a,c,u,l){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var d=this;d.ver=2,d.id=(0,s.HQ)(e,l),d.url=(0,s.pJ)(e,r),d[o.RS]=(0,s.Rr)(e,t)||n.R2,isNaN(a)||(d[o.qd]=(0,i.bb)(a)),d[o.$y]=(0,s.xP)(e,c),d[o.XA]=(0,s.Vj)(e,u)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}()},4164:(e,t,r)=>{"use strict";r.d(t,{H:()=>s});var n=r(5025),i=r(5130),o=r(7975),s=function(){function e(e,t,r,s,a,c,u){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=(0,o.pJ)(e,r),l[i.RS]=(0,o.Rr)(e,t)||n.R2,l[i.$y]=(0,o.xP)(e,a),l[i.XA]=(0,o.Vj)(e,c),u&&(l.domProcessing=u.domProcessing,l[i.qd]=u[i.qd],l.networkConnect=u.networkConnect,l.perfTotal=u.perfTotal,l[i.fd]=u[i.fd],l.sentRequest=u.sentRequest)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}()},1365:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(87),i=r(2318),o=r(5130),s=r(7975),a=function(){function e(e,t,r,a,c,u,l,d,h,f,p,g){void 0===h&&(h="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[o.qd]=(0,n.bb)(c),m.success=u,m.resultCode=l+"",m.type=(0,s.Rr)(e,h);var v=(0,i._U)(e,r,d,a);m.data=(0,s.pJ)(e,a)||v.data,m.target=(0,s.Rr)(e,v.target),f&&(m.target="".concat(m.target," | ").concat(f)),m[o.RS]=(0,s.Rr)(e,v[o.RS]),m[o.$y]=(0,s.xP)(e,p),m[o.XA]=(0,s.Vj)(e,g)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}()},2445:(e,t,r)=>{"use strict";r.d(t,{C:()=>s});var n=r(5025),i=r(5130),o=r(7975),s=function(){function e(e,t,r,s,a){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var c=this;c.ver=2,t=t||n.R2,c[i.pM]=(0,o.Vk)(e,t),c[i.$y]=(0,o.xP)(e,s),c[i.XA]=(0,o.Vj)(e,a),r&&(c[i.Ur]=r)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}()},9354:(e,t,r)=>{"use strict";r.d(t,{Gz:()=>l,M0:()=>f,PS:()=>h,cM:()=>c,k6:()=>d,wX:()=>u});var n=r(269),i=r(5130),o=(0,n.YEm)()||{},s=0,a=[null,null,null,null,null];function c(e){var t=s,r=a,n=r[t];return o.createElement?r[t]||(n=r[t]=o.createElement("a")):n={host:h(e,!0)},n.href=e,++t>=r[i.oI]&&(t=0),s=t,n}function u(e){var t,r=c(e);return r&&(t=r.href),t}function l(e){var t,r=c(e);return r&&(t=r[i.Ue]),t}function d(e,t){return e?e.toUpperCase()+" "+t:t}function h(e,t){var r=f(e,t)||"";if(r){var o=r.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(null!=o&&o[i.oI]>3&&(0,n.KgX)(o[2])&&o[2][i.oI]>0)return o[2]+(o[3]||"")}return r}function f(e,t){var r=null;if(e){var o=e.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(null!=o&&o[i.oI]>2&&(0,n.KgX)(o[2])&&o[2][i.oI]>0&&(r=o[2]||"",t&&o[i.oI]>2)){var s=(o[1]||"")[i.OL](),a=o[3]||"";("http"===s&&":80"===a||"https"===s&&":443"===a)&&(a=""),r+=a}}return r}},2318:(e,t,r)=>{"use strict";r.d(t,{Ft:()=>I,Qu:()=>h,Rs:()=>g,Wt:()=>f,_U:()=>y,jj:()=>C,lt:()=>w,mD:()=>v,mp:()=>p,pg:()=>m});var n=r(269),i=r(1864),o=r(5025),s=r(2910),a=r(7975),c=r(9354),u=r(5130),l=[o._G+o.wc,"https://breeze.aimon.applicationinsights.io"+o.wc,"https://dc-int.services.visualstudio.com"+o.wc],d="cid-v1:";function h(e){return-1!==(0,n.rDm)(l,e[u.OL]())}function f(e){d=e}function p(){return d}function g(e,t,r){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e[u.Ol])for(var i=0;i<e.correlationHeaderExcludePatterns[u.oI];i++)if(e[u.Ol][i].test(t))return!1;var o=(0,c.cM)(t).host[u.OL]();if(!o||-1===(0,n.HzD)(o,":443")&&-1===(0,n.HzD)(o,":80")||(o=((0,c.M0)(t,!0)||"")[u.OL]()),(!e||!e.enableCorsCorrelation)&&o&&o!==r)return!1;var s,a=e&&e.correlationHeaderDomains;if(a&&((0,n.Iuo)(a,(function(e){var t=new RegExp(e.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));s=s||t.test(o)})),!s))return!1;var l=e&&e.correlationHeaderExcludedDomains;if(!l||0===l[u.oI])return!0;for(i=0;i<l[u.oI];i++)if(new RegExp(l[i].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")).test(o))return!1;return o&&o[u.oI]>0}function m(e){if(e){var t=v(e,s.a[1]);if(t&&t!==d)return t}}function v(e,t){if(e)for(var r=e[u.sY](","),n=0;n<r[u.oI];++n){var i=r[n][u.sY]("=");if(2===i[u.oI]&&i[0]===t)return i[1]}}function y(e,t,r,n){var i,o=n,s=n;if(t&&t[u.oI]>0){var l=(0,c.cM)(t);if(i=l.host,!o)if(null!=l[u.Ue]){var d=0===l.pathname[u.oI]?"/":l[u.Ue];"/"!==d.charAt(0)&&(d="/"+d),s=l[u.Ue],o=(0,a.Rr)(e,r?r+" "+d:d)}else o=(0,a.Rr)(e,t)}else i=n,o=n;return{target:i,name:o,data:s}}function w(){var e=(0,n.FJj)();if(e&&e.now&&e.timing){var t=e.now()+e.timing.navigationStart;if(t>0)return t}return(0,n.f0d)()}function C(e,t){var r=null;return 0===e||0===t||(0,n.hXl)(e)||(0,n.hXl)(t)||(r=t-e),r}function I(e,t){var r=e||{};return{getName:function(){return r[u.RS]},setName:function(e){t&&t.setName(e),r[u.RS]=e},getTraceId:function(){return r.traceID},setTraceId:function(e){t&&t.setTraceId(e),(0,i.hX)(e)&&(r.traceID=e)},getSpanId:function(){return r.parentID},setSpanId:function(e){t&&t.setSpanId(e),(0,i.wN)(e)&&(r.parentID=e)},getTraceFlags:function(){return r.traceFlags},setTraceFlags:function(e){t&&t.setTraceFlags(e),r.traceFlags=e}}}},5130:(e,t,r)=>{"use strict";r.d(t,{$e:()=>y,$y:()=>T,AZ:()=>u,Av:()=>L,C9:()=>v,Cx:()=>p,F2:()=>h,Fq:()=>R,IE:()=>N,J$:()=>b,Jj:()=>w,Jm:()=>f,OK:()=>S,OL:()=>o,Ol:()=>I,QE:()=>x,RS:()=>l,Ue:()=>C,Ur:()=>P,XA:()=>_,fd:()=>H,h_:()=>F,i9:()=>m,lW:()=>D,lx:()=>U,oI:()=>i,on:()=>E,pM:()=>d,qd:()=>q,qg:()=>k,r1:()=>O,sY:()=>n,up:()=>A,vu:()=>M,xE:()=>a,y5:()=>c,zV:()=>s,zw:()=>g});var n="split",i="length",o="toLowerCase",s="ingestionendpoint",a="toString",c="push",u="removeItem",l="name",d="message",h="count",f="preTriggerDate",p="disabled",g="interval",m="daysOfMonth",v="date",y="getUTCDate",w="stringify",C="pathname",I="correlationHeaderExcludePatterns",A="extensionConfig",S="exceptions",E="parsedStack",T="properties",_="measurements",b="sizeInBytes",k="typeName",P="severityLevel",R="problemGroup",O="isManual",M="CreateFromInterface",x="assembly",N="fileName",D="hasFullStack",L="level",U="method",F="line",q="duration",H="receivedResponse"},740:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AnalyticsPluginIdentifier:()=>H,BreezeChannelIdentifier:()=>q,ConfigurationManager:()=>T,ConnectionStringParser:()=>h.F,ContextTagKeys:()=>_.o,CtxTagKeys:()=>R.O,DEFAULT_BREEZE_ENDPOINT:()=>p._G,DEFAULT_BREEZE_PATH:()=>p.wc,Data:()=>S.B,DisabledPropertyName:()=>p.xF,DistributedTracingModes:()=>O.uG,Envelope:()=>g.L,Event:()=>m.J,EventPersistence:()=>O.iD,Exception:()=>v.WJ,Extensions:()=>R.F,HttpMethod:()=>p.ym,Metric:()=>y.J,PageView:()=>w.h,PageViewPerformance:()=>A.H,ProcessLegacy:()=>p.jp,PropertiesPluginIdentifier:()=>F,RemoteDependencyData:()=>C.A,RequestHeaders:()=>f.a,SampleRate:()=>p.tU,SeverityLevel:()=>E.O,TelemetryItemCreator:()=>P,ThrottleMgr:()=>d,Trace:()=>I.C,correlationIdCanIncludeCorrelationHeader:()=>n.Rs,correlationIdGetCorrelationContext:()=>n.pg,correlationIdGetCorrelationContextValue:()=>n.mD,correlationIdGetPrefix:()=>n.mp,correlationIdSetPrefix:()=>n.Wt,createDistributedTraceContextFromTrace:()=>n.Ft,createDomEvent:()=>D,createOfflineListener:()=>U.G,createTelemetryItem:()=>k,createTraceParent:()=>N.wk,dataSanitizeException:()=>b.Vt,dataSanitizeId:()=>b.HQ,dataSanitizeInput:()=>b._T,dataSanitizeKey:()=>b.lq,dataSanitizeKeyAndAddUniqueness:()=>b.zx,dataSanitizeMeasurements:()=>b.Vj,dataSanitizeMessage:()=>b.Vk,dataSanitizeProperties:()=>b.xP,dataSanitizeString:()=>b.Rr,dataSanitizeUrl:()=>b.pJ,dateTimeUtilsDuration:()=>n.jj,dateTimeUtilsNow:()=>n.lt,dsPadNumber:()=>b.qW,findAllScripts:()=>N.V5,findW3cTraceParent:()=>N.ef,formatTraceParent:()=>N.L0,getExtensionByName:()=>M.Y8,isBeaconApiSupported:()=>x.Uf,isCrossOriginError:()=>M.vv,isInternalApplicationInsightsEndpoint:()=>n.Qu,isSampledFlag:()=>N.N7,isValidSpanId:()=>N.wN,isValidTraceId:()=>N.hX,isValidTraceParent:()=>N.mJ,msToTimeSpan:()=>M.bb,parseConnectionString:()=>h.H,parseTraceParent:()=>N.ZI,strNotSpecified:()=>p.R2,stringToBoolOrDefault:()=>M.Dt,urlGetAbsoluteUrl:()=>L.wX,urlGetCompleteUrl:()=>L.k6,urlGetPathName:()=>L.Gz,urlParseFullHost:()=>L.M0,urlParseHost:()=>L.PS,urlParseUrl:()=>L.cM,utlCanUseLocalStorage:()=>u.BW,utlCanUseSessionStorage:()=>u.AN,utlDisableStorage:()=>u.Nu,utlEnableStorage:()=>u.iw,utlGetLocalStorage:()=>u.Se,utlGetSessionStorage:()=>u.vH,utlGetSessionStorageKeys:()=>u.T9,utlRemoveSessionStorage:()=>u.v7,utlRemoveStorage:()=>u.tm,utlSetLocalStorage:()=>u._M,utlSetSessionStorage:()=>u.Dt,utlSetStoragePrefix:()=>u.vh});var n=r(2318),i=r(269),o=r(3775),s=r(3673),a=r(9749),c=r(6535),u=r(4658),l=r(5130),d=function(e,t){var r,n,d,h,f,p,g,m=this,v=!1,y=!1;function w(e,t,i,o){if(v){var s=function(e){try{var t=C(e);return(0,c.Z1)(1e6)<=t.limit.samplingRate}catch(e){}return!1}(e);if(!s)return;var a=C(e),u=k(e),d=A(a,r,u),h=!1,p=0,g=P(e);try{d&&!g?(p=Math.min(a.limit.maxSendNumber,u[l.F2]+1),u[l.F2]=0,h=!0,f[e]=!0,u[l.Jm]=new Date):(f[e]=d,u[l.F2]+=1);var m=S(e);T(n,m,u);for(var y=0;y<p;y++)b(e,n,t,i)}catch(e){}return{isThrottled:h,throttleNum:p}}return o&&R(e)[l.y5]({msgID:e,message:t,severity:i}),null}function C(e){return d[e]||d[109]}function I(e,t){var r,n,o,s,a;try{var c=t||{},u={};u[l.Cx]=!!c[l.Cx];var h=c[l.zw]||{};y=(null==h?void 0:h.daysOfMonth)&&(null==h?void 0:h.daysOfMonth[l.oI])>0,u[l.zw]=(s=null===(o=(o=h)||{})||void 0===o?void 0:o.monthInterval,a=null==o?void 0:o.dayInterval,(0,i.hXl)(s)&&(0,i.hXl)(a)&&(o.monthInterval=3,y||(o[l.i9]=[28],y=!0)),o={monthInterval:null==o?void 0:o.monthInterval,dayInterval:null==o?void 0:o.dayInterval,daysOfMonth:null==o?void 0:o.daysOfMonth});var f={samplingRate:(null===(r=c.limit)||void 0===r?void 0:r.samplingRate)||100,maxSendNumber:(null===(n=c.limit)||void 0===n?void 0:n.maxSendNumber)||1};u.limit=f,d[e]=u}catch(e){}}function A(e,t,r){if(e&&!e[l.Cx]&&t&&(0,s.Gh)(r)){var n=E(),o=r[l.C9],a=e[l.zw],c=1;if(null==a?void 0:a.monthInterval){var u=12*(n.getUTCFullYear()-o.getUTCFullYear())+n.getUTCMonth()-o.getUTCMonth();c=_(a.monthInterval,0,u)}var d=1;if(y)d=(0,i.rDm)(a[l.i9],n[l.$e]());else if(null==a?void 0:a.dayInterval){var h=Math.floor((n.getTime()-o.getTime())/864e5);d=_(a.dayInterval,0,h)}return c>=0&&d>=0}return!1}function S(e,t){var r=(0,s.Gh)(t)?t:"";return e?"appInsightsThrottle"+r+"-"+e:null}function E(e){try{if(!e)return new Date;var t=new Date(e);if(!isNaN(t.getDate()))return t}catch(e){}return null}function T(e,t,r){try{return(0,u._M)(e,t,(0,i.EHq)(JSON[l.Jj](r)))}catch(e){}return!1}function _(e,t,r){return e<=0?1:r>=t&&(r-t)%e==0?Math.floor((r-t)/e)+1:-1}function b(e,t,r,n){(0,o.ZP)(t,n||1,e,r)}function k(e){try{var t=h[e];if(!t){var r=S(e,p);t=function(e,t,r){try{var n={date:E(),count:0};if(e){var i=JSON.parse(e);return{date:E(i[l.C9])||n[l.C9],count:i[l.F2]||n[l.F2],preTriggerDate:i.preTriggerDate?E(i[l.Jm]):void 0}}return T(t,r,n),n}catch(e){}return null}((0,u.Se)(n,r),n,r),h[e]=t}return h[e]}catch(e){}return null}function P(e){var t=f[e];if((0,i.hXl)(t)){t=!1;var r=k(e);r&&(t=function(e){try{if(e){var t=new Date;return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e[l.$e]()===t[l.$e]()}}catch(e){}return!1}(r[l.Jm])),f[e]=t}return f[e]}function R(e){return g=g||{},(0,i.hXl)(g[e])&&(g[e]=[]),g[e]}n=(0,o.y0)(e),f={},h={},g={},d={},I(109),p=(0,s.Gh)(t)?t:"",e.addUnloadHook((0,a.a)(e.config,(function(e){var t=e.cfg;r=(0,u.BW)();var n=t.throttleMgrCfg||{};(0,i.zav)(n,(function(e,t){I(parseInt(e),t)}))}))),m._getDbgPlgTargets=function(){return[g]},m.getConfig=function(){return d},m.canThrottle=function(e){var t=k(e);return A(C(e),r,t)},m.isTriggered=function(e){return P(e)},m.isReady=function(){return v},m.flush=function(e){try{var t=R(e);if(t&&t[l.oI]>0){var r=t.slice(0);return g[e]=[],(0,i.Iuo)(r,(function(e){w(e.msgID,e[l.pM],e.severity,!1)})),!0}}catch(e){}return!1},m.flushAll=function(){try{if(g){var e=!0;return(0,i.zav)(g,(function(t){var r=m.flush(parseInt(t));e=e&&r})),e}}catch(e){}return!1},m.onReadyState=function(e,t){return void 0===t&&(t=!0),(v=!!(0,i.hXl)(e)||e)&&t?m.flushAll():null},m.sendMessage=function(e,t,r){return w(e,t,r,!0)}},h=r(4484),f=r(2910),p=r(5025),g=r(1062),m=r(3072),v=r(5397),y=r(5014),w=r(1448),C=r(1365),I=r(2445),A=r(4164),S=r(7358),E=r(9762),T=function(){function e(){}return e.getConfig=function(e,t,r,n){var o;return void 0===n&&(n=!1),o=r&&e[l.up]&&e[l.up][r]&&!(0,i.hXl)(e[l.up][r][t])?e[l.up][r][t]:e[t],(0,i.hXl)(o)?n:o},e}(),_=r(8596),b=r(7975);function k(e,t,r,n,o,a){var c;r=(0,b.Rr)(n,r)||p.R2,((0,i.hXl)(e)||(0,i.hXl)(t)||(0,i.hXl)(r))&&(0,i.$8)("Input doesn't contain all required fields");var u="";e[p.ks]&&(u=e[p.ks],delete e[p.ks]);var d=((c={})[l.RS]=r,c.time=(0,s._u)(new Date),c.iKey=u,c.ext=a||{},c.tags=[],c.data={},c.baseType=t,c.baseData=e,c);return(0,i.hXl)(o)||(0,i.zav)(o,(function(e,t){d.data[e]=t})),d}var P=function(){function e(){}return e.create=k,e}(),R=r(1575),O=r(7374),M=r(87),x=r(7292),N=r(1864);function D(e){var t=null;if((0,i.Tnt)(Event))t=new Event(e);else{var r=(0,i.YEm)();r&&r.createEvent&&(t=r.createEvent("Event")).initEvent(e,!0,!0)}return t}var L=r(9354),U=r(7952),F="AppInsightsPropertiesPlugin",q="AppInsightsChannelPlugin",H="ApplicationInsightsAnalytics"},2475:(e,t,r)=>{"use strict";r.d(t,{DD:()=>c,Lx:()=>a,NU:()=>s});var n=r(269),i=r(6182);function o(e,t,r){return!e&&(0,n.hXl)(e)?t:(0,n.Lmq)(e)?e:"true"===(0,n.oJg)(e)[i.OL]()}function s(e){return{mrg:!0,v:e}}function a(e,t,r){return{fb:r,isVal:e,v:t}}function c(e,t){return{fb:t,set:o,v:!!e}}},991:(e,t,r)=>{"use strict";r.d(t,{q:()=>c});var n=r(269),i=r(6182);function o(e){return e&&(0,n.Gvm)(e)&&(e.isVal||e.fb||(0,n.KhI)(e,"v")||(0,n.KhI)(e,"mrg")||(0,n.KhI)(e,"ref")||e.set)}function s(e,t,r){var o,s=r.dfVal||n.O9V;if(t&&r.fb){var a=r.fb;(0,n.cyL)(a)||(a=[a]);for(var c=0;c<a[i.oI];c++){var u=a[c],l=t[u];if(s(l)?o=l:e&&(s(l=e.cfg[u])&&(o=l),e.set(e.cfg,(0,n.oJg)(u),l)),s(o))break}}return!s(o)&&s(r.v)&&(o=r.v),o}function a(e,t,r){var c,u=r;return r&&o(r)&&(u=s(e,t,r)),u&&(o(u)&&(u=a(e,t,u)),(0,n.cyL)(u)?(c=[])[i.oI]=u[i.oI]:(0,n.QdQ)(u)&&(c={}),c&&((0,n.zav)(u,(function(r,n){n&&o(n)&&(n=a(e,t,n)),c[r]=n})),u=c)),u}function c(e,t,r,u){var l,d,h,f,p,g,m,v,y=u;o(y)?(l=y.isVal,d=y.set,g=y[i.XW],m=y[i.JQ],f=y.mrg,!(p=y.ref)&&(0,n.b07)(p)&&(p=!!f),h=s(e,t,y)):h=u,m&&e[i.JQ](t,r);var w=!0,C=t[r];!C&&(0,n.hXl)(C)||(v=C,w=!1,l&&v!==h&&!l(v)&&(v=h,w=!0),d&&(w=(v=d(v,h,t))===h)),w?v=h?a(e,t,h):h:((0,n.QdQ)(v)||(0,n.cyL)(h))&&f&&h&&((0,n.QdQ)(h)||(0,n.cyL)(h))&&(0,n.zav)(h,(function(t,r){c(e,v,t,r)})),e.set(t,r,v),p&&e.ref(t,r),g&&e[i.XW](t,r)}},9749:(e,t,r)=>{"use strict";r.d(t,{e:()=>w,a:()=>C});var n,i=r(269),o=r(4276),s=r(6492),a=r(6182),c=r(991),u=r(9147),l=["push","pop","shift","unshift","splice"],d=function(e,t,r,n){e&&e[a.ih](3,108,"".concat(r," [").concat(t,"] failed - ")+(0,i.mmD)(n))};function h(e,t){var r=(0,i.kgX)(e,t);return r&&r.get}function f(e,t,r,n){if(t){var o=h(t,r);o&&o[e.prop]?t[r]=n:function(e,t,r,n){var o={n:r,h:[],trk:function(t){t&&t.fn&&(-1===(0,i.rDm)(o.h,t)&&o.h[a.y5](t),e.trk(t,o))},clr:function(e){var t=(0,i.rDm)(o.h,e);-1!==t&&o.h[a.Ic](t,1)}},c=!0,l=!1;function p(){c&&(l=l||(0,u.hF)(p,e,n),n&&!n[u.nM]&&l&&(n=g(e,n,r,"Converting")),c=!1);var t=e.act;return t&&o.trk(t),n}p[e.prop]={chng:function(){e.add(o)}},(0,i.vF1)(t,o.n,{g:p,s:function(m){if(n!==m){p[e.ro]&&!e.upd&&(0,u.If)("["+r+"] is read-only:"+(0,i.mmD)(t)),c&&(l=l||(0,u.hF)(p,e,n),c=!1);var v=l&&p[e.rf];if(l)if(v){(0,i.zav)(n,(function(e){n[e]=m?m[e]:s.HP}));try{(0,i.zav)(m,(function(t,r){f(e,n,t,r)})),m=n}catch(t){d((e.hdlr||{})[a.Uw],r,"Assigning",t),l=!1}}else n&&n[u.nM]&&(0,i.zav)(n,(function(t){var r=h(n,t);if(r){var i=r[e.prop];i&&i.chng()}}));if(m!==n){var y=m&&(0,u.hF)(p,e,m);!v&&y&&(m=g(e,m,r,"Converting")),n=m,l=y}e.add(o)}}})}(e,t,r,n)}return t}function p(e,t,r,n){if(t){var i=h(t,r),o=i&&!!i[e.prop],s=n&&n[0],c=n&&n[1],l=n&&n[2];if(!o){if(l)try{(0,u.V9)(t)}catch(t){d((e.hdlr||{})[a.Uw],r,"Blocking",t)}try{f(e,t,r,t[r]),i=h(t,r)}catch(t){d((e.hdlr||{})[a.Uw],r,"State",t)}}s&&(i[e.rf]=s),c&&(i[e.ro]=c),l&&(i[e.blkVal]=!0)}return t}function g(e,t,r,n){try{(0,i.zav)(t,(function(r,n){f(e,t,r,n)})),t[u.nM]||((0,i.UxO)(t,u.nM,{get:function(){return e[a.K0]}}),function(e,t,r){(0,i.cyL)(t)&&(0,i.Iuo)(l,(function(n){var i=t[n];t[n]=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=i[a.y9](this,n);return g(e,t,r,"Patching"),s}}))}(e,t,r))}catch(t){d((e.hdlr||{})[a.Uw],r,n,t)}return t}var m="[[ai_",v="]]";function y(e,t,r){var s,l=(0,u.QA)(t);if(l)return l;var h,y=(0,o.Z)("dyncfg",!0),w=t&&!1!==r?t:(0,u.Dy)(t),C=((s={uid:null,cfg:w})[a.Uw]=e,s[a.zs]=function(){h[a.zs]()},s.set=function(t,r,n){try{t=f(h,t,r,n)}catch(t){d(e,r,"Setting value",t)}return t[r]},s[a.h0]=function(e,t){return t&&(0,i.zav)(t,(function(t,r){(0,c.q)(C,e,t,r)})),e},s[a.x6]=function(e){return function(e,t){var r={fn:t,rm:function(){r.fn=null,e=null,t=null}};return(0,i.vF1)(r,"toJSON",{v:function(){return"WatcherHandler"+(r.fn?"":"[X]")}}),e.use(r,t),r}(h,e)},s.ref=function(e,t){var r;return p(h,e,t,(r={},r[0]=!0,r))[t]},s[a.XW]=function(e,t){var r;return p(h,e,t,(r={},r[1]=!0,r))[t]},s[a.JQ]=function(e,t){var r;return p(h,e,t,(r={},r[2]=!0,r))[t]},s._block=function(e,t){h.use(null,(function(r){var n=h.upd;try{(0,i.b07)(t)||(h.upd=t),e(r)}finally{h.upd=n}}))},s);return(0,i.vF1)(C,"uid",{c:!1,e:!1,w:!1,v:y}),g(h=function(e){var t,r,o=(0,i.jjc)(m+"get"+e.uid+v),s=(0,i.jjc)(m+"ro"+e.uid+v),c=(0,i.jjc)(m+"rf"+e.uid+v),u=(0,i.jjc)(m+"blkVal"+e.uid+v),l=(0,i.jjc)(m+"dtl"+e.uid+v),d=null,h=null;function f(t,n){var o=r.act;try{r.act=t,t&&t[l]&&((0,i.Iuo)(t[l],(function(e){e.clr(t)})),t[l]=[]),n({cfg:e.cfg,set:e.set.bind(e),setDf:e[a.h0].bind(e),ref:e.ref.bind(e),rdOnly:e[a.XW].bind(e)})}catch(t){var s=e[a.Uw];throw s&&s[a.ih](1,107,(0,i.mmD)(t)),t}finally{r.act=o||null}}function p(){if(d){var e=d;d=null,h&&h[a._w](),h=null;var t=[];if((0,i.Iuo)(e,(function(e){if(e&&(e[l]&&((0,i.Iuo)(e[l],(function(t){t.clr(e)})),e[l]=null),e.fn))try{f(e,e.fn)}catch(e){t[a.y5](e)}})),d)try{p()}catch(e){t[a.y5](e)}t[a.oI]>0&&function(e,t){n||(n=(0,i.aqQ)("AggregationError",(function(e,t){t[a.oI]>1&&(e.errors=t[1])})));var r="Watcher error(s): ";throw(0,i.Iuo)(t,(function(e,t){r+="\n".concat(t," > ").concat((0,i.mmD)(e))})),new n(r,t||[])}(0,t)}}return(t={prop:o,ro:s,rf:c})[a.JQ]=u,t[a.K0]=e,t.add=function(e){if(e&&e.h[a.oI]>0){d||(d=[]),h||(h=(0,i.dRz)((function(){h=null,p()}),0));for(var t=0;t<e.h[a.oI];t++){var r=e.h[t];r&&-1===(0,i.rDm)(d,r)&&d[a.y5](r)}}},t[a.zs]=p,t.use=f,t.trk=function(e,t){if(e){var r=e[l]=e[l]||[];-1===(0,i.rDm)(r,t)&&r[a.y5](t)}},r=t}(C),w,"config","Creating"),C}function w(e,t,r,n){var i=y(r,e||{},n);return t&&i[a.h0](i.cfg,t),i}function C(e,t,r){var n=e[u.nM]||e;return!n.cfg||n.cfg!==e&&n.cfg[u.nM]!==n?(function(e,t){e?(e[a.on](t),e[a.ih](2,108,t)):(0,u.If)(t)}(r,s.xW+(0,i.mmD)(e)),w(e,null,r)[a.x6](t)):n[a.x6](t)}},9147:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>c,Hf:()=>d,If:()=>f,QA:()=>u,V9:()=>l,hF:()=>h,nM:()=>o});var n=r(269),i=r(6182),o=(0,n.eCG)("[[ai_dynCfg_1]]"),s=(0,n.eCG)("[[ai_blkDynCfg_1]]"),a=(0,n.eCG)("[[ai_frcDynCfg_1]]");function c(e){var t;return e&&((0,n.cyL)(e)?(t=[])[i.oI]=e[i.oI]:(0,n.QdQ)(e)&&(t={}),t)?((0,n.zav)(e,(function(e,r){t[e]=c(r)})),t):e}function u(e){if(e){var t=e[o]||e;if(t.cfg&&(t.cfg===e||t.cfg[o]===t))return t}return null}function l(e){if(e&&((0,n.QdQ)(e)||(0,n.cyL)(e)))try{e[s]=!0}catch(e){}return e}function d(e){if(e)try{e[a]=!0}catch(e){}return e}function h(e,t,r){var i=!1;return r&&!e[t.blkVal]&&((i=r[a])||r[s]||(i=(0,n.QdQ)(r)||(0,n.cyL)(r))),i}function f(e){(0,n.zkd)("InvalidAccess:"+e)}},4282:(e,t,r)=>{"use strict";r.d(t,{H:()=>i,o:()=>o});var n=r(269),i=n.WSA,o=n.fn0},3662:(e,t,r)=>{"use strict";r.d(t,{x:()=>i});var n=r(4282),i=(0,n.H)({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5});(0,n.H)({Unknown:0,NonRetryableStatus:1,CleanStorage:2,MaxInStorageTimeExceeded:3})},4875:(e,t,r)=>{"use strict";r.d(t,{f:()=>n});var n=(0,r(4282).H)({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2})},2774:(e,t,r)=>{"use strict";r.d(t,{_:()=>x});var n,i=r(659),o=r(8279),s=r(8205),a=r(269),c=r(9749),u=r(4875),l=r(6182),d=r(4013),h=r(7847),f=r(5034),p=r(4276),g=r(7867),m=r(3775),v=r(3673),y=r(6492),w=r(1356),C=r(8156),I=r(2317),A=r(380),S=function(e){function t(){var r,n,i=e.call(this)||this;function s(){r=0,n=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,s(),(0,o.A)(t,i,(function(e,t){e.addTelemetryInitializer=function(e){return function(e,t,r){var n={id:t,fn:r};return(0,a.Yny)(e,n),{remove:function(){(0,a.Iuo)(e,(function(t,r){if(t.id===n.id)return e[l.Ic](r,1),-1}))}}}(n,r++,e)},e[y.qT]=function(t,r){(function(e,t,r){for(var n=!1,i=e[l.oI],o=0;o<i;++o){var s=e[o];if(s)try{if(!1===s.fn[l.y9](null,[t])){n=!0;break}}catch(e){(0,m.ZP)(r,2,64,"Telemetry initializer failed: "+(0,v.lL)(e),{exception:(0,a.mmD)(e)},!0)}}return!n})(n,t,r?r[l.e4]():e[l.e4]())&&e[l.$5](t,r)},e[l.tn]=function(){s()}})),i}return(0,i.qU)(t,e),t.__ieDyn=1,t}(r(8257).s),E=r(836),T=r(8969),_="Plugins must provide initialize method",b="SDK is still unloading...",k=(0,a.ZHX)(((n={cookieCfg:{}})[y.jy]={rdOnly:!0,ref:!0,v:[]},n[y.LZ]={rdOnly:!0,ref:!0,v:[]},n[y.Bw]={ref:!0,v:{}},n[y.Yd]=y.HP,n.loggingLevelConsole=0,n.diagnosticLogInterval=y.HP,n));function P(e,t){return new C.NS(t)}function R(e,t){var r=!1;return(0,a.Iuo)(t,(function(t){if(t===e)return r=!0,-1})),r}function O(e,t,r,n){r&&(0,a.zav)(r,(function(r,i){n&&(0,a.QdQ)(i)&&(0,a.QdQ)(t[r])&&O(e,t[r],i,n),n&&(0,a.QdQ)(i)&&(0,a.QdQ)(t[r])?O(e,t[r],i,n):e.set(t,r,i)}))}function M(e,t){var r=null,n=-1;return(0,a.Iuo)(e,(function(e,i){if(e.w===t)return r=e,n=i,-1})),{i:n,l:r}}var x=function(){function e(){var t,r,n,x,N,D,L,U,F,q,H,j,B,$,z,V,K,G,W,X,Y,Q,J,Z,ee,te,re,ne,ie,oe,se,ae;(0,o.A)(e,this,(function(e){function o(){ie=!0,(0,a.hXl)(Y)?(te=u.f[l.Yq],(0,m.ZP)(n,1,112,"ikey can't be resolved from promises")):te=u.f.ACTIVE,ce()}function ce(){r&&(e.releaseQueue(),e[l.h4]())}function ue(e){return oe&&oe[l.XM]||ae||(e||n&&n.queue[l.oI]>0)&&(se||(se=!0,Ae(t[l.x6]((function(e){var t=e.cfg.diagnosticLogInterval;t&&t>0||(t=1e4);var r=!1;oe&&(r=oe[l.XM],oe[l._w]()),(oe=(0,a.AHH)(ve,t)).unref(),oe[l.XM]=r})))),oe[l.XM]=!0),oe}function le(){var e={};Z=[];var t=function(t){t&&(0,a.Iuo)(t,(function(t){if(t[l.Ju]&&t[l.s]&&!e[t.identifier]){var r=t[l.Ju]+"="+t[l.s];Z[l.y5](r),e[t.identifier]=t}}))};t(j),H&&(0,a.Iuo)(H,(function(e){t(e)})),t(q)}function de(){r=!1,(t=(0,c.e)({},k,e[l.Uw])).cfg[l.Bl]=1,(0,a.vF1)(e,"config",{g:function(){return t.cfg},s:function(t){e.updateCfg(t,!1)}}),(0,a.vF1)(e,"pluginVersionStringArr",{g:function(){return Z||le(),Z}}),(0,a.vF1)(e,"pluginVersionString",{g:function(){return ee||(Z||le(),ee=Z.join(";")),ee||y.m5}}),(0,a.vF1)(e,"logger",{g:function(){return n||(n=new m.wq(t.cfg),t[l.Uw]=n),n},s:function(e){t[l.Uw]=e,n!==e&&((0,d.K)(n,!1),n=e)}}),e[l.Uw]=new m.wq(t.cfg),J=[];var i=e.config[y.jy]||[];i.splice(0,i[l.oI]),(0,a.Yny)(i,J),$=new S,x=[],(0,d.K)(N,!1),N=null,D=null,L=null,(0,d.K)(U,!1),U=null,F=null,q=[],H=null,j=null,B=!1,z=null,V=(0,p.Z)("AIBaseCore",!0),K=(0,E.P)(),X=null,Y=null,G=(0,T.w)(),Q=[],ee=null,Z=null,ae=!1,oe=null,se=!1,te=0,re=null,ne=null,ie=!1}function he(){var r=(0,I.i8)(ge(),t.cfg,e);return r[l.by](ue),r}function fe(t){var r=function(e,t,r){var n,i=[],o=[],s={};return(0,a.Iuo)(r,(function(r){((0,a.hXl)(r)||(0,a.hXl)(r[l.mE]))&&(0,a.$8)(_);var n=r[y.Vo],c=r[l.Ju];r&&n&&((0,a.hXl)(s[n])?s[n]=c:(0,m.OG)(e,"Two extensions have same priority #"+n+" - "+s[n]+", "+c)),!n||n<t?i[l.y5](r):o[l.y5](r)})),(n={})[y.eT]=i,n[y.LZ]=o,n}(e[l.Uw],h.i,q);F=null,ee=null,Z=null,j=(H||[])[0]||[],j=(0,A.Xc)((0,a.Yny)(j,r[y.LZ]));var n=(0,a.Yny)((0,A.Xc)(r[y.eT]),j);J=(0,a.N6t)(n);var i=e.config[y.jy]||[];i.splice(0,i[l.oI]),(0,a.Yny)(i,J);var o=he();j&&j[l.oI]>0&&(0,A.pI)(o[l.$o](j),n),(0,A.pI)(o,n),t&&we(t)}function pe(e){var t=null,r=null,n=[];return(0,a.Iuo)(J,(function(t){if(t[l.Ju]===e&&t!==$)return r=t,-1;t.getChannel&&n[l.y5](t)})),!r&&n[l.oI]>0&&(0,a.Iuo)(n,(function(t){if(!(r=t.getChannel(e)))return-1})),r&&(t={plugin:r,setEnabled:function(e){(0,A.Cr)(r)[y.Hr]=!e},isEnabled:function(){var e=(0,A.Cr)(r);return!e[l.Ik]&&!e[y.Hr]},remove:function(e,t){var n;void 0===e&&(e=!0);var i=[r],o=((n={reason:1})[l.tI]=e,n);me(i,o,(function(e){e&&fe({reason:32,removed:i}),t&&t(e)}))}}),t}function ge(){if(!F){var r=(J||[]).slice();-1===(0,a.rDm)(r,$)&&r[l.y5]($),F=(0,I.PV)((0,A.Xc)(r),t.cfg,e)}return F}function me(r,n,i){if(r&&r[l.oI]>0){var o=(0,I.PV)(r,t.cfg,e),s=(0,I.tS)(o,e);s[l.by]((function(){var e=!1,t=[];(0,a.Iuo)(q,(function(n,i){R(n,r)?e=!0:t[l.y5](n)})),q=t,ee=null,Z=null;var n=[];H&&((0,a.Iuo)(H,(function(t,i){var o=[];(0,a.Iuo)(t,(function(t){R(t,r)?e=!0:o[l.y5](t)})),n[l.y5](o)})),H=n),i&&i(e),ue()})),s[l.$5](n)}else i(!1)}function ve(){if(n&&n.queue){var t=n.queue.slice(0);n.queue[l.oI]=0,(0,a.Iuo)(t,(function(t){var r,n=((r={})[l.RS]=z||"InternalMessageId: "+t[l.JR],r[l.FI]=Y,r[l.fA]=(0,v._u)(new Date),r.baseType=m.WD.dataType,r.baseData={message:t[l.pM]},r);e.track(n)}))}}function ye(e,t,r,n){var i=1,o=!1,s=null;function c(){i--,o&&0===i&&(s&&s[l._w](),s=null,t&&t(o),t=null)}return n=n||5e3,j&&j[l.oI]>0&&he()[l.$o](j).iterate((function(t){if(t.flush){i++;var o=!1;t.flush(e,(function(){o=!0,c()}),r)||o||(e&&null==s?s=(0,a.dRz)((function(){s=null,c()}),n):c())}})),o=!0,c(),!0}function we(t){var r=(0,I.nU)(ge(),e);r[l.by](ue),e._updateHook&&!0===e._updateHook(r,t)||r[l.$5](t)}function Ce(t){var r=e[l.Uw];r?((0,m.ZP)(r,2,73,t),ue()):(0,a.$8)(t)}function Ie(t){var r=e[l.RF]();r&&r[y.Yp]([t],2)}function Ae(e){G.add(e)}de(),e._getDbgPlgTargets=function(){return[J,x]},e[l.tZ]=function(){return r},e.activeStatus=function(){return te},e._setPendingStatus=function(){te=3},e[l.mE]=function(d,h,f,p){var w;B&&(0,a.$8)(b),e[l.tZ]()&&(0,a.$8)("Core cannot be initialized more than once"),t=(0,c.e)(d,k,f||e[l.Uw],!1),d=t.cfg,Ae(t[l.x6]((function(e){var t=e.cfg;if(3!==te){ne=t.initInMemoMaxSize||100;var i=t[l.sl],c=t.endpointUrl;if((0,a.hXl)(i)){Y=null,te=u.f[l.Yq];var h="Please provide instrumentation key";r?((0,m.ZP)(n,1,100,h),ce()):(0,a.$8)(h)}else{var f=[];if((0,a.$XS)(i)?(f[l.y5](i),Y=null):Y=i,(0,a.$XS)(c)?(f[l.y5](c),re=null):re=c,f[l.oI]){ie=!1,te=3;var p=(0,v.Gh)(t.initTimeOut)?t.initTimeOut:5e4,g=(0,s.lh)(f);(0,a.dRz)((function(){ie||o()}),p),(0,s.Dv)(g,(function(e){try{if(ie)return;if(!e.rejected){var t=e[l.pF];if(t&&t[l.oI]){var r=t[0];if(Y=r&&r[l.pF],t[l.oI]>1){var n=t[1];re=n&&n[l.pF]}}Y&&(d[l.sl]=Y,d.endpointUrl=re)}o()}catch(e){ie||o()}}))}else o();var w=e.ref(e.cfg,y.Bw);(0,a.zav)(w,(function(t){e.ref(w,t)}))}}}))),W=function(e,t,r,n){return t.add(e[l.x6]((function(e){var t=e.cfg.disableDbgExt;!0===t&&n&&(r[l.h3](n),n=null),r&&!n&&!0!==t&&(n=(0,g.M)(e.cfg),r[l.vR](n))}))),n}(t,G,(N=p)&&e[l.RF](),W),Ae(t[l.x6]((function(t){if(t.cfg.enablePerfMgr){var r=t.cfg[y.Yd];w===r&&w||(r||(r=P),(0,v.c2)(t.cfg,y.Yd,r),w=r,L=null),D||L||!(0,a.Tnt)(r)||(L=r(e,e[l.RF]()))}else L=null,w=null}))),e[l.Uw]=f;var C=d[y.jy];if((q=[])[l.y5].apply(q,(0,i.vz)((0,i.vz)([],h,!1),C,!1)),H=d[y.LZ],fe(null),j&&0!==j[l.oI]||(0,a.$8)("No "+y.LZ+" available"),H&&H[l.oI]>1){var I=e[l.AP]("TeeChannelController");I&&I.plugin||(0,m.ZP)(n,1,28,"TeeChannel required")}!function(e,t,r){(0,a.Iuo)(t,(function(t){var n=(0,c.a)(e,t.w,r);delete t.w,t.rm=function(){n.rm()}}))}(d,Q,n),Q=null,r=!0,te===u.f.ACTIVE&&ce()},e.getChannels=function(){var e=[];return j&&(0,a.Iuo)(j,(function(t){e[l.y5](t)})),(0,a.N6t)(e)},e.track=function(t){(0,C.r2)(e[y.kI](),(function(){return"AppInsightsCore:track"}),(function(){null===t&&(Ie(t),(0,a.$8)("Invalid telemetry item")),!t[l.RS]&&(0,a.hXl)(t[l.RS])&&(Ie(t),(0,a.$8)("telemetry name required")),t[l.FI]=t[l.FI]||Y,t[l.fA]=t[l.fA]||(0,v._u)(new Date),t.ver=t.ver||"4.0",!B&&e[l.tZ]()&&te===u.f.ACTIVE?he()[l.$5](t):te!==u.f[l.Yq]&&x[l.oI]<=ne&&x[l.y5](t)}),(function(){return{item:t}}),!t.sync)},e[l.DI]=he,e[l.RF]=function(){return N||(N=new w.h(t.cfg),e._notificationManager=N),N},e[l.vR]=function(t){e.getNotifyMgr()[l.vR](t)},e[l.h3]=function(e){N&&N[l.h3](e)},e.getCookieMgr=function(){return U||(U=(0,f.xN)(t.cfg,e[l.Uw])),U},e.setCookieMgr=function(e){U!==e&&((0,d.K)(U,!1),U=e)},e[y.kI]=function(){return D||L||(0,C.Z4)()},e.setPerfMgr=function(e){D=e},e.eventCnt=function(){return x[l.oI]},e.releaseQueue=function(){if(r&&x[l.oI]>0){var e=x;x=[],2===te?(0,a.Iuo)(e,(function(e){e[l.FI]=e[l.FI]||Y,he()[l.$5](e)})):(0,m.ZP)(n,2,20,"core init status is not active")}},e[l.h4]=function(e){return z=e||null,ae=!1,oe&&oe[l._w](),ue(!0)},e[l.Di]=function(){ae=!0,oe&&oe[l._w](),ve()},(0,v.o$)(e,(function(){return $}),["addTelemetryInitializer"]),e[l.M5]=function(t,i,o){var c;void 0===t&&(t=!0),r||(0,a.$8)("SDK is not initialized"),B&&(0,a.$8)(b);var u,h=((c={reason:50})[l.tI]=t,c.flushComplete=!1,c);t&&!i&&(u=(0,s.Qo)((function(e){i=e})));var f=(0,I.tS)(ge(),e);function p(t){h.flushComplete=t,B=!0,K.run(f,h),e[l.Di](),f[l.$5](h)}return f[l.by]((function(){G.run(e[l.Uw]),(0,d.k)([U,N,n],t,(function(){de(),i&&i(h)}))}),e),ve(),ye(t,p,6,o)||p(!1),u},e[l.AP]=pe,e.addPlugin=function(e,t,r,n){if(!e)return n&&n(!1),void Ce(_);var i=pe(e[l.Ju]);if(i&&!t)return n&&n(!1),void Ce("Plugin ["+e[l.Ju]+"] is already loaded!");var o={reason:16};function s(t){q[l.y5](e),o.added=[e],fe(o),n&&n(!0)}if(i){var a=[i.plugin];me(a,{reason:2,isAsync:!!r},(function(e){e?(o.removed=a,o.reason|=32,s()):n&&n(!1)}))}else s()},e.updateCfg=function(r,n){var i;if(void 0===n&&(n=!0),e[l.tZ]()){i={reason:1,cfg:t.cfg,oldCfg:(0,a.zwS)({},t.cfg),newConfig:(0,a.zwS)({},r),merge:n},r=i.newConfig;var o=t.cfg;r[y.jy]=o[y.jy],r[y.LZ]=o[y.LZ]}t._block((function(e){var t=e.cfg;O(e,t,r,n),n||(0,a.zav)(t,(function(n){(0,a.KhI)(r,n)||e.set(t,n,y.HP)})),e[l.h0](t,k)}),!0),t[l.zs](),i&&we(i)},e.evtNamespace=function(){return V},e.flush=ye,e.getTraceCtx=function(e){return X||(X=(0,A.u7)()),X},e.setTraceCtx=function(e){X=e||null},e.addUnloadHook=Ae,(0,v.RF)(e,"addUnloadCb",(function(){return K}),"add"),e.onCfgChange=function(n){var i,o,s,u;return r?i=(0,c.a)(t.cfg,n,e[l.Uw]):((u=M(o=Q,s=n).l)||(u={w:s,rm:function(){var e=M(o,s);-1!==e.i&&o[l.Ic](e.i,1)}},o[l.y5](u)),i=u),function(e){return(0,a.vF1)({rm:function(){e.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(e)+">"}})}(i)},e.getWParam=function(){return(0,a.Wtk)()||t.cfg.enableWParam?0:-1}}))}return e.__ieDyn=1,e}()},4013:(e,t,r)=>{"use strict";r.d(t,{K:()=>s,k:()=>a});var n=r(8205),i=r(269),o=r(6182);function s(e,t){if(e&&e[o.M5])return e[o.M5](t)}function a(e,t,r){var o;return r||(o=(0,n.Qo)((function(e){r=e}))),e&&(0,i.R3R)(e)>0?(0,n.Dv)(s(e[0],t),(function(){a((0,i.KVm)(e,1),t,r)})):r(),o}},8257:(e,t,r)=>{"use strict";r.d(t,{s:()=>m});var n,i=r(8279),o=r(269),s=r(9749),a=r(6182),c=r(3775),u=r(3673),l=r(6492),d=r(2317),h=r(836),f=r(8969),p="getPlugin",g=((n={})[l.Bw]={isVal:u.Gh,v:{}},n),m=function(){function e(){var t,r,n,m,v,y=this;function w(e){void 0===e&&(e=null);var t=e;if(!t){var i=r||(0,d.i8)(null,{},y[l.eT]);t=n&&n[p]?i[a.$o](null,n[p]):i[a.$o](null,n)}return t}function C(e,t,i){(0,s.e)(e,g,(0,c.y0)(t)),!i&&t&&(i=t[a.DI]()[a.uR]());var o=n;n&&n[p]&&(o=n[p]()),y[l.eT]=t,r=(0,d.i8)(i,e,t,o)}function I(){t=!1,y[l.eT]=null,r=null,n=null,v=(0,f.w)(),m=(0,h.P)()}I(),(0,i.A)(e,y,(function(e){e[a.mE]=function(e,r,n,i){C(e,r,i),t=!0},e[a.Ik]=function(t,r){var i,o=e[l.eT];if(o&&(!t||o===t[l.eT]())){var s,c=!1,u=t||(0,d.tS)(null,o,n&&n[p]?n[p]():n),h=r||((i={reason:0})[a.tI]=!1,i);return e[a.tn]&&!0===e[a.tn](u,h,f)?s=!0:f(),s}function f(){c||(c=!0,m.run(u,r),v.run(u[a.e4]()),!0===s&&u[a.$5](h),I())}},e[a.HC]=function(t,r){var i=e[l.eT];if(i&&(!t||i===t[l.eT]())){var o,s=!1,c=t||(0,d.nU)(null,i,n&&n[p]?n[p]():n),u=r||{reason:0};return e._doUpdate&&!0===e._doUpdate(c,u,h)?o=!0:h(),o}function h(){s||(s=!0,C(c.getCfg(),c.core(),c[a.uR]()))}},(0,u.RF)(e,"_addUnloadCb",(function(){return m}),"add"),(0,u.RF)(e,"_addHook",(function(){return v}),"add"),(0,o.vF1)(e,"_unloadHooks",{g:function(){return v}})})),y[a.e4]=function(e){return w(e)[a.e4]()},y[a.tZ]=function(){return t},y.setInitialized=function(e){t=e},y[a.YH]=function(e){n=e},y[a.$5]=function(e,t){t?t[a.$5](e):n&&(0,o.Tnt)(n[l.qT])&&n[l.qT](e,null)},y._getTelCtx=w}return e.__ieDyn=1,e}()},7847:(e,t,r)=>{"use strict";r.d(t,{i:()=>n,x:()=>i});var n=500,i="Microsoft_ApplicationInsights_BypassAjaxInstrumentation"},5034:(e,t,r)=>{"use strict";r.d(t,{It:()=>q,gi:()=>x,um:()=>O,xN:()=>M});var n,i,o,s=r(269),a=r(2475),c=r(9749),u=r(6182),l=r(3775),d=r(7292),h=r(3673),f=r(6492),p="toGMTString",g="toUTCString",m="cookie",v="expires",y="isCookieUseDisabled",w="disableCookiesUsage",C="_ckMgr",I=null,A=null,S=null,E={},T={},_=((n={cookieCfg:(0,a.NU)((i={},i[f.Fk]={fb:"cookieDomain",dfVal:h.Gh},i.path={fb:"cookiePath",dfVal:h.Gh},i.enabled=f.HP,i.ignoreCookies=f.HP,i.blockedCookies=f.HP,i)),cookieDomain:f.HP,cookiePath:f.HP})[w]=f.HP,n);function b(){!o&&(o=(0,s.nRs)((function(){return(0,s.YEm)()})))}function k(e){return!e||e.isEnabled()}function P(e,t){return!!(t&&e&&(0,s.cyL)(e.ignoreCookies))&&-1!==(0,s.rDm)(e.ignoreCookies,t)}function R(e,t){var r=t[u.XM];if((0,s.hXl)(r)){var n=void 0;(0,s.b07)(e[y])||(n=!e[y]),(0,s.b07)(e[w])||(n=!e[w]),r=n}return r}function O(e,t){var r;if(e)r=e.getCookieMgr();else if(t){var n=t.cookieCfg;r=n&&n[C]?n[C]:M(t)}return r||(r=function(e,t){var r=M[C]||T[C];return r||(r=M[C]=M(e,t),T[C]=r),r}(t,(e||{})[u.Uw])),r}function M(e,t){var r,n,i,o,a,l,m,y,w;e=(0,c.e)(e||T,null,t).cfg,a=(0,c.a)(e,(function(t){t[u.h0](t.cfg,_),n=t.ref(t.cfg,"cookieCfg"),i=n[f.QW]||"/",o=n[f.Fk],l=!1!==R(e,n),m=n.getCookie||U,y=n.setCookie||F,w=n.delCookie||F}),t);var I=((r={isEnabled:function(){var r=!1!==R(e,n)&&l&&x(t),i=T[C];return r&&i&&I!==i&&(r=k(i)),r},setEnabled:function(e){l=!1!==e,n[u.XM]=e},set:function(e,t,r,a,c){var l=!1;if(k(I)&&!function(e,t){return!!(t&&e&&(0,s.cyL)(e.blockedCookies)&&-1!==(0,s.rDm)(e.blockedCookies,t))||P(e,t)}(n,e)){var m={},w=(0,s.EHq)(t||f.m5),C=(0,s.HzD)(w,";");if(-1!==C&&(w=(0,s.EHq)((0,s.ZWZ)(t,C)),m=N((0,s.P0f)(t,C+1))),(0,h.KY)(m,f.Fk,a||o,s.zzB,s.b07),!(0,s.hXl)(r)){var S=(0,d.lT)();if((0,s.b07)(m[v])){var E=(0,s.f0d)()+1e3*r;if(E>0){var T=new Date;T.setTime(E),(0,h.KY)(m,v,D(T,S?p:g)||D(T,S?p:g)||f.m5,s.zzB)}}S||(0,h.KY)(m,"max-age",f.m5+r,null,s.b07)}var _=(0,d.g$)();_&&"https:"===_[u.Qg]&&((0,h.KY)(m,"secure",null,null,s.b07),null===A&&(A=!q(((0,s.w3n)()||{})[u.tX])),A&&(0,h.KY)(m,"SameSite","None",null,s.b07)),(0,h.KY)(m,f.QW,c||i,null,s.b07),y(e,L(w,m)),l=!0}return l},get:function(e){var t=f.m5;return k(I)&&!P(n,e)&&(t=m(e)),t},del:function(e,t){var r=!1;return k(I)&&(r=I.purge(e,t)),r},purge:function(e,r){var n,i=!1;if(x(t)){var o=((n={})[f.QW]=r||"/",n[v]="Thu, 01 Jan 1970 00:00:01 GMT",n);(0,d.lT)()||(o["max-age"]="0"),w(e,L(f.m5,o)),i=!0}return i}})[u.M5]=function(e){a&&a.rm(),a=null},r);return I[C]=I,I}function x(e){if(null===I){I=!1,!o&&b();try{var t=o.v||{};I=void 0!==t[m]}catch(t){(0,l.ZP)(e,2,68,"Cannot access document.cookie - "+(0,h.lL)(t),{exception:(0,s.mmD)(t)})}}return I}function N(e){var t={};if(e&&e[u.oI]){var r=(0,s.EHq)(e)[u.sY](";");(0,s.Iuo)(r,(function(e){if(e=(0,s.EHq)(e||f.m5)){var r=(0,s.HzD)(e,"=");-1===r?t[e]=null:t[(0,s.EHq)((0,s.ZWZ)(e,r))]=(0,s.EHq)((0,s.P0f)(e,r+1))}}))}return t}function D(e,t){return(0,s.Tnt)(e[t])?e[t]():null}function L(e,t){var r=e||f.m5;return(0,s.zav)(t,(function(e,t){r+="; "+e+((0,s.hXl)(t)?f.m5:"="+t)})),r}function U(e){var t=f.m5;if(!o&&b(),o.v){var r=o.v[m]||f.m5;S!==r&&(E=N(r),S=r),t=(0,s.EHq)(E[e]||f.m5)}return t}function F(e,t){!o&&b(),o.v&&(o.v[m]=e+"="+t)}function q(e){return!(!(0,s.KgX)(e)||!(0,h.Ju)(e,"CPU iPhone OS 12")&&!(0,h.Ju)(e,"iPad; CPU OS 12")&&!((0,h.Ju)(e,"Macintosh; Intel Mac OS X 10_14")&&(0,h.Ju)(e,"Version/")&&(0,h.Ju)(e,"Safari"))&&(!(0,h.Ju)(e,"Macintosh; Intel Mac OS X 10_14")||!(0,s.Cv9)(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!(0,h.Ju)(e,"Chrome/5")&&!(0,h.Ju)(e,"Chrome/6")&&(!(0,h.Ju)(e,"UnrealEngine")||(0,h.Ju)(e,"Chrome"))&&!(0,h.Ju)(e,"UCBrowser/12")&&!(0,h.Ju)(e,"UCBrowser/11"))}},9882:(e,t,r)=>{"use strict";r.d(t,{aq:()=>s,cL:()=>a});var n=r(269),i=r(6492),o=r(6535);function s(){var e=a();return(0,n.P0f)(e,0,8)+"-"+(0,n.P0f)(e,8,12)+"-"+(0,n.P0f)(e,12,16)+"-"+(0,n.P0f)(e,16,20)+"-"+(0,n.P0f)(e,20)}function a(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r=i.m5,s=0;s<4;s++)r+=t[15&(e=(0,o.VN)())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var a=t[8+(3&(0,o.VN)())|0];return(0,n.hKY)(r,0,8)+(0,n.hKY)(r,9,4)+"4"+(0,n.hKY)(r,13,3)+a+(0,n.hKY)(r,16,3)+(0,n.hKY)(r,19,12)}},4276:(e,t,r)=>{"use strict";r.d(t,{T:()=>f,Z:()=>h});var n=r(269),i=r(6182),o=r(3673),s=r(6492),a=r(6535),c="3.3.4",u="."+(0,a.Si)(6),l=0;function d(e){return 1===e[i.re]||9===e[i.re]||!+e[i.re]}function h(e,t){return void 0===t&&(t=!1),(0,o.cH)(e+l+++(t?"."+c:s.m5)+u)}function f(e){var t={id:h("_aiData-"+(e||s.m5)+"."+c),accept:function(e){return d(e)},get:function(e,r,i,s){var a=e[t.id];return a?a[(0,o.cH)(r)]:(s&&(a=function(e,t){var r=t[e.id];if(!r){r={};try{d(t)&&(0,n.vF1)(t,e.id,{e:!1,v:r})}catch(e){}}return r}(t,e),a[(0,o.cH)(r)]=i),i)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}},7867:(e,t,r)=>{"use strict";r.d(t,{$:()=>l,M:()=>d});var n,i=r(269),o=r(6182),s=r(6492),a=[s.fc,s.Yp,s.dI,s.l0],c=null;function u(e,t){return function(){var r=arguments,n=l(t);if(n){var i=n.listener;i&&i[e]&&i[e][o.y9](i,r)}}}function l(e){var t,r=c;return r||!0===e.disableDbgExt||(r=c||((t=(0,i.zS2)("Microsoft"))&&(c=t.ApplicationInsights),c)),r?r.ChromeDbgExt:null}function d(e){if(!n){n={};for(var t=0;t<a[o.oI];t++)n[a[t]]=u(a[t],e)}return n}},3775:(e,t,r)=>{"use strict";r.d(t,{OG:()=>I,Oc:()=>A,WD:()=>m,ZP:()=>C,wq:()=>y,y0:()=>v});var n,i=r(8279),o=r(269),s=r(9749),a=r(6182),c=r(7867),u=r(7292),l=r(6492),d="warnToConsole",h={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},f=((n={})[0]=null,n[1]="errorToConsole",n[2]=d,n[3]="debugToConsole",n);function p(e){return e?'"'+e[a.W7](/\"/g,l.m5)+'"':l.m5}function g(e,t){var r=(0,u.U5)();if(r){var n="log";r[e]&&(n=e),(0,o.Tnt)(r[n])&&r[n](t)}}var m=function(){function e(e,t,r,n){void 0===r&&(r=!1);var i=this;i[a.JR]=e,i[a.pM]=(r?"AI: ":"AI (Internal): ")+e;var o=l.m5;(0,u.Z)()&&(o=(0,u.hm)().stringify(n));var s=(t?" message:"+p(t):l.m5)+(n?" props:"+p(o):l.m5);i[a.pM]+=s}return e.dataType="MessageData",e}();function v(e,t){return(e||{})[a.Uw]||new y(t)}var y=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var r,n,u,l,p,v=0,y={};(0,i.A)(e,this,(function(e){function i(t,r){if(!(v>=u)){var i=!0,o="AITR_"+r[a.JR];if(y[o]?i=!1:y[o]=!0,i&&(t<=n&&(e.queue[a.y5](r),v++,w(1===t?"error":"warn",r)),v===u)){var s="Internal events throttle limit per PageView reached for this app.",c=new m(23,s,!1);e.queue[a.y5](c),1===t?e.errorToConsole(s):e[a.on](s)}}}function w(e,r){var n=(0,c.$)(t||{});n&&n[a.e4]&&n[a.e4](e,r)}p=function(t){return(0,s.a)((0,s.e)(t,h,e).cfg,(function(e){var t=e.cfg;r=t[a.Bl],n=t.loggingLevelTelemetry,u=t.maxMessageLimit,l=t.enableDebug}))}(t||{}),e.consoleLoggingLevel=function(){return r},e[a.ih]=function(t,n,s,c,u){void 0===u&&(u=!1);var h=new m(n,s,u,c);if(l)throw(0,o.mmD)(h);var p=f[t]||d;if((0,o.b07)(h[a.pM]))w("throw"+(1===t?"Critical":"Warning"),h);else{if(u){var g=+h[a.JR];!y[g]&&r>=t&&(e[p](h[a.pM]),y[g]=!0)}else r>=t&&e[p](h[a.pM]);i(t,h)}},e.debugToConsole=function(e){g("debug",e),w("warning",e)},e[a.on]=function(e){g("warn",e),w("warning",e)},e.errorToConsole=function(e){g("error",e),w("error",e)},e.resetInternalMessageCount=function(){v=0,y={}},e[a.sx]=i,e[a.M5]=function(e){p&&p.rm(),p=null}}))}return e.__ieDyn=1,e}();function w(e){return e||new y}function C(e,t,r,n,i,o){void 0===o&&(o=!1),w(e)[a.ih](t,r,n,i,o)}function I(e,t){w(e)[a.on](t)}function A(e,t,r){w(e)[a.sx](t,r)}},7292:(e,t,r)=>{"use strict";r.d(t,{$Z:()=>q,Iu:()=>H,L0:()=>x,MY:()=>P,PV:()=>L,R7:()=>D,U5:()=>_,Uf:()=>N,Z:()=>b,cU:()=>E,g$:()=>T,hm:()=>k,iN:()=>R,lT:()=>M,lV:()=>O,xk:()=>U});var n=r(5664),i=r(269),o=r(6182),s=r(3673),a=r(6492),c="documentMode",u="location",l="console",d="JSON",h="crypto",f="msCrypto",p="ReactNative",g="msie",m="trident/",v="XMLHttpRequest",y=null,w=null,C=!1,I=null,A=null;function S(e,t){var r=!1;if(e){try{if(!(r=t in e)){var o=e[n.vR];o&&(r=t in o)}}catch(e){}if(!r)try{var s=new e;r=!(0,i.b07)(s[t])}catch(e){}}return r}function E(e){C=e}function T(e){if(e&&C){var t=(0,i.zS2)("__mockLocation");if(t)return t}return typeof location===n._1&&location?location:(0,i.zS2)(u)}function _(){return typeof console!==n.bA?console:(0,i.zS2)(l)}function b(){return Boolean(typeof JSON===n._1&&JSON||null!==(0,i.zS2)(d))}function k(){return b()?JSON||(0,i.zS2)(d):null}function P(){return(0,i.zS2)(h)}function R(){return(0,i.zS2)(f)}function O(){var e=(0,i.w3n)();return!(!e||!e.product)&&e.product===p}function M(){var e=(0,i.w3n)();if(e&&(e[o.tX]!==w||null===y)){var t=((w=e[o.tX])||a.m5)[o.OL]();y=(0,s.Ju)(t,g)||(0,s.Ju)(t,m)}return y}function x(e){if(void 0===e&&(e=null),!e){var t=(0,i.w3n)()||{};e=t?(t.userAgent||a.m5)[o.OL]():a.m5}var r=(e||a.m5)[o.OL]();if((0,s.Ju)(r,g)){var n=(0,i.YEm)()||{};return Math.max(parseInt(r[o.sY](g)[1]),n[c]||0)}if((0,s.Ju)(r,m)){var u=parseInt(r[o.sY](m)[1]);if(u)return u+4}return null}function N(e){return null!==A&&!1!==e||(A=(0,i.w9M)()&&Boolean((0,i.w3n)().sendBeacon)),A}function D(e){var t=!1;try{t=!!(0,i.zS2)("fetch");var r=(0,i.zS2)("Request");t&&e&&r&&(t=S(r,"keepalive"))}catch(e){}return t}function L(){return null===I&&(I=typeof XDomainRequest!==n.bA)&&U()&&(I=I&&!S((0,i.zS2)(v),"withCredentials")),I}function U(){var e=!1;try{e=!!(0,i.zS2)(v)}catch(e){}return e}function F(e,t){if(e)for(var r=0;r<e[o.oI];r++){var n=e[r];if(n[o.RS]&&n[o.RS]===t)return n}return{}}function q(e){var t=(0,i.YEm)();return t&&e?F(t.querySelectorAll("meta"),e).content:null}function H(e){var t,r=(0,i.FJj)();if(r){var n=r.getEntriesByType("navigation")||[];t=F((n[o.oI]>0?n[0]:{}).serverTiming,e).description}return t}},6149:(e,t,r)=>{"use strict";r.d(t,{Ds:()=>B,El:()=>b,Fc:()=>$,Hm:()=>O,ML:()=>x,Q3:()=>N,So:()=>L,Wg:()=>H,Ym:()=>D,ee:()=>j,lQ:()=>q,mB:()=>M,oS:()=>V,sq:()=>z,vF:()=>K,zh:()=>U});var n=r(269),i=r(6182),o=r(4276),s=r(6492),a="on",c="attachEvent",u="addEventListener",l="detachEvent",d="removeEventListener",h="events",f="visibilitychange",p="pagehide",g="pageshow",m="unload",v="beforeunload",y=(0,o.Z)("aiEvtPageHide"),w=(0,o.Z)("aiEvtPageShow"),C=/\.[\.]+/g,I=/[\.]+$/,A=1,S=(0,o.T)("events"),E=/^([^.]*)(?:\.(.+)|)/;function T(e){return e&&e[i.W7]?e[i.W7](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,s.m5):e}function _(e,t){var r;if(t){var o=s.m5;(0,n.cyL)(t)?(o=s.m5,(0,n.Iuo)(t,(function(e){(e=T(e))&&("."!==e[0]&&(e="."+e),o+=e)}))):o=T(t),o&&("."!==o[0]&&(o="."+o),e=(e||s.m5)+o)}var a=E.exec(e||s.m5)||[];return(r={})[i.QM]=a[1],r.ns=(a[2]||s.m5).replace(C,".").replace(I,s.m5)[i.sY](".").sort().join("."),r}function b(e,t,r){var o=[],a=S.get(e,h,{},!1),c=_(t,r);return(0,n.zav)(a,(function(e,t){(0,n.Iuo)(t,(function(e){var t;c[i.QM]&&c[i.QM]!==e.evtName[i.QM]||c.ns&&c.ns!=c.ns||o[i.y5](((t={})[i.RS]=e.evtName[i.QM]+(e.evtName.ns?"."+e.evtName.ns:s.m5),t.handler=e[i.Yo],t))}))})),o}function k(e,t,r){void 0===r&&(r=!0);var n=S.get(e,h,{},r),i=n[t];return i||(i=n[t]=[]),i}function P(e,t,r,n){e&&t&&t[i.QM]&&(e[d]?e[d](t[i.QM],r,n):e[l]&&e[l](a+t[i.QM],r))}function R(e,t,r,n){for(var o=t[i.oI];o--;){var s=t[o];s&&(r.ns&&r.ns!==s.evtName.ns||n&&!n(s)||(P(e,s.evtName,s[i.Yo],s.capture),t[i.Ic](o,1)))}}function O(e,t){return t?_("xx",(0,n.cyL)(t)?[e].concat(t):[e,t]).ns[i.sY]("."):e}function M(e,t,r,n,o){var s;void 0===o&&(o=!1);var l=!1;if(e)try{var d=_(t,n);if(l=function(e,t,r,n){var o=!1;return e&&t&&t[i.QM]&&r&&(e[u]?(e[u](t[i.QM],r,n),o=!0):e[c]&&(e[c](a+t[i.QM],r),o=!0)),o}(e,d,r,o),l&&S.accept(e)){var h=((s={guid:A++,evtName:d})[i.Yo]=r,s.capture=o,s);k(e,d.type)[i.y5](h)}}catch(e){}return l}function x(e,t,r,o,s){if(void 0===s&&(s=!1),e)try{var a=_(t,o),c=!1;!function(e,t,r){if(t[i.QM])R(e,k(e,t[i.QM]),t,r);else{var o=S.get(e,h,{});(0,n.zav)(o,(function(n,i){R(e,i,t,r)})),0===(0,n.cGk)(o)[i.oI]&&S.kill(e,h)}}(e,a,(function(e){return!((!a.ns||r)&&e[i.Yo]!==r||(c=!0,0))})),c||P(e,a,r,s)}catch(e){}}function N(e,t,r,n){return void 0===n&&(n=!1),M(e,t,r,null,n)}function D(e,t,r,n){void 0===n&&(n=!1),x(e,t,r,null,n)}function L(e,t,r){var i=!1,o=(0,n.zkX)();o&&(i=M(o,e,t,r),i=M(o.body,e,t,r)||i);var s=(0,n.YEm)();return s&&(i=M(s,e,t,r)||i),i}function U(e,t,r){var i=(0,n.zkX)();i&&(x(i,e,t,r),x(i.body,e,t,r));var o=(0,n.YEm)();o&&x(o,e,t,r)}function F(e,t,r,o){var s=!1;return t&&e&&e[i.oI]>0&&(0,n.Iuo)(e,(function(e){e&&(r&&-1!==(0,n.rDm)(r,e)||(s=L(e,t,o)||s))})),s}function q(e,t,r,o){var s=!1;return t&&e&&(0,n.cyL)(e)&&!(s=F(e,t,r,o))&&r&&r[i.oI]>0&&(s=F(e,t,null,o)),s}function H(e,t,r){e&&(0,n.cyL)(e)&&(0,n.Iuo)(e,(function(e){e&&U(e,t,r)}))}function j(e,t,r){return q([v,m,p],e,t,r)}function B(e,t){H([v,m,p],e,t)}function $(e,t,r){var i=O(y,r),o=F([p],e,t,i);return t&&-1!==(0,n.rDm)(t,f)||(o=F([f],(function(t){var r=(0,n.YEm)();e&&r&&"hidden"===r.visibilityState&&e(t)}),t,i)||o),!o&&t&&(o=$(e,null,r)),o}function z(e,t){var r=O(y,t);H([p],e,r),H([f],null,r)}function V(e,t,r){var i=O(w,r),o=F([g],e,t,i);return!(o=F([f],(function(t){var r=(0,n.YEm)();e&&r&&"visible"===r.visibilityState&&e(t)}),t,i)||o)&&t&&(o=V(e,null,r)),o}function K(e,t){var r=O(w,t);H([g],e,r),H([f],null,r)}},3673:(e,t,r)=>{"use strict";r.d(t,{CP:()=>S,Gh:()=>l,H$:()=>O,HU:()=>T,IL:()=>M,Ju:()=>h,KY:()=>g,LU:()=>x,Lo:()=>E,RF:()=>w,SZ:()=>I,_u:()=>f,c2:()=>m,cH:()=>d,hW:()=>A,jL:()=>b,lL:()=>p,o$:()=>C,qz:()=>y,r4:()=>_,w3:()=>U});var n=r(269),i=r(5664),o=r(6182),s=r(6492),a=/-([a-z])/g,c=/([^\w\d_$])/g,u=/^(\d+[\w\d_$])/;function l(e){return!(0,n.hXl)(e)}function d(e){var t=e;return t&&(0,n.KgX)(t)&&(t=(t=(t=t[o.W7](a,(function(e,t){return t.toUpperCase()})))[o.W7](c,"_"))[o.W7](u,(function(e,t){return"_"+t}))),t}function h(e,t){return!(!e||!t)&&-1!==(0,n.HzD)(e,t)}function f(e){return e&&e.toISOString()||""}function p(e){return(0,n.bJ7)(e)?e[o.RS]:s.m5}function g(e,t,r,n,i){var o=r;return e&&((o=e[t])===r||i&&!i(o)||n&&!n(r)||(o=r,e[t]=o)),o}function m(e,t,r){var i;return e?!(i=e[t])&&(0,n.hXl)(i)&&(i=(0,n.b07)(r)?{}:r,e[t]=i):i=(0,n.b07)(r)?{}:r,i}function v(e,t){var r=null,i=null;return(0,n.Tnt)(e)?r=e:i=e,function(){var e=arguments;if(r&&(i=r()),i)return i[t][o.y9](i,e)}}function y(e,t,r){if(e&&t&&(0,n.Gvm)(e)&&(0,n.Gvm)(t)){var i=function(i){if((0,n.KgX)(i)){var o=t[i];(0,n.Tnt)(o)?r&&!r(i,!0,t,e)||(e[i]=v(t,i)):r&&!r(i,!1,t,e)||((0,n.KhI)(e,i)&&delete e[i],(0,n.vF1)(e,i,{g:function(){return t[i]},s:function(e){t[i]=e}}))}};for(var o in t)i(o)}return e}function w(e,t,r,i,o){e&&t&&r&&(!1!==o||(0,n.b07)(e[t]))&&(e[t]=v(r,i))}function C(e,t,r,i){return e&&t&&(0,n.Gvm)(e)&&(0,n.cyL)(r)&&(0,n.Iuo)(r,(function(r){(0,n.KgX)(r)&&w(e,r,t,r,i)})),e}function I(e){return function(){var t=this;e&&(0,n.zav)(e,(function(e,r){t[e]=r}))}}function A(e){return e&&n.vE3&&(e=(0,i.s6)((0,n.vE3)({},e))),e}function S(e,t,r,i,s,a){var c=arguments,u=c[0]||{},l=c[o.oI],d=!1,h=1;for(l>0&&(0,n.Lmq)(u)&&(d=u,u=c[h]||{},h++),(0,n.Gvm)(u)||(u={});h<l;h++){var f=c[h],p=(0,n.cyL)(f),g=(0,n.Gvm)(f);for(var m in f)if(p&&m in f||g&&(0,n.KhI)(f,m)){var v=f[m],y=void 0;if(d&&v&&((y=(0,n.cyL)(v))||(0,n.QdQ)(v))){var w=u[m];y?(0,n.cyL)(w)||(w=[]):(0,n.QdQ)(w)||(w={}),v=S(d,w,v)}void 0!==v&&(u[m]=v)}}return u}function E(e){try{return e.responseText}catch(e){}return null}function T(e,t){return e?"XDomainRequest,Response:"+E(e)||0:t}function _(e,t){return e?"XMLHttpRequest,Status:"+e[o.cV]+",Response:"+E(e)||0:t}function b(e,t){return t&&((0,n.EtT)(t)?e=[t].concat(e):(0,n.cyL)(t)&&(e=t.concat(e))),e}Object.getPrototypeOf;var k="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",P="withCredentials",R="timeout";function O(e,t,r,n,i,o){function s(e,t,r){try{e[t]=r}catch(e){}}void 0===n&&(n=!1),void 0===i&&(i=!1);var a=new XMLHttpRequest;return n&&s(a,k,n),r&&s(a,P,r),a.open(e,t,!i),r&&s(a,P,r),!i&&o&&s(a,R,o),a}function M(e){var t={};if((0,n.KgX)(e)){var r=(0,n.EHq)(e)[o.sY](/[\r\n]+/);(0,n.Iuo)(r,(function(e){if(e){var r=e.indexOf(": ");if(-1!==r){var i=(0,n.EHq)(e.substring(0,r))[o.OL](),s=(0,n.EHq)(e.substring(r+1));t[i]=s}else t[(0,n.EHq)(e)]=1}}))}return t}function x(e,t,r){if(!e[r]&&t&&t[o.Az]){var i=t[o.Az](r);i&&(e[r]=(0,n.EHq)(i))}return e}var N="kill-duration",D="kill-duration-seconds",L="time-delta-millis";function U(e,t){var r={};return e[o.wJ]?r=M(e[o.wJ]()):t&&(r=x(r,e,L),r=x(r,e,N),r=x(r,e,D)),r}},6492:(e,t,r)=>{"use strict";r.d(t,{Bw:()=>u,Ev:()=>w,Fk:()=>I,HP:()=>n,Hr:()=>c,LZ:()=>o,QW:()=>A,Vj:()=>y,Vo:()=>h,Yd:()=>a,Yp:()=>p,dI:()=>g,eT:()=>s,fc:()=>f,jy:()=>l,kI:()=>C,l0:()=>m,m5:()=>i,qT:()=>d,s4:()=>v,xW:()=>S});var n=void 0,i="",o="channels",s="core",a="createPerfMgr",c="disabled",u="extensionConfig",l="extensions",d="processTelemetry",h="priority",f="eventsSent",p="eventsDiscarded",g="eventsSendRequest",m="perfEvent",v="offlineEventsStored",y="offlineBatchSent",w="offlineBatchDrop",C="getPerfMgr",I="domain",A="path",S="Not dynamic - "},1356:(e,t,r)=>{"use strict";r.d(t,{h:()=>h});var n=r(8279),i=r(8205),o=r(269),s=r(9749),a=r(6182),c=r(6492),u={perfEvtsSendAll:!1};function l(e){e.h=null;var t=e.cb;e.cb=[],(0,o.Iuo)(t,(function(e){(0,o.gBW)(e.fn,[e.arg])}))}function d(e,t,r,n){(0,o.Iuo)(e,(function(e){e&&e[t]&&(r?(r.cb[a.y5]({fn:n,arg:e}),r.h=r.h||(0,o.dRz)(l,0,r)):(0,o.gBW)(n,[e]))}))}var h=function(){function e(t){var r,l;this.listeners=[];var h=[],f={h:null,cb:[]},p=(0,s.e)(t,u);l=p[a.x6]((function(e){r=!!e.cfg.perfEvtsSendAll})),(0,n.A)(e,this,(function(e){(0,o.vF1)(e,"listeners",{g:function(){return h}}),e[a.vR]=function(e){h[a.y5](e)},e[a.h3]=function(e){for(var t=(0,o.rDm)(h,e);t>-1;)h[a.Ic](t,1),t=(0,o.rDm)(h,e)},e[c.fc]=function(e){d(h,c.fc,f,(function(t){t[c.fc](e)}))},e[c.Yp]=function(e,t){d(h,c.Yp,f,(function(r){r[c.Yp](e,t)}))},e[c.dI]=function(e,t){d(h,c.dI,t?f:null,(function(r){r[c.dI](e,t)}))},e[c.l0]=function(e){e&&(!r&&e[a.Zu]()||d(h,c.l0,null,(function(t){e[a.tI]?(0,o.dRz)((function(){return t[c.l0](e)}),0):t[c.l0](e)})))},e[c.s4]=function(e){e&&e[a.oI]&&d(h,c.s4,f,(function(t){t[c.s4](e)}))},e[c.Vj]=function(e){e&&e[a.Cd]&&d(h,c.Vj,f,(function(t){t[c.Vj](e)}))},e[c.Ev]=function(e,t){if(e>0){var r=t||0;d(h,c.Ev,f,(function(t){t[c.Ev](e,r)}))}},e[a.M5]=function(e){var t,r=function(){l&&l.rm(),l=null,h=[],f.h&&f.h[a._w](),f.h=null,f.cb=[]};if(d(h,"unload",null,(function(r){var n=r[a.M5](e);n&&(t||(t=[]),t[a.y5](n))})),t)return(0,i.Qo)((function(e){return(0,i.Dv)((0,i.Xf)(t),(function(){r(),e()}))}));r()}}))}return e.__ieDyn=1,e}()},8156:(e,t,r)=>{"use strict";r.d(t,{NS:()=>h,Q6:()=>d,Z4:()=>g,r2:()=>p});var n=r(8279),i=r(269),o=r(6182),s=r(6492),a="ctx",c="ParentContextKey",u="ChildrenContextKey",l=null,d=function(){function e(t,r,n){var s,l=this;l.start=(0,i.f0d)(),l[o.RS]=t,l[o.tI]=n,l[o.Zu]=function(){return!1},(0,i.Tnt)(r)&&(0,i.vF1)(l,"payload",{g:function(){return!s&&(0,i.Tnt)(r)&&(s=r(),r=null),s}}),l[o.O_]=function(t){return t?t===e[c]||t===e[u]?l[t]:(l[a]||{})[t]:null},l[o.e_]=function(t,r){t&&(t===e[c]?(l[t]||(l[o.Zu]=function(){return!0}),l[t]=r):t===e[u]?l[t]=r:(l[a]=l[a]||{})[t]=r)},l[o.Ru]=function(){var t=0,r=l[o.O_](e[u]);if((0,i.cyL)(r))for(var n=0;n<r[o.oI];n++){var s=r[n];s&&(t+=s[o.fA])}l[o.fA]=(0,i.f0d)()-l.start,l.exTime=l[o.fA]-t,l[o.Ru]=function(){}}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),h=function(){function e(t){this.ctx={},(0,n.A)(e,this,(function(e){e.create=function(e,t,r){return new d(e,t,r)},e.fire=function(e){e&&(e[o.Ru](),t&&(0,i.Tnt)(t[s.l0])&&t[s.l0](e))},e[o.e_]=function(t,r){t&&((e[a]=e[a]||{})[t]=r)},e[o.O_]=function(t){return(e[a]||{})[t]}}))}return e.__ieDyn=1,e}(),f="CoreUtils.doPerf";function p(e,t,r,n,i){if(e){var a=e;if(a[s.kI]&&(a=a[s.kI]()),a){var l=void 0,h=a[o.O_](f);try{if(l=a.create(t(),n,i)){if(h&&l[o.e_]&&(l[o.e_](d[c],h),h[o.O_]&&h[o.e_])){var p=h[o.O_](d[u]);p||(p=[],h[o.e_](d[u],p)),p[o.y5](l)}return a[o.e_](f,l),r(l)}}catch(e){l&&l[o.e_]&&l[o.e_]("exception",e)}finally{l&&a.fire(l),a[o.e_](f,h)}}}return r()}function g(){return l}},2317:(e,t,r)=>{"use strict";r.d(t,{PV:()=>C,W0:()=>I,i8:()=>v,nU:()=>w,tS:()=>y});var n=r(269),i=r(991),o=r(9749),s=r(6182),a=r(3775),c=r(3673),u=r(6492),l=r(8156),d=r(380),h="TelemetryPluginChain",f="_hasRun",p="_getTelCtx",g=0;function m(e,t,r,c){var l=null,d=[];t||(t=(0,o.e)({},null,r[s.Uw])),null!==c&&(l=c?function(e,t,r){for(;e;){if(e[s.AP]()===r)return e;e=e[s.uR]()}return C([r],t.config||{},t)}(e,r,c):e);var h={_next:function(){var e=l;if(l=e?e[s.uR]():null,!e){var t=d;t&&t[s.oI]>0&&((0,n.Iuo)(t,(function(e){try{e.func.call(e.self,e.args)}catch(e){(0,a.ZP)(r[s.Uw],2,73,"Unexpected Exception during onComplete - "+(0,n.mmD)(e))}})),d=[])}return e},ctx:{core:function(){return r},diagLog:function(){return(0,a.y0)(r,t.cfg)},getCfg:function(){return t.cfg},getExtCfg:function(e,r){var o=f(e,!0);return r&&(0,n.zav)(r,(function(e,r){if((0,n.hXl)(o[e])){var s=t.cfg[e];!s&&(0,n.hXl)(s)||(o[e]=s)}(0,i.q)(t,o,e,r)})),t[s.h0](o,r)},getConfig:function(e,r,i){void 0===i&&(i=!1);var o,s=f(e,!1),a=t.cfg;return!s||!s[r]&&(0,n.hXl)(s[r])?!a[r]&&(0,n.hXl)(a[r])||(o=a[r]):o=s[r],o||!(0,n.hXl)(o)?o:i},hasNext:function(){return!!l},getNext:function(){return l},setNext:function(e){l=e},iterate:function(e){for(var t;t=h._next();){var r=t[s.AP]();r&&e(r)}},onComplete:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];e&&d[s.y5]({func:e,self:(0,n.b07)(t)?h.ctx:t,args:r})}}};function f(e,r){var n=null,i=t.cfg;if(i&&e){var o=i[u.Bw];!o&&r&&(o={}),i[u.Bw]=o,(o=t.ref(i,u.Bw))&&(!(n=o[e])&&r&&(n={}),o[e]=n,n=t.ref(o,e))}return n}return h}function v(e,t,r,i){var a=(0,o.e)(t),c=m(e,a,r,i),l=c.ctx;return l[s.$5]=function(e){var t=c._next();return t&&t[u.qT](e,l),!t},l[s.$o]=function(e,t){return void 0===e&&(e=null),(0,n.cyL)(e)&&(e=C(e,a.cfg,r,t)),v(e||l[s.uR](),a.cfg,r,t)},l}function y(e,t,r){var i=(0,o.e)(t.config),a=m(e,i,t,r),c=a.ctx;return c[s.$5]=function(e){var t=a._next();return t&&t[s.M5](c,e),!t},c[s.$o]=function(e,r){return void 0===e&&(e=null),(0,n.cyL)(e)&&(e=C(e,i.cfg,t,r)),y(e||c[s.uR](),t,r)},c}function w(e,t,r){var i=(0,o.e)(t.config),a=m(e,i,t,r).ctx;return a[s.$5]=function(e){return a.iterate((function(t){(0,n.Tnt)(t[s.HC])&&t[s.HC](a,e)}))},a[s.$o]=function(e,r){return void 0===e&&(e=null),(0,n.cyL)(e)&&(e=C(e,i.cfg,t,r)),w(e||a[s.uR](),t,r)},a}function C(e,t,r,i){var o=null,c=!i;if((0,n.cyL)(e)&&e[s.oI]>0){var m=null;(0,n.Iuo)(e,(function(e){if(c||i!==e||(c=!0),c&&e&&(0,n.Tnt)(e[u.qT])){var y=function(e,t,r){var i,o=null,c=(0,n.Tnt)(e[u.qT]),m=(0,n.Tnt)(e[s.YH]),y={getPlugin:function(){return e},getNext:function(){return o},processTelemetry:function(i,a){w(a=a||function(){var i;return e&&(0,n.Tnt)(e[p])&&(i=e[p]()),i||(i=v(y,t,r)),i}(),(function(t){if(!e||!c)return!1;var r=(0,d.Cr)(e);return!r[s.Ik]&&!r[u.Hr]&&(m&&e[s.YH](o),e[u.qT](i,t),!0)}),"processTelemetry",(function(){return{item:i}}),!i.sync)||a[s.$5](i)},unload:function(t,r){w(t,(function(){var n=!1;if(e){var i=(0,d.Cr)(e),o=e[u.eT]||i[u.eT];!e||o&&o!==t.core()||i[s.Ik]||(i[u.eT]=null,i[s.Ik]=!0,i[s.tZ]=!1,e[s.Ik]&&!0===e[s.Ik](t,r)&&(n=!0))}return n}),"unload",(function(){}),r[s.tI])||t[s.$5](r)},update:function(t,r){w(t,(function(){var n=!1;if(e){var i=(0,d.Cr)(e),o=e[u.eT]||i[u.eT];!e||o&&o!==t.core()||i[s.Ik]||e[s.HC]&&!0===e[s.HC](t,r)&&(n=!0)}return n}),"update",(function(){}),!1)||t[s.$5](r)},_id:i=e?e[s.Ju]+"-"+e[u.Vo]+"-"+g++:"Unknown-0-"+g++,_setNext:function(e){o=e}};function w(t,r,c,d,p){var g=!1,m=e?e[s.Ju]:h,v=t[f];return v||(v=t[f]={}),t.setNext(o),e&&(0,l.r2)(t[u.eT](),(function(){return m+":"+c}),(function(){v[i]=!0;try{var e=o?o._id:u.m5;e&&(v[e]=!1),g=r(t)}catch(e){var l=!o||v[o._id];l&&(g=!0),o&&l||(0,a.ZP)(t[s.e4](),1,73,"Plugin ["+m+"] failed during "+c+" - "+(0,n.mmD)(e)+", run flags: "+(0,n.mmD)(v))}}),d,p),g}return(0,n.N6t)(y)}(e,t,r);o||(o=y),m&&m._setNext(y),m=y}}))}return i&&!o?C([i],t,r):o}var I=function(e,t,r,i){var o=v(e,t,r,i);(0,c.o$)(this,o,(0,n.cGk)(o))}},6535:(e,t,r)=>{"use strict";r.d(t,{Si:()=>v,VN:()=>m,Z1:()=>g});var n=r(269),i=r(6182),o=r(7292),s=r(6492),a=4294967296,c=4294967295,u=123456789,l=987654321,d=!1,h=u,f=l;function p(){try{var e=2147483647&(0,n.f0d)();(t=(Math.random()*a^e)+e)<0&&(t>>>=0),h=u+t&c,f=l-t&c,d=!0}catch(e){}var t}function g(e){return e>0?Math.floor(m()/c*(e+1))>>>0:0}function m(e){var t=0,r=(0,o.MY)()||(0,o.iN)();return r&&r.getRandomValues&&(t=r.getRandomValues(new Uint32Array(1))[0]&c),0===t&&(0,o.lT)()&&(d||p(),t=function(e){var t=((f=36969*(65535&f)+(f>>16)&c)<<16)+(65535&(h=18e3*(65535&h)+(h>>16)&c))>>>0&c;return t>>>=0}()&c),0===t&&(t=Math.floor(a*Math.random()|0)),e||(t>>>=0),t}function v(e){void 0===e&&(e=22);for(var t=m()>>>0,r=0,n=s.m5;n[i.oI]<e;)r++,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===r&&(t=(m()<<2&4294967295|3&t)>>>0,r=0);return n}},1190:(e,t,r)=>{"use strict";r.d(t,{x:()=>a});var n=r(269),i=r(6182),o=r(3775),s=r(7292);function a(e,t){try{if(e&&""!==e){var r=(0,s.hm)().parse(e);if(r&&r[i.cp]&&r[i.cp]>=r.itemsAccepted&&r.itemsReceived-r.itemsAccepted===r.errors[i.oI])return r}}catch(r){(0,o.ZP)(t,1,43,"Cannot parse the response. "+(r[i.RS]||(0,n.mmD)(r)),{response:e})}return null}},856:(e,t,r)=>{"use strict";r.d(t,{v:()=>p});var n=r(8279),i=r(8205),o=r(269),s=r(6182),a=r(7847),c=r(3775),u=r(7292),l=r(3673),d="",h="&NoResponseBody=true",f="POST",p=function(){function e(){var t,r,p,g,m,v,y,w,C,I,A,S,E,T,_=0;(0,n.A)(e,this,(function(e,n){var b=!0;function k(e,t){(0,c.ZP)(p,2,26,"Failed to send telemetry.",{message:e}),R(t,400,{})}function P(e){k("No endpoint url is provided for the batch",e)}function R(e,t,r,n){try{e&&e(t,r,n)}catch(e){}}function O(e,t){var r=(0,o.w3n)(),n=e[s.Vq];if(!n)return P(t),!0;n=e[s.Vq]+(E?h:d);var i=e[s.Cd],a=g?i:new Blob([i],{type:"text/plain;charset=UTF-8"});return r.sendBeacon(n,a)}function M(e,t,r){var n=e[s.Cd];try{if(n)if(O(e,t))R(t,200,{},d);else{var i=m&&m.beaconOnRetry;i&&(0,o.Tnt)(i)?i(e,t,O):(w&&w[s.L](e,t,!0),(0,c.ZP)(p,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(e){g&&(0,c.OG)(p,"Failed to send telemetry using sendBeacon API. Ex:"+(0,o.mmD)(e)),R(t,g?0:400,{},d)}}function x(e,r,n){var a,c,u,h=e[s.c1]||{};!n&&t&&(a=(0,i.Qo)((function(e,t){c=e,u=t}))),g&&n&&e.disableXhrSync&&(n=!1);var p=e[s.Vq];if(!p)return P(r),void(c&&c(!1));var v=(0,l.H$)(f,p,b,!0,n,e[s.do]);function y(t){var n=m&&m.xhrOnComplete;if(n&&(0,o.Tnt)(n))n(t,r,e);else{var i=(0,l.Lo)(t);R(r,t[s.cV],(0,l.w3)(t,g),i)}}return g||v[s.yy]("Content-type","application/json"),(0,o.Iuo)((0,o.cGk)(h),(function(e){v[s.yy](e,h[e])})),v.onreadystatechange=function(){g||(y(v),4===v.readyState&&c&&c(!0))},v.onload=function(){g&&y(v)},v.onerror=function(e){R(r,g?v[s.cV]:400,(0,l.w3)(v,g),g?d:(0,l.r4)(v)),u&&u(e)},v.ontimeout=function(){R(r,g?v[s.cV]:500,(0,l.w3)(v,g),g?d:(0,l.r4)(v)),c&&c(!1)},v.send(e[s.Cd]),a}function N(e,r,n){var c,u,l,p,v=e[s.Vq],w=e[s.Cd],C=g?w:new Blob([w],{type:"application/json"}),I=new Headers,A=w[s.oI],S=!1,k=!1,O=e[s.c1]||{},M=((c={method:f,body:C})[a.x]=!0,c);e.headers&&(0,o.cGk)(e.headers)[s.oI]>0&&((0,o.Iuo)((0,o.cGk)(O),(function(e){I.append(e,O[e])})),M[s.c1]=I),y?M.credentials=y:b&&g&&(M.credentials="include"),n&&(M.keepalive=!0,_+=A,g?2===e._sendReason&&(S=!0,E&&(v+=h)):S=!0);var x=new Request(v,M);try{x[a.x]=!0}catch(e){}if(!n&&t&&(u=(0,i.Qo)((function(e,t){l=e,p=t}))),!v)return P(r),void(l&&l(!1));function N(e){R(r,g?0:400,{},g?d:e)}function D(e,t,n){var i=e[s.cV],a=m.fetchOnComplete;a&&(0,o.Tnt)(a)?a(e,r,n||d,t):R(r,i,{},n||d)}try{(0,i.Dv)(fetch(g?v:x,g?M:null),(function(t){if(n&&(_-=A,A=0),!k)if(k=!0,t.rejected)N(t.reason&&t.reason[s.pM]),p&&p(t.reason);else{var r=t[s.pF];try{g||r.ok?g&&!r.body?(D(r,null,d),l&&l(!0)):(0,i.Dv)(r.text(),(function(t){D(r,e,t[s.pF]),l&&l(!0)})):(N(r.statusText),l&&l(!1))}catch(e){N((0,o.mmD)(e)),p&&p(e)}}}))}catch(e){k||(N((0,o.mmD)(e)),p&&p(e))}return S&&!k&&(k=!0,R(r,200,{}),l&&l(!0)),g&&!k&&e[s.do]>0&&T&&T.set((function(){k||(k=!0,R(r,500,{}),l&&l(!0))}),e[s.do]),u}function D(e,t,r){var n=(0,o.zkX)(),i=new XDomainRequest,a=e[s.Cd];i.onload=function(){var r=(0,l.Lo)(i),n=m&&m.xdrOnComplete;n&&(0,o.Tnt)(n)?n(i,t,e):R(t,200,{},r)},i.onerror=function(){R(t,400,{},g?d:(0,l.HU)(i))},i.ontimeout=function(){R(t,500,{})},i.onprogress=function(){};var u=n&&n.location&&n.location[s.Qg]||"",h=e[s.Vq];if(h){if(!g&&0!==h.lastIndexOf(u,0)){var v="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";return(0,c.ZP)(p,2,40,". "+v),void k(v,t)}var y=g?h:h[s.W7](/^(https?:)/,"");i.open(f,y),e[s.do]&&(i[s.do]=e[s.do]),i.send(a),g&&r?T&&T.set((function(){i.send(a)}),0):i.send(a)}else P(t)}function L(){_=0,r=!1,t=!1,p=null,g=null,m=null,v=null,y=null,w=null,C=!1,I=!1,A=!1,S=!1,E=!1,T=null}L(),e[s.mE]=function(t,n){p=n,r&&(0,c.ZP)(p,1,28,"Sender is already initialized"),e.SetConfig(t),r=!0},e._getDbgPlgTargets=function(){return[r,g,v,t]},e.SetConfig=function(e){try{if(m=e.senderOnCompleteCallBack||{},v=!!e.disableCredentials,y=e.fetchCredentials,g=!!e.isOneDs,t=!!e.enableSendPromise,C=!!e.disableXhr,I=!!e.disableBeacon,A=!!e.disableBeaconSync,T=e.timeWrapper,E=!!e.addNoResponse,S=!!e.disableFetchKeepAlive,w={sendPOST:x},g||(b=!1),v){var r=(0,u.g$)();r&&r.protocol&&"file:"===r.protocol[s.OL]()&&(b=!1)}return!0}catch(e){}return!1},e.getSyncFetchPayload=function(){return _},e.getSenderInst=function(e,t){return e&&e[s.oI]?function(e,t){for(var r,n=0,i=null,o=0;null==i&&o<e[s.oI];)n=e[o],C||1!==n?2!==n||!(0,u.R7)(t)||t&&S?3!==n||!(0,u.Uf)()||(t?A:I)||(i=M):i=N:(0,u.PV)()?i=D:(0,u.xk)()&&(i=x),o++;return i?((r={_transport:n,_isSync:t})[s.L]=i,r):null}(e,t):null},e.getFallbackInst=function(){return w},e[s.tn]=function(e,t){L()}}))}return e.__ieDyn=1,e}()},380:(e,t,r)=>{"use strict";r.d(t,{Cr:()=>u,Xc:()=>d,pI:()=>l,u7:()=>h});var n=r(269),i=r(6182),o=r(4276),s=r(6492),a=r(1864),c=(0,o.T)("plugin");function u(e){return c.get(e,"state",{},!0)}function l(e,t){for(var r,o=[],a=null,c=e[i.uR]();c;){var l=c[i.AP]();if(l){a&&a[i.YH]&&l[s.qT]&&a[i.YH](l);var d=!!(r=u(l))[i.tZ];l[i.tZ]&&(d=l[i.tZ]()),d||o[i.y5](l),a=l,c=c[i.uR]()}}(0,n.Iuo)(o,(function(n){var o=e[s.eT]();n[i.mE](e.getCfg(),o,t,e[i.uR]()),r=u(n),n[s.eT]||r[s.eT]||(r[s.eT]=o),r[i.tZ]=!0,delete r[i.Ik]}))}function d(e){return e.sort((function(e,t){var r=0;if(t){var n=t[s.qT];e[s.qT]?r=n?e[s.Vo]-t[s.Vo]:1:n&&(r=-1)}else r=e?1:-1;return r}))}function h(e){var t={};return{getName:function(){return t[i.RS]},setName:function(r){e&&e.setName(r),t[i.RS]=r},getTraceId:function(){return t[i.P5]},setTraceId:function(r){e&&e.setTraceId(r),(0,a.hX)(r)&&(t[i.P5]=r)},getSpanId:function(){return t[i.wi]},setSpanId:function(r){e&&e.setSpanId(r),(0,a.wN)(r)&&(t[i.wi]=r)},getTraceFlags:function(){return t[i.Rr]},setTraceFlags:function(r){e&&e.setTraceFlags(r),t[i.Rr]=r}}}},836:(e,t,r)=>{"use strict";r.d(t,{P:()=>s});var n=r(269),i=r(6182),o=r(3775);function s(){var e=[];return{add:function(t){t&&e[i.y5](t)},run:function(t,r){(0,n.Iuo)(e,(function(e){try{e(t,r)}catch(e){(0,o.ZP)(t[i.e4](),2,73,"Unexpected error calling unload handler - "+(0,n.mmD)(e))}})),e=[]}}}},8969:(e,t,r)=>{"use strict";r.d(t,{d:()=>c,w:()=>u});var n,i,o=r(269),s=r(6182),a=r(3775);function c(e,t){n=e,i=t}function u(){var e=[];return{run:function(t){var r=e;e=[],(0,o.Iuo)(r,(function(e){try{(e.rm||e.remove).call(e)}catch(e){(0,a.ZP)(t,2,73,"Unloading:"+(0,o.mmD)(e))}})),n&&r[s.oI]>n&&(i?i("doUnload",r):(0,a.ZP)(null,1,48,"Max unload hooks exceeded. An excessive number of unload hooks has been detected."))},add:function(t){t&&((0,o.Yny)(e,t),n&&e[s.oI]>n&&(i?i("Add",e):(0,a.ZP)(null,1,48,"Max unload hooks exceeded. An excessive number of unload hooks has been detected.")))}}}},1864:(e,t,r)=>{"use strict";r.d(t,{L0:()=>S,N7:()=>A,V5:()=>T,ZI:()=>y,ef:()=>E,hX:()=>w,mJ:()=>I,wN:()=>C,wk:()=>v});var n=r(269),i=r(6182),o=r(9882),s=r(7292),a=r(6492),c=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]{1,64})?$/i,u="00",l="ff",d="00000000000000000000000000000000",h="0000000000000000",f=1;function p(e,t,r){return!(!e||e[i.oI]!==t||e===r||!e.match(/^[\da-f]*$/i))}function g(e,t,r){return p(e,t)?e:r}function m(e){(isNaN(e)||e<0||e>255)&&(e=1);for(var t=e.toString(16);t[i.oI]<2;)t="0"+t;return t}function v(e,t,r,s){var a;return(a={})[i.s]=p(s,2,l)?s:u,a[i.P5]=w(e)?e:(0,o.cL)(),a[i.wi]=C(t)?t:(0,n.ZWZ)((0,o.cL)(),16),a.traceFlags=r>=0&&r<=255?r:1,a}function y(e,t){var r;if(!e)return null;if((0,n.cyL)(e)&&(e=e[0]||""),!e||!(0,n.KgX)(e)||e[i.oI]>8192)return null;if(-1!==e.indexOf(",")){var o=e[i.sY](",");e=o[t>0&&o[i.oI]>t?t:0]}var s=c.exec((0,n.EHq)(e));return s&&s[1]!==l&&s[2]!==d&&s[3]!==h?((r={version:(s[1]||a.m5)[i.OL](),traceId:(s[2]||a.m5)[i.OL](),spanId:(s[3]||a.m5)[i.OL]()})[i.Rr]=parseInt(s[4],16),r):null}function w(e){return p(e,32,d)}function C(e){return p(e,16,h)}function I(e){return!!(e&&p(e[i.s],2,l)&&p(e[i.P5],32,d)&&p(e[i.wi],16,h)&&p(m(e[i.Rr]),2))}function A(e){return!!I(e)&&(e[i.Rr]&f)===f}function S(e){if(e){var t=m(e[i.Rr]);p(t,2)||(t="01");var r=e[i.s]||u;return"00"!==r&&"ff"!==r&&(r=u),"".concat(r.toLowerCase(),"-").concat(g(e.traceId,32,d).toLowerCase(),"-").concat(g(e.spanId,16,h).toLowerCase(),"-").concat(t.toLowerCase())}return""}function E(e){var t="traceparent",r=y((0,s.$Z)(t),e);return r||(r=y((0,s.Iu)(t),e)),r}function T(e){var t=e.getElementsByTagName("script"),r=[];return(0,n.Iuo)(t,(function(e){var t=e[i.NA]("src");if(t){var n=e[i.NA]("crossorigin"),o=!0===e.hasAttribute("async"),s=!0===e.hasAttribute("defer"),a=e[i.NA]("referrerpolicy"),c={url:t};n&&(c.crossOrigin=n),o&&(c.async=o),s&&(c.defer=s),a&&(c.referrerPolicy=a),r[i.y5](c)}})),r}},6182:(e,t,r)=>{"use strict";r.d(t,{$5:()=>O,$o:()=>H,AP:()=>b,Az:()=>oe,Bl:()=>q,Cd:()=>ce,DI:()=>M,Di:()=>D,FI:()=>P,HC:()=>G,Ic:()=>g,Ik:()=>j,JQ:()=>i,JR:()=>B,Ju:()=>w,K0:()=>m,L:()=>pe,M5:()=>L,NA:()=>Ie,OL:()=>n,O_:()=>ue,P5:()=>ye,QM:()=>re,Qg:()=>Y,RF:()=>_,RS:()=>k,Rr:()=>Ce,Ru:()=>de,Uw:()=>h,Vq:()=>fe,W7:()=>ee,XM:()=>N,XW:()=>s,YH:()=>X,Yo:()=>ne,Yq:()=>E,Zu:()=>ae,_w:()=>v,by:()=>U,c1:()=>ge,cV:()=>ie,cp:()=>he,do:()=>me,e4:()=>V,e_:()=>le,fA:()=>R,h0:()=>l,h3:()=>C,h4:()=>x,ih:()=>u,mE:()=>y,oI:()=>o,on:()=>c,pF:()=>T,pM:()=>$,re:()=>Z,s:()=>F,sY:()=>J,sl:()=>S,sx:()=>te,tI:()=>z,tX:()=>Q,tZ:()=>A,tn:()=>K,uR:()=>W,vR:()=>I,wJ:()=>se,wi:()=>we,x6:()=>d,y5:()=>p,y9:()=>f,yy:()=>ve,zs:()=>a});var n="toLowerCase",i="blkVal",o="length",s="rdOnly",a="notify",c="warnToConsole",u="throwInternal",l="setDf",d="watch",h="logger",f="apply",p="push",g="splice",m="hdlr",v="cancel",y="initialize",w="identifier",C="removeNotificationListener",I="addNotificationListener",A="isInitialized",S="instrumentationKey",E="INACTIVE",T="value",_="getNotifyMgr",b="getPlugin",k="name",P="iKey",R="time",O="processNext",M="getProcessTelContext",x="pollInternalLogs",N="enabled",D="stopPollingInternalLogs",L="unload",U="onComplete",F="version",q="loggingLevelConsole",H="createNew",j="teardown",B="messageId",$="message",z="isAsync",V="diagLog",K="_doTeardown",G="update",W="getNext",X="setNextPlugin",Y="protocol",Q="userAgent",J="split",Z="nodeType",ee="replace",te="logInternalMessage",re="type",ne="handler",ie="status",oe="getResponseHeader",se="getAllResponseHeaders",ae="isChildEvt",ce="data",ue="getCtx",le="setCtx",de="complete",he="itemsReceived",fe="urlString",pe="sendPOST",ge="headers",me="timeout",ve="setRequestHeader",ye="traceId",we="spanId",Ce="traceFlags",Ie="getAttribute"},5664:(e,t,r)=>{"use strict";r.d(t,{Wy:()=>c,_1:()=>i,bA:()=>o,hW:()=>n,s6:()=>a,vR:()=>s});var n="function",i="object",o="undefined",s="prototype",a=Object,c=a[s]},659:(e,t,r)=>{"use strict";r.d(t,{Im:()=>s,qU:()=>c,vz:()=>u});var n=r(269),i=r(5664),o=(((0,n.mS$)()||{}).Symbol,((0,n.mS$)()||{}).Reflect,"hasOwnProperty"),s=n.vE3||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])i.Wy[o].call(t,s)&&(e[s]=t[s]);return e},a=function(e,t){return a=i.s6.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t[o](r)&&(e[r]=t[r])},a(e,t)};function c(e,t){function r(){this.constructor=e}typeof t!==i.hW&&null!==t&&(0,n.zkd)("Class extends value "+String(t)+" is not a constructor or null"),a(e,t),e[i.vR]=null===t?(0,n.sSX)(t):(r[i.vR]=t[i.vR],new r)}function u(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e}},5927:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AppInsightsCore:()=>vt._,ApplicationInsights:()=>kt,Sender:()=>gt,SeverityLevel:()=>Tt.O,arrForEach:()=>I.Iuo,isNullOrUndefined:()=>I.hXl,proxyFunctions:()=>C.o$,throwError:()=>I.$8});var n=r(8279),i=r(659),o=r(5025),s=r(3072),a=r(2445),c=r(1448),u=r(4164),l=r(5397),d=r(5014),h=r(1365),f=r(740),p=r(7952),g=r(4658),m=r(2318),v=r(2910),y=r(2475),w=r(3775),C=r(3673),I=r(269),A=r(6149),S=r(4276),E=r(9749),T=r(2317),_=r(4875),b=r(7292),k=r(856),P=r(4013),R=r(1190),O=r(8257),M=r(1575),x=r(7975),N=r(1062),D=r(7358),L="duration",U="tags",F="deviceType",q="data",H="name",j="traceID",B="length",$="stringify",z="measurements",V="dataType",K="envelopeType",G="toString",W="_get",X="enqueue",Y="count",Q="eventsLimitInMem",J="push",Z="item",ee="emitLineDelimitedJson",te="clear",re="createNew",ne="markAsSent",ie="clearSent",oe="bufferOverride",se="BUFFER_KEY",ae="SENT_BUFFER_KEY",ce="concat",ue="MAX_BUFFER_SIZE",le="triggerSend",de="diagLog",he="initialize",fe="_sender",pe="endpointUrl",ge="instrumentationKey",me="customHeaders",ve="maxBatchSizeInBytes",ye="onunloadDisableBeacon",we="isBeaconApiDisabled",Ce="alwaysUseXhrOverride",Ie="disableXhr",Ae="enableSessionStorageBuffer",Se="_buffer",Ee="onunloadDisableFetch",Te="disableSendBeaconSplit",_e="enableSendPromise",be="getSenderInst",ke="unloadTransports",Pe="convertUndefined",Re="maxBatchInterval",Oe="serialize",Me="_onError",xe="_onPartialSuccess",Ne="_onSuccess",De="itemsReceived",Le="itemsAccepted",Ue="oriPayload",Fe="baseType",qe="sampleRate",He="eventsSendRequest",je="getSamplingScore",Be="baseType",$e="baseData",ze="properties",Ve="true";function Ke(e,t,r){return(0,C.KY)(e,t,r,I.zzB)}function Ge(e,t,r){(0,I.hXl)(e)||(0,I.zav)(e,(function(e,n){(0,I.EtT)(n)?r[e]=n:(0,I.KgX)(n)?t[e]=n:(0,b.Z)()&&(t[e]=(0,b.hm)()[$](n))}))}function We(e,t){(0,I.hXl)(e)||(0,I.zav)(e,(function(r,n){e[r]=n||t}))}function Xe(e,t,r,n){var s=new N.L(e,n,t);Ke(s,"sampleRate",r[o.tU]),(r[$e]||{}).startTime&&(s.time=(0,C._u)(r[$e].startTime)),s.iKey=r.iKey;var a=r.iKey.replace(/-/g,"");return s[H]=s[H].replace("{0}",a),function(e,t,r){var n=r[U]=r[U]||{},o=t.ext=t.ext||{},s=t[U]=t[U]||[],a=o.user;a&&(Ke(n,M.O.userAuthUserId,a.authId),Ke(n,M.O.userId,a.id||a.localId));var c=o.app;c&&Ke(n,M.O.sessionId,c.sesId);var u=o.device;u&&(Ke(n,M.O.deviceId,u.id||u.localId),Ke(n,M.O[F],u.deviceClass),Ke(n,M.O.deviceIp,u.ip),Ke(n,M.O.deviceModel,u.model),Ke(n,M.O[F],u[F]));var l=t.ext.web;if(l){Ke(n,M.O.deviceLanguage,l.browserLang),Ke(n,M.O.deviceBrowserVersion,l.browserVer),Ke(n,M.O.deviceBrowser,l.browser);var d=r[q]=r[q]||{},h=d[$e]=d[$e]||{},f=h[ze]=h[ze]||{};Ke(f,"domain",l.domain),Ke(f,"isManual",l.isManual?Ve:null),Ke(f,"screenRes",l.screenRes),Ke(f,"userConsent",l.userConsent?Ve:null)}var p=o.os;p&&(Ke(n,M.O.deviceOS,p[H]),Ke(n,M.O.deviceOSVersion,p.osVer));var g=o.trace;g&&(Ke(n,M.O.operationParentId,g.parentID),Ke(n,M.O.operationName,(0,x.Rr)(e,g[H])),Ke(n,M.O.operationId,g[j]));for(var m={},v=s[B]-1;v>=0;v--){var y=s[v];(0,I.zav)(y,(function(e,t){m[e]=t})),s.splice(v,1)}(0,I.zav)(s,(function(e,t){m[e]=t}));var w=(0,i.Im)((0,i.Im)({},n),m);w[M.O.internalSdkVersion]||(w[M.O.internalSdkVersion]=(0,x.Rr)(e,"javascript:".concat(Qe.Version),64)),r[U]=(0,C.hW)(w)}(e,r,s),r[U]=r[U]||[],(0,C.hW)(s)}function Ye(e,t){(0,I.hXl)(t[$e])&&(0,w.ZP)(e,1,46,"telemetryItem.baseData cannot be null.")}var Qe={Version:"3.3.4"};function Je(e,t,r){Ye(e,t);var n={},i={};t[Be]!==s.J[V]&&(n.baseTypeSource=t[Be]),t[Be]===s.J[V]?(n=t[$e][ze]||{},i=t[$e][z]||{}):t[$e]&&Ge(t[$e],n,i),Ge(t[q],n,i),(0,I.hXl)(r)||We(n,r);var o=t[$e][H],a=new s.J(e,o,n,i),c=new D.B(s.J[V],a);return Xe(e,s.J[K],t,c)}var Ze,et,tt=function(){function e(t,r){var i=[],o=!1,s=r.maxRetryCnt;this[W]=function(){return i},this._set=function(e){return i=e},(0,n.A)(e,this,(function(e){e[X]=function(n){e[Y]()>=r[Q]?o||((0,w.ZP)(t,2,105,"Maximum in-memory buffer size reached: "+e[Y](),!0),o=!0):(n.cnt=n.cnt||0,!(0,I.hXl)(s)&&n.cnt>s||i[J](n))},e[Y]=function(){return i[B]},e.size=function(){for(var e=i[B],t=0;t<i[B];t++)e+=i[t].item[B];return r[ee]||(e+=2),e},e[te]=function(){i=[],o=!1},e.getItems=function(){return i.slice(0)},e.batchPayloads=function(e){if(e&&e[B]>0){var t=[];return(0,I.Iuo)(e,(function(e){t[J](e[Z])})),r[ee]?t.join("\n"):"["+t.join(",")+"]"}return null},e[re]=function(e,r,n){var o=i.slice(0);e=e||t,r=r||{};var s=n?new it(e,r):new rt(e,r);return(0,I.Iuo)(o,(function(e){s[X](e)})),s}}))}return e.__ieDyn=1,e}(),rt=function(e){function t(r,i){var o=e.call(this,r,i)||this;return(0,n.A)(t,o,(function(e,t){e[ne]=function(e){t[te]()},e[ie]=function(e){}})),o}return(0,i.qU)(t,e),t.__ieDyn=1,t}(tt),nt=["AI_buffer","AI_sentBuffer"],it=function(e){function t(r,i){var o=e.call(this,r,i)||this,s=!1,a=null==i?void 0:i.namePrefix,c=i[oe]||{getItem:g.vH,setItem:g.Dt},u=c.getItem,l=c.setItem,d=i.maxRetryCnt;return(0,n.A)(t,o,(function(e,n){var i=m(t[se]),o=m(t[ae]),c=function(){var e=[];try{return(0,I.Iuo)(nt,(function(t){var r=A(t);if(e=e[ce](r),a){var n=A(a+"_"+t);e=e[ce](n)}})),e}catch(e){(0,w.ZP)(r,2,41,"Transfer events from previous buffers: "+(0,C.lL)(e)+". previous Buffer items can not be removed",{exception:(0,I.mmD)(e)})}return[]}(),h=o[ce](c),f=e._set(i[ce](h));function p(e,t){var r=[],n=[];return(0,I.Iuo)(e,(function(e){n[J](e[Z])})),(0,I.Iuo)(t,(function(e){(0,I.Tnt)(e)||-1!==(0,I.rDm)(n,e[Z])||r[J](e)})),r}function m(e){return v(a?a+"_"+e:e)}function v(e){try{var t=u(r,e);if(t){var n=(0,b.hm)().parse(t);if((0,I.KgX)(n)&&(n=(0,b.hm)().parse(n)),n&&(0,I.cyL)(n))return n}}catch(t){(0,w.ZP)(r,1,42," storage key: "+e+", "+(0,C.lL)(t),{exception:(0,I.mmD)(t)})}return[]}function y(e,t){var n=e;try{n=a?a+"_"+n:n;var i=JSON[$](t);l(r,n,i)}catch(e){l(r,n,JSON[$]([])),(0,w.ZP)(r,2,41," storage key: "+n+", "+(0,C.lL)(e)+". Buffer cleared",{exception:(0,I.mmD)(e)})}}function A(e){try{var t=v(e),n=[];return(0,I.Iuo)(t,(function(e){var t={item:e,cnt:0};n[J](t)})),(0,g.v7)(r,e),n}catch(e){}return[]}f[B]>t[ue]&&(f[B]=t[ue]),y(t[ae],[]),y(t[se],f),e[X]=function(i){e[Y]()>=t[ue]?s||((0,w.ZP)(r,2,67,"Maximum buffer size reached: "+e[Y](),!0),s=!0):(i.cnt=i.cnt||0,!(0,I.hXl)(d)&&i.cnt>d||(n[X](i),y(t.BUFFER_KEY,e[W]())))},e[te]=function(){n[te](),y(t.BUFFER_KEY,e[W]()),y(t[ae],[]),s=!1},e[ne]=function(n){y(t[se],e._set(p(n,e[W]())));var i=m(t[ae]);i instanceof Array&&n instanceof Array&&((i=i[ce](n))[B]>t[ue]&&((0,w.ZP)(r,1,67,"Sent buffer reached its maximum size: "+i[B],!0),i[B]=t[ue]),y(t[ae],i))},e[ie]=function(e){var r=m(t[ae]);r=p(e,r),y(t[ae],r)},e[re]=function(n,i,o){o=!!o;var s=e[W]().slice(0),a=m(t[ae]).slice(0);n=n||r,i=i||{},e[te]();var c=o?new t(n,i):new rt(n,i);return(0,I.Iuo)(s,(function(e){c[X](e)})),o&&c[ne](a),c}})),o}var r;return(0,i.qU)(t,e),r=t,t.VERSION="_1",t.BUFFER_KEY="AI_buffer"+r.VERSION,t.SENT_BUFFER_KEY="AI_sentBuffer"+r.VERSION,t.MAX_BUFFER_SIZE=2e3,t}(tt),ot=function(){function e(t){(0,n.A)(e,this,(function(e){function r(e,o){var s="__aiCircularRefCheck",a={};if(!e)return(0,w.ZP)(t,1,48,"cannot serialize object because it is null or undefined",{name:o},!0),a;if(e[s])return(0,w.ZP)(t,2,50,"Circular reference detected while serializing object",{name:o},!0),a;if(!e.aiDataContract){if("measurements"===o)a=i(e,"number",o);else if("properties"===o)a=i(e,"string",o);else if("tags"===o)a=i(e,"string",o);else if((0,I.cyL)(e))a=n(e,o);else{(0,w.ZP)(t,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:o},!0);try{(0,b.hm)()[$](e),a=e}catch(e){(0,w.ZP)(t,1,48,e&&(0,I.Tnt)(e[G])?e[G]():"Error serializing object",null,!0)}}return a}return e[s]=!0,(0,I.zav)(e.aiDataContract,(function(i,s){var c=(0,I.Tnt)(s)?1&s():1&s,u=(0,I.Tnt)(s)?4&s():4&s,l=2&s,d=void 0!==e[i],h=(0,I.Gvm)(e[i])&&null!==e[i];if(!c||d||l){if(!u){var f;void 0!==(f=h?l?n(e[i],i):r(e[i],i):e[i])&&(a[i]=f)}}else(0,w.ZP)(t,1,24,"Missing required field specification. The field is required but not present on source",{field:i,name:o})})),delete e[s],a}function n(e,n){var i;if(e)if((0,I.cyL)(e)){i=[];for(var o=0;o<e[B];o++){var s=r(e[o],n+"["+o+"]");i[J](s)}}else(0,w.ZP)(t,1,54,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:n},!0);return i}function i(e,r,n){var i;return e&&(i={},(0,I.zav)(e,(function(e,o){if("string"===r)void 0===o?i[e]="undefined":null===o?i[e]="null":o[G]?i[e]=o[G]():i[e]="invalid field: toString() is not defined.";else if("number"===r)if(void 0===o)i[e]="undefined";else if(null===o)i[e]="null";else{var s=parseFloat(o);i[e]=s}else i[e]="invalid field: "+n+" is of unknown type.",(0,w.ZP)(t,1,i[e],null,!0)}))),i}e[Oe]=function(e){var n=r(e,"root");try{return(0,b.hm)()[$](n)}catch(e){(0,w.ZP)(t,1,48,e&&(0,I.Tnt)(e[G])?e[G]():"Error serializing object",null,!0)}}}))}return e.__ieDyn=1,e}(),st=r(8596),at=function(){function e(){}return e.prototype.getHashCodeScore=function(t){return this.getHashCode(t)/e.INT_MAX_VALUE*100},e.prototype.getHashCode=function(e){if(""===e)return 0;for(;e[B]<8;)e=e[ce](e);for(var t=5381,r=0;r<e[B];++r)t=(t<<5)+t+e.charCodeAt(r),t|=0;return Math.abs(t)},e.INT_MAX_VALUE=2147483647,e}(),ct=function(){var e=new at,t=new st.o;this[je]=function(r){return r[U]&&r[U][t.userId]?e.getHashCodeScore(r[U][t.userId]):r.ext&&r.ext.user&&r.ext.user.id?e.getHashCodeScore(r.ext.user.id):r[U]&&r[U][t.operationId]?e.getHashCodeScore(r[U][t.operationId]):r.ext&&r.ext.telemetryTrace&&r.ext.telemetryTrace[j]?e.getHashCodeScore(r.ext.telemetryTrace[j]):100*Math.random()}},ut=function(){function e(e,t){this.INT_MAX_VALUE=2147483647;var r=t||(0,w.y0)(null);(e>100||e<0)&&(r.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[qe]=e,this.samplingScoreGenerator=new ct}return e.prototype.isSampledIn=function(e){var t=this[qe];return null==t||t>=100||e.baseType===d.J[V]||this.samplingScoreGenerator[je](e)<t},e}(),lt=void 0;function dt(e){try{return e.responseText}catch(e){}return null}var ht,ft=(0,I.ZHX)(((Ze={endpointUrl:(0,y.Lx)(I.zzB,o._G+o.wc)})[ee]=(0,y.DD)(),Ze[Re]=15e3,Ze[ve]=102400,Ze.disableTelemetry=(0,y.DD)(),Ze[Ae]=(0,y.DD)(!0),Ze.isRetryDisabled=(0,y.DD)(),Ze[we]=(0,y.DD)(!0),Ze[Te]=(0,y.DD)(!0),Ze[Ie]=(0,y.DD)(),Ze[Ee]=(0,y.DD)(),Ze[ye]=(0,y.DD)(),Ze[ge]=lt,Ze.namePrefix=lt,Ze.samplingPercentage=(0,y.Lx)((function(e){return!isNaN(e)&&e>0&&e<=100}),100),Ze[me]=lt,Ze[Pe]=lt,Ze[Q]=1e4,Ze[oe]=!1,Ze.httpXHROverride={isVal:function(e){return e&&e.sendPOST},v:lt},Ze[Ce]=(0,y.DD)(),Ze.transports=lt,Ze.retryCodes=lt,Ze.maxRetryCnt={isVal:I.EtT,v:10},Ze)),pt=((et={})[s.J.dataType]=Je,et[a.C.dataType]=function(e,t,r){Ye(e,t);var n=t[$e].message,i=t[$e].severityLevel,o=t[$e][ze]||{},s=t[$e][z]||{};Ge(t[q],o,s),(0,I.hXl)(r)||We(o,r);var c=new a.C(e,n,i,o,s),u=new D.B(a.C[V],c);return Xe(e,a.C[K],t,u)},et[c.h.dataType]=function(e,t,r){var n;Ye(e,t);var i=t[$e];(0,I.hXl)(i)||(0,I.hXl)(i[ze])||(0,I.hXl)(i[ze][L])?(0,I.hXl)(t[q])||(0,I.hXl)(t[q][L])||(n=t[q][L],delete t[q][L]):(n=i[ze][L],delete i[ze][L]);var o,s=t[$e];((t.ext||{}).trace||{})[j]&&(o=t.ext.trace[j]);var a=s.id||o,u=s[H],l=s.uri,d=s[ze]||{},h=s[z]||{};if((0,I.hXl)(s.refUri)||(d.refUri=s.refUri),(0,I.hXl)(s.pageType)||(d.pageType=s.pageType),(0,I.hXl)(s.isLoggedIn)||(d.isLoggedIn=s.isLoggedIn[G]()),!(0,I.hXl)(s[ze])){var f=s[ze];(0,I.zav)(f,(function(e,t){d[e]=t}))}Ge(t[q],d,h),(0,I.hXl)(r)||We(d,r);var p=new c.h(e,u,l,n,d,h,a),g=new D.B(c.h[V],p);return Xe(e,c.h[K],t,g)},et[u.H.dataType]=function(e,t,r){Ye(e,t);var n=t[$e],i=n[H],o=n.uri||n.url,s=n[ze]||{},a=n[z]||{};Ge(t[q],s,a),(0,I.hXl)(r)||We(s,r);var c=new u.H(e,i,o,void 0,s,a,n),l=new D.B(u.H[V],c);return Xe(e,u.H[K],t,l)},et[l.WJ.dataType]=function(e,t,r){Ye(e,t);var n=t[$e][z]||{},i=t[$e][ze]||{};Ge(t[q],i,n),(0,I.hXl)(r)||We(i,r);var o=t[$e],s=l.WJ.CreateFromInterface(e,o,i,n),a=new D.B(l.WJ[V],s);return Xe(e,l.WJ[K],t,a)},et[d.J.dataType]=function(e,t,r){Ye(e,t);var n=t[$e],i=n[ze]||{},o=n[z]||{};Ge(t[q],i,o),(0,I.hXl)(r)||We(i,r);var s=new d.J(e,n[H],n.average,n.sampleCount,n.min,n.max,n.stdDev,i,o),a=new D.B(d.J[V],s);return Xe(e,d.J[K],t,a)},et[h.A.dataType]=function(e,t,r){Ye(e,t);var n=t[$e][z]||{},i=t[$e][ze]||{};Ge(t[q],i,n),(0,I.hXl)(r)||We(i,r);var s=t[$e];if((0,I.hXl)(s))return(0,w.OG)(e,"Invalid input for dependency data"),null;var a=s[ze]&&s[ze][o.ym]?s[ze][o.ym]:"GET",c=new h.A(e,s.id,s.target,s[H],s[L],s.success,s.responseCode,a,s.type,s.correlationContext,i,n),u=new D.B(h.A[V],c);return Xe(e,h.A[K],t,u)},et),gt=function(e){function t(){var r,i,s,a,c,u,l,d=e.call(this)||this;d.priority=1001,d.identifier=f.BreezeChannelIdentifier;var h,y,O,M,x,N,D,L,F,H,j,$,z,V,K,G,W,Q,ee,se,ae,ce,ue,je,Be,$e,ze,Ve=0;return(0,n.A)(t,d,(function(e,n){function f(t,n){var i=dt(t);if(!t||i+""!="200"&&""!==i){var o=(0,R.x)(i);o&&o[De]&&o[De]>o[Le]&&!V?e[xe](n,o):e[Me](n,(0,C.HU)(t))}else r=0,e[Ne](n,0)}function Ke(e,t,r){4===e.readyState&&st(e.status,t,e.responseURL,r,(0,C.r4)(e),dt(e)||e.response)}function Ge(e){try{if(e){var t=e[Ue];return t&&t[B]?t:null}}catch(e){}return null}function We(t,r){return!(j||(t?t.baseData&&!t[Fe]?(r&&(0,w.ZP)(r,1,70,"Cannot send telemetry without baseData and baseType"),1):(t[Fe]||(t[Fe]="EventData"),e[fe]?(n=t,e._sample.isSampledIn(n)?(t[o.tU]=e._sample[qe],0):(r&&(0,w.ZP)(r,2,33,"Telemetry item was sampled out and not sent",{SampleRate:e._sample[qe]}),1)):(r&&(0,w.ZP)(r,1,28,"Sender was not initialized"),1)):(r&&(0,w.ZP)(r,1,7,"Cannot send empty telemetry"),1)));var n}function Xe(e,r){var n=e.iKey||$,i=t.constructEnvelope(e,n,r,z);if(i){var s=!1;if(e[U]&&e[U][o.jp]&&((0,I.Iuo)(e[U][o.jp],(function(e){try{e&&!1===e(i)&&(s=!0,(0,w.OG)(r,"Telemetry processor check returns false"))}catch(e){(0,w.ZP)(r,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+(0,C.lL)(e),{exception:(0,I.mmD)(e)},!0)}})),delete e[U][o.jp]),!s)return i}else(0,w.ZP)(r,1,47,"Unable to create an AppInsights envelope")}function Ye(t){var r="",n=e[de]();try{var i=We(t,n),o=null;i&&(o=Xe(t,n)),o&&(r=c[Oe](o))}catch(e){}return r}function Qe(e){var t="";return e&&e[B]&&(t="["+e.join(",")+"]"),t}function Je(e){var t,r=tt();return(t={urlString:M})[q]=e,t.headers=r,t}function Ze(t,r,n,i){void 0===i&&(i=!0);var o=et(r),s=t&&t.sendPOST;return s&&o?(i&&e._buffer[ne](r),s(o,(function(t,n,i){return function(t,r,n,i){200===r&&t?e._onSuccess(t,t[B]):i&&e[Me](t,i)}(r,t,0,i)}),!n)):null}function et(t){var r;if((0,I.cyL)(t)&&t[B]>0){var n=e[Se].batchPayloads(t),i=tt();return(r={})[q]=n,r.urlString=M,r.headers=i,r.disableXhrSync=ae,r.disableFetchKeepAlive=!ce,r[Ue]=t,r}return null}function tt(){try{var e=l||{};return(0,m.Qu)(M)&&(e[v.a[6]]=v.a[7]),e}catch(e){}return null}function nt(t){var r=t?t[B]:0;return e[Se].size()+r>N&&(y&&!y.isOnline()||e[le](!0,null,10),!0)}function st(t,n,i,o,s,a){var c=null;if(e._appId||(c=(0,R.x)(a))&&c.appId&&(e._appId=c.appId),(t<200||t>=300)&&0!==t){if((301===t||307===t||308===t)&&!at(i))return void e[Me](n,s);if(y&&!y.isOnline())return void(V||(gt(n,10),(0,w.ZP)(e[de](),2,40,". Offline - Response Code: ".concat(t,". Offline status: ").concat(!y.isOnline(),". Will retry to send ").concat(n.length," items."))));!V&&yt(t)?(gt(n),(0,w.ZP)(e[de](),2,40,". Response code "+t+". Will retry to send "+n[B]+" items.")):e[Me](n,s)}else at(i),206===t?(c||(c=(0,R.x)(a)),c&&!V?e[xe](n,c):e[Me](n,s)):(r=0,e[Ne](n,o))}function at(e){return!(u>=10||(0,I.hXl)(e)||""===e||e===M||(M=e,++u,0))}function ct(e,t){if(!h)return Ze($e&&$e[be]([3],!0),e,t);h(e,!1)}function ht(e){try{if(e&&e[B])return(0,I.KgX)(e[0])}catch(e){}return null}function pt(t,r){var n=null;if((0,I.cyL)(t)){for(var i=t[B],o=0;o<t[B];o++)i+=t[o].item[B];return $e.getSyncFetchPayload()+i<=65e3?n=2:(0,b.Uf)()?n=3:(n=1,(0,w.ZP)(e[de](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender.")),Ze($e&&$e[be]([n],!0),t,r)}return null}function gt(t,n){if(void 0===n&&(n=1),t&&0!==t[B]){var o=e[Se];o[ie](t),r++;for(var s=0,a=t;s<a.length;s++){var c=a[s];c.cnt=c.cnt||0,c.cnt++,o[X](c)}!function(e){var t;if(r<=1)t=10;else{var n=(Math.pow(2,r)-1)/2,o=Math.floor(Math.random()*n*10)+1;o*=e,t=Math.max(Math.min(o,3600),10)}var s=(0,I.f0d)()+1e3*t;i=s}(n),mt()}}function mt(){if(!a&&!s){var t=i?Math.max(0,i-(0,I.f0d)()):0,r=Math.max(K,t);a=(0,I.dRz)((function(){a=null,e[le](!0,null,1)}),r)}}function vt(){a&&a.cancel(),a=null,i=null}function yt(e){return(0,I.hXl)(ze)?401===e||408===e||429===e||500===e||502===e||503===e||504===e:ze[B]&&ze.indexOf(e)>-1}function wt(){e[fe]=null,e[Se]=null,e._appId=null,e._sample=null,l={},y=null,r=0,i=null,s=!1,a=null,c=null,u=0,Ve=0,h=null,O=null,M=null,x=null,N=0,D=!1,H=null,j=!1,$=null,z=lt,V=!1,G=null,Q=lt,ae=!1,ce=!1,Be=!1,ue=null,je=null,$e=null,(0,I.vF1)(e,"_senderConfig",{g:function(){return(0,C.CP)({},ft)}})}wt(),e.pause=function(){vt(),s=!0},e.resume=function(){s&&(s=!1,i=null,nt(),mt())},e.flush=function(t,r,n){if(void 0===t&&(t=!0),!s){vt();try{return e[le](t,null,n||1)}catch(t){(0,w.ZP)(e[de](),1,22,"flush failed, telemetry will not be collected: "+(0,C.lL)(t),{exception:(0,I.mmD)(t)})}}},e.onunloadFlush=function(){if(!s)if(D||se)try{return e[le](!0,ct,2)}catch(t){(0,w.ZP)(e[de](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+(0,C.lL)(t),{exception:(0,I.mmD)(t)})}else e.flush(!1)},e.addHeader=function(e,t){l[e]=t},e[he]=function(t,o,s,a){e.isInitialized()&&(0,w.ZP)(e[de](),1,28,"Sender is already initialized"),n[he](t,o,s,a);var v=e.identifier;c=new ot(o.logger),r=0,i=null,e[fe]=null,u=0;var P=e[de]();O=(0,A.Hm)((0,S.Z)("Sender"),o.evtNamespace&&o.evtNamespace()),y=(0,p.G)(O),e._addHook((0,E.a)(t,(function(t){var r=t.cfg;r.storagePrefix&&(0,g.vh)(r.storagePrefix);var n=(0,T.i8)(null,r,o).getExtCfg(v,ft),i=n[pe];if(M&&i===M){var s=r[pe];s&&s!==i&&(n[pe]=s)}(0,I.$XS)(n[ge])&&(n[ge]=r[ge]),(0,I.vF1)(e,"_senderConfig",{g:function(){return n}}),x!==n[pe]&&(M=x=n[pe]),o.activeStatus()===_.f.PENDING?e.pause():o.activeStatus()===_.f.ACTIVE&&e.resume(),H&&H!==n[me]&&(0,I.Iuo)(H,(function(e){delete l[e.header]})),N=n[ve],D=(!1===n[ye]||!1===n[we])&&(0,b.Uf)(),L=!1===n[ye]&&(0,b.Uf)(),F=!1===n[we]&&(0,b.Uf)(),se=n[Ce],ae=!!n[Ie],ze=n.retryCodes;var a=n[oe],c=!!n[Ae]&&(!!a||(0,g.AN)()),u=n.namePrefix,p=c!==G||c&&Q!==u||c&&W!==a;if(e[Se]){if(p)try{e._buffer=e._buffer[re](P,n,c)}catch(t){(0,w.ZP)(e[de](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+(0,C.lL)(t),{exception:(0,I.mmD)(t)})}nt()}else e[Se]=c?new it(P,n):new rt(P,n);Q=u,G=c,W=a,ce=!n[Ee]&&(0,b.R7)(!0),Be=!!n[Te],e._sample=new ut(n.samplingPercentage,P),$=n[ge],(0,I.$XS)($)||function(e,t){var r=t.disableInstrumentationKeyValidation;return!((0,I.hXl)(r)||!r)||new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e)}($,r)||(0,w.ZP)(P,1,100,"Invalid Instrumentation key "+$),H=n[me],(0,I.KgX)(M)&&!(0,m.Qu)(M)&&H&&H[B]>0?(0,I.Iuo)(H,(function(e){d.addHeader(e.header,e.value)})):H=null,ee=n[_e];var y=function(){var t;try{var r={xdrOnComplete:function(e,t,r){var n=Ge(r);if(n)return f(e,n)},fetchOnComplete:function(e,t,r,n){var i=Ge(n);if(i)return st(e.status,i,e.url,i[B],e.statusText,r||"")},xhrOnComplete:function(e,t,r){var n=Ge(r);if(n)return Ke(e,n,n[B])},beaconOnRetry:function(t,r,n){return function(t,r,n){var i=t&&t[Ue];if(Be)je&&je(i,!0),(0,w.ZP)(e[de](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var o=[],s=0;s<i[B];s++){var a=i[s],c=[a];n(et(c),r)?e._onSuccess(c,c[B]):o[J](a)}o[B]>0&&(je&&je(o,!0),(0,w.ZP)(e[de](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}(t,r,n)}};return(t={})[_e]=ee,t.isOneDs=!1,t.disableCredentials=!1,t[Ie]=ae,t.disableBeacon=!F,t.disableBeaconSync=!L,t.senderOnCompleteCallBack=r,t}catch(e){}return null}();$e?$e.SetConfig(y):($e=new k.v)[he](y,P);var A=n.httpXHROverride,S=null,E=null,R=(0,C.jL)([3,1,2],n.transports);S=$e&&$e[be](R,!1);var O=$e&&$e.getFallbackInst();ue=function(e,t){return Ze(O,e,t)},je=function(e,t){return Ze(O,e,t,!1)},S=se?A:S||A||O,e[fe]=function(e,t){return Ze(S,e,t)},ce&&(h=pt);var U=(0,C.jL)([3,1],n[ke]);ce||(U=U.filter((function(e){return 2!==e}))),E=$e&&$e[be](U,!0),E=se?A:E||A,(se||n[ke]||!h)&&E&&(h=function(e,t){return Ze(E,e,t)}),h||(h=ue),j=n.disableTelemetry,z=n[Pe]||lt,V=n.isRetryDisabled,K=n[Re]})))},e.processTelemetry=function(t,r){var n,i=(r=e._getTelCtx(r))[de]();try{if(!We(t,i))return;var o=Xe(t,i);if(!o)return;var s=c[Oe](o),a=e[Se];nt(s);var u=((n={})[Z]=s,n.cnt=0,n);a[X](u),mt()}catch(e){(0,w.ZP)(i,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+(0,C.lL)(e),{exception:(0,I.mmD)(e)})}e.processNext(t,r)},e.isCompletelyIdle=function(){return!s&&0===Ve&&0===e._buffer[Y]()},e.getOfflineListener=function(){return y},e._xhrReadyStateChange=function(e,t,r){if(!ht(t))return Ke(e,t,r)},e[le]=function(t,r,n){var i;if(void 0===t&&(t=!0),!s)try{var o=e[Se];if(j)o[te]();else{if(o[Y]()>0){var a=o.getItems();!function(t,r){var n,i=(n="getNotifyMgr",e.core[n]?e.core[n]():e.core._notificationManager);if(i&&i[He])try{i[He](t,r)}catch(t){(0,w.ZP)(e[de](),1,74,"send request notification failed: "+(0,C.lL)(t),{exception:(0,I.mmD)(t)})}}(n||0,t),i=r?r.call(e,a,t):e[fe](a,t)}new Date}vt()}catch(t){var c=(0,b.L0)();(!c||c>9)&&(0,w.ZP)(e[de](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+(0,C.lL)(t),{exception:(0,I.mmD)(t)})}return i},e.getOfflineSupport=function(){var e;return(e={getUrl:function(){return M},createPayload:Je})[Oe]=Ye,e.batch=Qe,e.shouldProcess=function(e){return!!We(e)},e},e._doTeardown=function(t,r){e.onunloadFlush(),(0,P.K)(y,!1),wt()},e[Me]=function(t,r,n){if(!ht(t))return function(t,r,n){(0,w.ZP)(e[de](),2,26,"Failed to send telemetry.",{message:r}),e._buffer&&e._buffer[ie](t)}(t,r)},e[xe]=function(t,r){if(!ht(t))return function(t,r){for(var n=[],i=[],o=0,s=r.errors.reverse();o<s.length;o++){var a=s[o],c=t.splice(a.index,1)[0];yt(a.statusCode)?i[J](c):n[J](c)}t[B]>0&&e[Ne](t,r[Le]),n[B]>0&&e[Me](n,(0,C.r4)(null,["partial success",r[Le],"of",r.itemsReceived].join(" "))),i[B]>0&&(gt(i),(0,w.ZP)(e[de](),2,40,"Partial success. Delivered: "+t[B]+", Failed: "+n[B]+". Will retry to send "+i[B]+" our of "+r[De]+" items"))}(t,r)},e[Ne]=function(t,r){if(!ht(t))return function(t,r){e._buffer&&e._buffer[ie](t)}(t)},e._xdrOnLoad=function(e,t){if(!ht(t))return f(e,t)}})),d}return(0,i.qU)(t,e),t.constructEnvelope=function(e,t,r,n){var o;return o=t===e.iKey||(0,I.hXl)(t)?e:(0,i.Im)((0,i.Im)({},e),{iKey:t}),(pt[o.baseType]||Je)(r,o,n)},t}(O.s),mt=r(4484),vt=r(2774),yt=r(8205),wt="instrumentationKey",Ct="connectionString",It="instrumentationkey",At="endpointUrl",St="ingestionendpoint",Et="userOverrideEndpointUrl",Tt=r(9762),_t=void 0,bt=((ht={diagnosticLogInterval:(0,y.Lx)((function(e){return e&&e>0}),1e4)})[Ct]=_t,ht[At]=_t,ht[wt]=_t,ht.extensionConfig={},ht),kt=function(){function e(t){var r,i=new vt._;function s(e){e&&(e.baseData=e.baseData||{},e.baseType=e.baseType||"EventData"),i.track(e)}((0,I.hXl)(t)||(0,I.hXl)(t[wt])&&(0,I.hXl)(t[Ct]))&&(0,I.$8)("Invalid input configuration"),(0,n.A)(e,this,(function(e){function n(){var e=(0,E.e)(t||{},bt);r=e.cfg,i.addUnloadHook((0,E.a)(e,(function(){var e=r[Ct];if((0,I.$XS)(e)){var t=(0,yt.Rf)((function(t,n){(0,yt.Dv)(e,(function(e){var n=e.value,i=r[wt];!e.rejected&&n&&(r[Ct]=n,i=(0,mt.H)(n)[It]||i),t(i)}))})),n=(0,yt.Rf)((function(t,n){(0,yt.Dv)(e,(function(e){var n=e.value,i=r[At];if(!e.rejected&&n){var s=(0,mt.H)(n)[St];i=s?s+o.wc:i}t(i)}))}));r[wt]=t,r[At]=r[Et]||n}if((0,I.KgX)(e)){var i=(0,mt.H)(e),s=i[St];r[At]=r[Et]?r[Et]:s+o.wc,r[wt]=i[It]||r[wt]}r[At]=r[Et]?r[Et]:r[At]}))),i.initialize(r,[new gt])}(0,I.vF1)(e,"config",{g:function(){return r}}),n(),e.initialize=n,e.track=s,(0,C.o$)(e,i,["flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb","onCfgChange","getTraceCtx","updateCfg","addTelemetryInitializer"])}))}return e.__ieDyn=1,e}()},8279:(e,t,r)=>{"use strict";r.d(t,{A:()=>L});var n,i=r(269),o="constructor",s="prototype",a="function",c="_dynInstFuncs",u="_isDynProxy",l="_dynClass",d="_dynCls$",h="_dynInstChk",f=h,p="_dfOpts",g="_unknown_",m="__proto__",v="_dyn"+m,y="__dynProto$Gbl",w="_dynInstProto",C="useBaseInst",I="setInstFuncs",A=Object,S=A.getPrototypeOf,E=A.getOwnPropertyNames,T=(0,i.mS$)(),_=T[y]||(T[y]={o:(n={},n[I]=!0,n[C]=!0,n),n:1e3});function b(e){return e&&(e===A[s]||e===Array[s])}function k(e){return b(e)||e===Function[s]}function P(e){var t;if(e){if(S)return S(e);var r=e[m]||e[s]||(e[o]?e[o][s]:null);t=e[v]||r,(0,i.v0u)(e,v)||(delete e[w],t=e[v]=e[w]||e[v],e[w]=r)}return t}function R(e,t){var r=[];if(E)r=E(e);else for(var n in e)"string"==typeof n&&(0,i.v0u)(e,n)&&r.push(n);if(r&&r.length>0)for(var o=0;o<r.length;o++)t(r[o])}function O(e,t,r){return t!==o&&typeof e[t]===a&&(r||(0,i.v0u)(e,t))&&t!==m&&t!==s}function M(e){(0,i.zkd)("DynamicProto: "+e)}function x(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function N(e,t,r,n,o){if(!b(e)){var s=r[c]=r[c]||(0,i.sSX)(null);if(!b(s)){var d=s[t]=s[t]||(0,i.sSX)(null);!1!==s[f]&&(s[f]=!!o),b(d)||R(r,(function(t){O(r,t,!1)&&r[t]!==n[t]&&(d[t]=r[t],delete r[t],(!(0,i.v0u)(e,t)||e[t]&&!e[t][u])&&(e[t]=function(e,t){var r=function(){var n=function(e,t,r,n){var o=null;if(e&&(0,i.v0u)(r,l)){var s=e[c]||(0,i.sSX)(null);if((o=(s[r[l]]||(0,i.sSX)(null))[t])||M("Missing ["+t+"] "+a),!o[h]&&!1!==s[f]){for(var u=!(0,i.v0u)(e,t),d=P(e),p=[];u&&d&&!k(d)&&!x(p,d);){var g=d[t];if(g){u=g===n;break}p.push(d),d=P(d)}try{u&&(e[t]=o),o[h]=1}catch(e){s[f]=!1}}}return o}(this,t,e,r)||function(e,t,r){var n=t[e];return n===r&&(n=P(t)[e]),typeof n!==a&&M("["+e+"] is not a "+a),n}(t,e,r);return n.apply(this,arguments)};return r[u]=1,r}(e,t)))}))}}}function D(e,t){return(0,i.v0u)(e,s)?e.name||t||g:((e||{})[o]||{}).name||t||g}function L(e,t,r,n){(0,i.v0u)(e,s)||M("theClass is an invalid class definition.");var o=e[s];(function(e,t){if(S){for(var r=[],n=P(t);n&&!k(n)&&!x(r,n);){if(n===e)return!0;r.push(n),n=P(n)}return!1}return!0})(o,t)||M("["+D(e)+"] not in hierarchy of ["+D(t)+"]");var a=null;(0,i.v0u)(o,l)?a=o[l]:(a=d+D(e,"_")+"$"+_.n,_.n++,o[l]=a);var h=L[p],g=!!h[C];g&&n&&void 0!==n[C]&&(g=!!n[C]);var m=function(e){var t=(0,i.sSX)(null);return R(e,(function(r){!t[r]&&O(e,r,!1)&&(t[r]=e[r])})),t}(t),v=function(e,t,r,n){function o(e,t,r){var i=t[r];if(i[u]&&n){var o=e[c]||{};!1!==o[f]&&(i=(o[t[l]]||{})[r]||i)}return function(){return i.apply(e,arguments)}}var s=(0,i.sSX)(null);R(r,(function(e){s[e]=o(t,r,e)}));for(var a=P(e),d=[];a&&!k(a)&&!x(d,a);)R(a,(function(e){!s[e]&&O(a,e,!S)&&(s[e]=o(t,a,e))})),d.push(a),a=P(a);return s}(o,t,m,g);r(t,v);var y=!!S&&!!h[I];y&&n&&(y=!!n[I]),N(o,a,t,m,!1!==y)}L[p]=_.o},8205:(e,t,r)=>{"use strict";r.d(t,{Dv:()=>u,Qo:()=>x,Rf:()=>O,Xf:()=>N,lh:()=>M});var n,i,o,s=r(269),a="Promise",c="rejected";function u(e,t){return l(e,(function(e){return t?t({status:"fulfilled",rejected:!1,value:e}):e}),(function(e){return t?t({status:c,rejected:!0,reason:e}):e}))}function l(e,t,r,n){var i=e;try{if((0,s.$XS)(e))(t||r)&&(i=e.then(t,r));else try{t&&(i=t(e))}catch(e){if(!r)throw e;i=r(e)}}finally{n&&function(e,t){var r=e;t&&((0,s.$XS)(e)?r=e.finally?e.finally(t):e.then((function(e){return t(),e}),(function(e){throw t(),e})):t())}(i,n)}return i}var d,h=!1,f=["pending","resolving","resolved",c],p="dispatchEvent";function g(e){var t;return e&&e.createEvent&&(t=e.createEvent("Event")),!!t&&t.initEvent}var m,v,y,w,C="unhandledRejection",I=C.toLowerCase(),A=[],S=0,E=10;function T(e){return(0,s.Tnt)(e)?e.toString():(0,s.mmD)(e)}function _(e,t,r){var c,u,l=(0,s.KVm)(arguments,3),v=0,y=!1,w=[],_=S++,b=A.length>0?A[A.length-1]:void 0,k=!1,P=null;function R(t,r){try{return A.push(_),k=!0,P&&P.cancel(),P=null,e((function(e,n){w.push((function(){try{var i=2===v?t:r,o=(0,s.b07)(i)?c:(0,s.Tnt)(i)?i(c):i;(0,s.$XS)(o)?o.then(e,n):i?e(o):3===v?n(o):e(o)}catch(e){n(e)}})),y&&M()}),l)}finally{A.pop()}}function O(){return f[v]}function M(){if(w.length>0){var e=w.slice();w=[],k=!0,P&&P.cancel(),P=null,t(e)}}function x(e,t){return function(r){if(v===t){if(2===e&&(0,s.$XS)(r))return v=1,void r.then(x(2,1),x(3,1));v=e,y=!0,c=r,M(),k||3!==e||P||(P=(0,s.dRz)(N,E))}}}function N(){if(!k)if(k=!0,(0,s.Lln)())process.emit(C,c,u);else{var e=(0,s.zkX)()||(0,s.mS$)();!m&&(m=(0,s.GuU)((0,s.gBW)(s.zS2,[a+"RejectionEvent"]).v)),function(e,t,r,n){var i=(0,s.YEm)();!d&&(d=(0,s.GuU)(!!(0,s.gBW)(g,[i]).v));var o=d.v?i.createEvent("Event"):n?new Event(t):{};if(r&&r(o),d.v&&o.initEvent(t,!1,!0),o&&e[p])e[p](o);else{var a=e["on"+t];if(a)a(o);else{var c=(0,s.zS2)("console");c&&(c.error||c.log)(t,(0,s.mmD)(o))}}}(e,I,(function(e){return(0,s.vF1)(e,"promise",{g:function(){return u}}),e.reason=c,e}),!!m.v)}}return u={then:R,catch:function(e){return R(void 0,e)},finally:function(e){var t=e,r=e;return(0,s.Tnt)(e)&&(t=function(t){return e&&e(),t},r=function(t){throw e&&e(),t}),R(t,r)}},(0,s.UxO)(u,"state",{get:O}),h&&function(e,t,r,a){i=i||{toString:function(){return"[[PromiseResult]]"}},o=o||{toString:function(){return"[[PromiseIsHandled]]"}};var u={};u[n=n||{toString:function(){return"[[PromiseState]]"}}]={get:t},u[i]={get:function(){return(0,s.SZ2)(c)}},u[o]={get:function(){return k}},(0,s.isD)(e,u)}(u,O),(0,s.Lok)()&&(u[(0,s.Y0g)(11)]="IPromise"),u.toString=function(){return"IPromise"+(h?"["+_+((0,s.b07)(b)?"":":"+b)+"]":"")+" "+O()+(y?" - "+T(c):"")},function(){(0,s.Tnt)(r)||(0,s.zkd)(a+": executor is not a function - "+T(r));var e=x(3,0);try{r.call(u,x(2,0),e)}catch(t){e(t)}}(),u}function b(e){return function(t){var r=(0,s.KVm)(arguments,1);return e((function(e,r){try{var n=[],i=1;(0,s.DA8)(t,(function(t,o){t&&(i++,l(t,(function(t){n[o]=t,0==--i&&e(n)}),r))})),0==--i&&e(n)}catch(e){r(e)}}),r)}}function k(e){(0,s.Iuo)(e,(function(e){try{e()}catch(e){}}))}function P(e,t){return _(P,function(e){var t=(0,s.EtT)(e)?e:0;return function(e){(0,s.dRz)((function(){k(e)}),t)}}(t),e,t)}function R(e,t){!v&&(v=(0,s.GuU)((0,s.gBW)(s.zS2,[a]).v||null));var r=v.v;if(!r)return P(e);(0,s.Tnt)(e)||(0,s.zkd)(a+": executor is not a function - "+(0,s.mmD)(e));var n=0,i=new r((function(t,r){e((function(e){n=2,t(e)}),(function(e){n=3,r(e)}))}));return(0,s.UxO)(i,"state",{get:function(){return f[n]}}),i}function O(e){return _(O,k,e)}function M(e,t){return!y&&(r=O,y=(0,s.GuU)((function(e){var t=(0,s.KVm)(arguments,1);return r((function(t,r){var n=[],i=1;function o(e,r){i++,u(e,(function(e){e.rejected?n[r]={status:c,reason:e.reason}:n[r]={status:"fulfilled",value:e.value},0==--i&&t(n)}))}try{(0,s.cyL)(e)?(0,s.Iuo)(e,o):(0,s.xZI)(e)?(0,s.DA8)(e,o):(0,s.zkd)("Input is not an iterable"),0==--i&&t(n)}catch(e){r(e)}}),t)}))),y.v(e,t);var r}function x(e,t){return!w&&(w=(0,s.GuU)(R)),w.v.call(this,e,t)}var N=b(x);(0,s.Y0g)(11)},269:(e,t,r)=>{"use strict";function n(e,t){return e||t}function i(e,t){return e[t]}r.d(t,{$8:()=>le,$PY:()=>j,$XS:()=>V,AHH:()=>dr,Cv9:()=>Zt,DA8:()=>wt,EHq:()=>jt,Edw:()=>x,EtT:()=>B,FJj:()=>Qt,GuU:()=>Ke,Gvm:()=>q,HzD:()=>tr,Iuo:()=>At,JKf:()=>ct,KTd:()=>Pt,KVm:()=>Tt,KgX:()=>U,KhI:()=>Y,Lln:()=>ut,Lmq:()=>$,Lok:()=>ht,N6t:()=>ye,Nq2:()=>kt,O9V:()=>L,P0f:()=>Ne,QdQ:()=>Bt,R3R:()=>Yt,SZ2:()=>M,Tnt:()=>F,UUD:()=>Jt,UxO:()=>te,Vdv:()=>et,W$7:()=>Et,WSA:()=>Ie,Wtk:()=>Je,Y0g:()=>pt,YEm:()=>Ze,Yny:()=>It,ZHX:()=>ve,ZWZ:()=>Ue,aqQ:()=>Nt,b07:()=>N,bJ7:()=>z,cGk:()=>me,cyL:()=>H,dRz:()=>ur,eCG:()=>mt,f0d:()=>Dt,fn0:()=>Se,gBW:()=>P,hKY:()=>De,hXl:()=>D,isD:()=>re,jjc:()=>gt,jsL:()=>we,kgX:()=>W,mS$:()=>Ye,mmD:()=>ue,nRs:()=>Ve,oJg:()=>ae,rDm:()=>St,raO:()=>ne,sSX:()=>Rt,tGl:()=>rr,twz:()=>it,v0u:()=>X,vE3:()=>ge,vF1:()=>ie,vKV:()=>lr,w3n:()=>nt,w9M:()=>rt,woc:()=>K,xZI:()=>yt,zS2:()=>Qe,zav:()=>J,zkX:()=>tt,zkd:()=>de,zwS:()=>Wt,zzB:()=>G});var o,s=void 0,a=null,c="",u="function",l="object",d="prototype",h="__proto__",f="undefined",p="constructor",g="Symbol",m="_polyfill",v="length",y="name",w="call",C="toString",I=n(Object),A=i(I,d),S=n(String),E=i(S,d),T=n(Math),_=n(Array),b=i(_,d),k=i(b,"slice");function P(e,t){try{return{v:e.apply(this,t)}}catch(e){return{e}}}function R(e){return function(t){return typeof t===e}}function O(e){var t="[object "+e+"]";return function(e){return!(!e||M(e)!==t)}}function M(e){return A[C].call(e)}function x(e,t){return typeof e===t}function N(e){return typeof e===f||e===f}function D(e){return e===a||N(e)}function L(e){return!!e||e!==s}var U=R("string"),F=R(u);function q(e){return!(!e&&D(e)||!e||typeof e!==l)}var H=i(_,"isArray"),j=O("Date"),B=R("number"),$=R("boolean"),z=O("Error");function V(e){return!!(e&&e.then&&F(e.then))}function K(e){return!e||!G(e)}function G(e){return!(!e||(t=function(){return!(e&&0+e)},r=!e,n=P(t),n.e?r:n.v));var t,r,n}var W=i(I,"getOwnPropertyDescriptor");function X(e,t){return!!e&&A.hasOwnProperty[w](e,t)}var Y=n(i(I,"hasOwn"),Q);function Q(e,t){return X(e,t)||!!W(e,t)}function J(e,t,r){if(e&&q(e))for(var n in e)if(Y(e,n)&&-1===t[w](r||e,n,e[n]))break}var Z={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function ee(e){var t={};if(t[Z.c]=!0,t[Z.e]=!0,e.l){t.get=function(){return e.l.v};var r=W(e.l,"v");r&&r.set&&(t.set=function(t){e.l.v=t})}return J(e,(function(e,r){t[Z[e]]=L(r)?r:t[Z[e]]})),t}var te=i(I,"defineProperty"),re=i(I,"defineProperties");function ne(e,t,r,n,i,o){var s={e:o,c:i};return r&&(s.g=r),n&&(s.s=n),te(e,t,ee(s))}function ie(e,t,r){return te(e,t,ee(r))}function oe(e,t,r,n,i){var o={};return J(e,(function(e,n){se(o,e,t?n:e,i),se(o,n,r?n:e,i)})),n?n(o):o}function se(e,t,r,n){te(e,t,{value:r,enumerable:!0,writable:!!n})}var ae=n(S),ce="[object Error]";function ue(e,t){var r=c,n=A[C][w](e);n===ce&&(e={stack:ae(e.stack),message:ae(e.message),name:ae(e.name)});try{r=((r=JSON.stringify(e,a,t?"number"==typeof t?t:4:s))?r.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):a)||ae(e)}catch(e){r=" - "+ue(e,t)}return n+": "+r}function le(e){throw new Error(e)}function de(e){throw new TypeError(e)}var he=i(I,"freeze");function fe(e){return e}function pe(e){return e[h]||a}var ge=i(I,"assign"),me=i(I,"keys");function ve(e){return he&&J(e,(function(e,t){(H(t)||q(t))&&ve(t)})),ye(e)}var ye=n(he,fe),we=n(i(I,"seal"),fe),Ce=n(i(I,"getPrototypeOf"),pe);function Ie(e){return oe(e,1,0,ye)}function Ae(e){return oe(e,0,0,ye)}function Se(e){return function(e){var t={};return J(e,(function(e,r){se(t,e,r[1]),se(t,r[0],r[1])})),ye(t)}(e)}var Ee,Te=Ae({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),_e="__tsUtils$gblCfg";function be(){var e;return typeof globalThis!==f&&(e=globalThis),e||typeof self===f||(e=self),e||typeof window===f||(e=window),e||typeof global===f||(e=global),e}function ke(){if(!Ee){var e=P(be).v||{};Ee=e[_e]=e[_e]||{}}return Ee}var Pe=Re;function Re(e,t,r){var n=t?t[e]:a;return function(t){var i=(t?t[e]:a)||n;if(i||r){var o=arguments;return(i||r).apply(t,i?k[w](o,1):o)}de('"'+ae(e)+'" not defined for '+ue(t))}}function Oe(e){return function(t){return t[e]}}var Me=i(T,"max"),xe=Pe("slice",E),Ne=Pe("substring",E),De=Re("substr",E,Le);function Le(e,t,r){return D(e)&&de("Invalid "+ue(e)),r<0?c:((t=t||0)<0&&(t=Me(t+e[v],0)),N(r)?xe(e,t):xe(e,t,t+r))}function Ue(e,t){return Ne(e,0,t)}var Fe,qe,He,je="_urid";function Be(e){var t={description:ae(e),toString:function(){return g+"("+e+")"}};return t[m]=!0,t}function $e(e){var t=function(){if(!Fe){var e=ke();Fe=e.gblSym=e.gblSym||{k:{},s:{}}}return Fe}();if(!Y(t.k,e)){var r=Be(e),n=me(t.s).length;r[je]=function(){return n+"_"+r[C]()},t.k[e]=r,t.s[r[je]()]=ae(e)}return t.k[e]}function ze(){He=ke()}function Ve(e){var t={};return!He&&ze(),t.b=He.lzy,te(t,"v",{configurable:!0,get:function(){var r=e();return He.lzy||te(t,"v",{value:r}),t.b=He.lzy,r}}),t}function Ke(e){return te({toJSON:function(){return e}},"v",{value:e})}var Ge,We="window";function Xe(e,t){var r;return function(){return!He&&ze(),r&&!He.lzy||(r=Ke(P(e,t).v)),r.v}}function Ye(e){return!He&&ze(),Ge&&!1!==e&&!He.lzy||(Ge=Ke(P(be).v||a)),Ge.v}function Qe(e,t){var r;if((r=Ge&&!1!==t?Ge.v:Ye(t))&&r[e])return r[e];if(e===We)try{return window}catch(e){}return a}function Je(){return!!Ze()}var Ze=Xe(Qe,["document"]);function et(){return!!tt()}var tt=Xe(Qe,[We]);function rt(){return!!nt()}var nt=Xe(Qe,["navigator"]);function it(){return!!ct()}var ot,st,at,ct=Xe(Qe,["history"]),ut=Xe((function(){return!!P((function(){return process&&(process.versions||{}).node})).v}));function lt(){return ot=Ke(P(Qe,[g]).v)}function dt(e){var t=(He.lzy?0:ot)||lt();return t.v?t.v[e]:s}function ht(){return!!ft()}function ft(){return!He&&ze(),((He.lzy?0:ot)||lt()).v}function pt(e,t){var r=Te[e];!He&&ze();var n=(He.lzy?0:ot)||lt();return n.v?n.v[r||e]:t?s:function(e){var t;!qe&&(qe={});var r=Te[e];return r&&(t=qe[r]=qe[r]||Be(g+"."+r)),t}(e)}function gt(e,t){!He&&ze();var r=(He.lzy?0:ot)||lt();return r.v?r.v(e):t?a:Be(e)}function mt(e){return!He&&ze(),((st=(He.lzy?0:st)||Ke(P(dt,["for"]).v)).v||$e)(e)}function vt(e){return!!e&&F(e.next)}function yt(e){return!function(e){return e===a||!L(e)}(e)&&F(e[pt(3)])}function wt(e,t,r){if(e&&(vt(e)||(!at&&(at=Ke(pt(3))),e=e[at.v]?e[at.v]():a),vt(e))){var n=s,i=s;try{for(var o=0;!(i=e.next()).done&&-1!==t[w](r||e,i.value,o,e);)o++}catch(t){n={e:t},e.throw&&(i=a,e.throw(n))}finally{try{i&&!i.done&&e.return&&e.return(i)}finally{if(n)throw n.e}}}}function Ct(e,t,r){return e.apply(t,r)}function It(e,t){return!N(t)&&e&&(H(t)?Ct(e.push,e,t):vt(t)||yt(t)?wt(t,(function(t){e.push(t)})):e.push(t)),e}function At(e,t,r){if(e)for(var n=e[v]>>>0,i=0;i<n&&(!(i in e)||-1!==t[w](r||e,e[i],i,e));i++);}var St=Pe("indexOf",b),Et=Pe("map",b);function Tt(e,t,r){return((e?e.slice:a)||k).apply(e,k[w](arguments,1))}function _t(e,t,r){return-1!==St(e,t,r)}var bt,kt=Re("includes",b,_t),Pt=Pe("reduce",b),Rt=n(i(I,"create"),Ot);function Ot(e){if(!e)return{};var t=typeof e;function r(){}return t!==l&&t!==u&&de("Prototype must be an Object or function: "+ue(e)),r[d]=e,new r}function Mt(e,t){return(I.setPrototypeOf||function(e,t){var r;!bt&&(bt=Ke(((r={})[h]=[],r instanceof Array))),bt.v?e[h]=t:J(t,(function(t,r){return e[t]=r}))})(e,t)}function xt(e,t){t&&(e[y]=t)}function Nt(e,t,r){var n=r||Error,i=n[d][y],o=Error.captureStackTrace;return function(e,t,r){function n(){this[p]=t,P(ie,[this,y,{v:e,c:!0,e:!1}])}return P(ie,[t,y,{v:e,c:!0,e:!1}]),(t=Mt(t,r))[d]=r===a?Rt(r):(n[d]=r[d],new n),t}(e,(function(){var r=this,s=arguments;try{P(xt,[n,e]);var a=Ct(n,r,k[w](s))||r;if(a!==r){var c=Ce(r);c!==Ce(a)&&Mt(a,c)}return o&&o(a,r[p]),t&&t(a,s),a}finally{P(xt,[n,i])}}),n)}function Dt(){return(Date.now||Lt)()}function Lt(){return(new Date).getTime()}function Ut(e){return function(t){return D(t)&&de("strTrim called ["+ue(t)+"]"),t&&t.replace&&(t=t.replace(e,c)),t}}var Ft,qt,Ht,jt=Re("trim",E,Ut(/^\s+|(?=\s)\s+$/g));function Bt(e){if(!e||typeof e!==l)return!1;Ht||(Ht=!et()||tt());var t=!1;if(e!==Ht){qt||(Ft=Function[d][C],qt=Ft[w](I));try{var r=Ce(e);(t=!r)||(X(r,p)&&(r=r[p]),t=!(!r||typeof r!==u||Ft[w](r)!==qt))}catch(e){}}return t}function $t(e){return e.value&&Gt(e),!0}var zt=[function(e){var t=e.value;if(H(t)){var r=e.result=[];return r.length=t.length,e.copyTo(r,t),!0}return!1},Gt,function(e){return e.type===u},function(e){var t=e.value;return!!j(t)&&(e.result=new Date(t.getTime()),!0)}];function Vt(e,t,r,n){var i=r.handler,s=r.path?n?r.path.concat(n):r.path:[],c={handler:r.handler,src:r.src,path:s},u=typeof t,d=!1,h=t===a;h||(t&&u===l?d=Bt(t):h=function(e){return!o&&(o=["string","number","boolean",f,"symbol","bigint"]),!(e===l||-1===o.indexOf(e))}(u));var p={type:u,isPrim:h,isPlain:d,value:t,result:t,path:s,origin:r.src,copy:function(t,n){return Vt(e,t,n?c:r,n)},copyTo:function(t,r){return Kt(e,t,r,c)}};return p.isPrim?i&&i[w](r,p)?p.result:t:function(e,t,n,o){var s;return At(e,(function(e){if(e.k===t)return s=e,-1})),s||(s={k:t,v:t},e.push(s),function(e){ie(p,"result",{g:function(){return e.v},s:function(t){e.v=t}});for(var t=0,n=i;!(n||(t<zt.length?zt[t++]:$t))[w](r,p);)n=a}(s)),s.v}(e,t)}function Kt(e,t,r,n){if(!D(r))for(var i in r)t[i]=Vt(e,r[i],n,i);return t}function Gt(e){var t=e.value;if(t&&e.isPlain){var r=e.result={};return e.copyTo(r,t),!0}return!1}function Wt(e,t,r,n,i,o,s){return function(e,t){return At(t,(function(t){!function(e,t,r){Kt([],e,t,{handler:void 0,src:t,path:[]})}(e,t)})),e}(Vt([],a=e,{handler:undefined,src:a})||{},k[w](arguments));var a}var Xt,Yt=Oe(v);function Qt(){return!He&&ze(),Xt&&!He.lzy||(Xt=Ke(P(Qe,["performance"]).v)),Xt.v}function Jt(){var e=Qt();return e&&e.now?e.now():Dt()}ht();var Zt=Re("endsWith",E,er);function er(e,t,r){U(e)||de("'"+ue(e)+"' is not a string");var n=U(t)?t:ae(t),i=!N(r)&&r<e[v]?r:e[v];return Ne(e,i-n[v],i)===n}var tr=Pe("indexOf",E),rr=Re("startsWith",E,nr);function nr(e,t,r){U(e)||de("'"+ue(e)+"' is not a string");var n=U(t)?t:ae(t),i=r>0?r:0;return Ne(e,i,i+n[v])===n}var ir="ref",or="unref",sr="hasRef",ar="enabled";function cr(e,t,r){var n=H(t),i=n?t.length:0,o=(i>0?t[0]:n?s:t)||setTimeout,c=(i>1?t[1]:s)||clearTimeout,u=r[0];r[0]=function(){l.dn(),Ct(u,s,k[w](arguments))};var l=function(e,t,r){var n,i=!0,o=e?t(a):a;function s(){return i=!1,o&&o[or]&&o[or](),n}function c(){o&&r(o),o=a}function u(){return o=t(o),i||s(),n}return(n={cancel:c,refresh:u})[sr]=function(){return o&&o[sr]?o[sr]():i},n[ir]=function(){return i=!0,o&&o[ir]&&o[ir](),n},n[or]=s,{h:n=te(n,ar,{get:function(){return!!o},set:function(e){!e&&o&&c(),e&&!o&&u()}}),dn:function(){o=a}}}(e,(function(e){if(e){if(e.refresh)return e.refresh(),e;Ct(c,s,[e])}return Ct(o,s,r)}),(function(e){Ct(c,s,[e])}));return l.h}function ur(e,t){return cr(!0,s,k[w](arguments))}function lr(e,t,r){return cr(!0,e,k[w](arguments,1))}function dr(e,t){return cr(!1,s,k[w](arguments))}},5396:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.oneDataSystemClientFactory=void 0,t.oneDataSystemClientFactory=async(e,t,n)=>{let i=await(async(e,t,n)=>{const i=await Promise.resolve().then((()=>o(r(956)))),s=await Promise.resolve().then((()=>o(r(8916)))),a=new i.AppInsightsCore,c=new s.PostChannel,u={instrumentationKey:e,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[c]]};if(n){u.extensionConfig={};const e={alwaysUseXhrOverride:!0,httpXHROverride:n};u.extensionConfig[c.identifier]=e}const l=t.workspace.getConfiguration("telemetry").get("internalTesting");return a.initialize(u,[]),a.addTelemetryInitializer((e=>{e.ext=e.ext??{},e.ext.web=e.ext.web??{},e.ext.web.consentDetails='{"GPC_DataSharingOptIn":false}',l&&(e.ext.utc=e.ext.utc??{},e.ext.utc.flags=8462029)})),a})(e,t,n);return{logEvent:(e,t)=>{try{i?.track({name:e,baseData:{name:e,properties:t?.properties,measurements:t?.measurements}})}catch(e){throw new Error("Failed to log event to app insights!\n"+e.message)}},flush:async()=>{try{return new Promise(((e,t)=>{i?i.flush(!0,(e=>{e||t("Failed to flush app 1DS!")})):e()}))}catch(e){throw new Error("Failed to flush 1DS!\n"+e.message)}},dispose:async()=>new Promise((e=>{i?i.unload(!1,(()=>{e(),i=void 0}),1e3):e()}))}}},2468:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.appInsightsClientFactory=void 0;const s=r(740),a=r(8393);t.appInsightsClientFactory=async(e,t,n,i,c)=>{let u;try{const t=await Promise.resolve().then((()=>o(r(5927)))),n={};if(i){const e={alwaysUseXhrOverride:!0,httpXHROverride:i};n[s.BreezeChannelIdentifier]=e}let a;e.startsWith("InstrumentationKey=")||(a=e);const c=a?{instrumentationKey:a}:{connectionString:e};u=new t.ApplicationInsights({...c,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0,extensionConfig:n})}catch(e){return Promise.reject(e)}return{logEvent:(e,r)=>{const i={...r?.properties,...r?.measurements};c?.length&&a.TelemetryUtil.applyReplacements(i,c),u?.track({name:e,data:i,baseType:"EventData",ext:{user:{id:t,authId:t},app:{sesId:n}},baseData:{name:e,properties:r?.properties,measurements:r?.measurements}})},flush:async()=>{u?.flush(!1)},dispose:async()=>new Promise((e=>{u?.unload(!0,(()=>{e(),u=void 0}),1e3)}))}}},6548:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTelemetryReporter=void 0,t.BaseTelemetryReporter=class{constructor(e,t,r){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,r),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates((()=>{this.updateUserOptIn()}))}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,r,n){n?this.telemetrySender.sendEventData(e,{properties:t,measurements:r}):this.telemetryLogger.logUsage(e,{properties:t,measurements:r})}sendTelemetryEvent(e,t,r){this.internalSendTelemetryEvent(e,t,r,!1)}sendRawTelemetryEvent(e,t,r){const n={...t};for(const e of Object.keys(n??{})){const t=n[e];"string"==typeof e&&void 0!==t&&(n[e]=new this.vscodeAPI.TelemetryTrustedValue("string"==typeof t?t:t.value))}this.sendTelemetryEvent(e,n,r)}sendDangerousTelemetryEvent(e,t,r){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,r,!0)}internalSendTelemetryErrorEvent(e,t,r,n){n?this.telemetrySender.sendEventData(e,{properties:t,measurements:r}):this.telemetryLogger.logError(e,{properties:t,measurements:r})}sendTelemetryErrorEvent(e,t,r){this.internalSendTelemetryErrorEvent(e,t,r,!1)}sendDangerousTelemetryErrorEvent(e,t,r){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,r,!0)}async dispose(){return await this.telemetrySender.dispose(),this.telemetryLogger.dispose(),Promise.all(this.disposables.map((e=>e.dispose())))}}},2396:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTelemetrySender=void 0,function(e){e[e.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",e[e.INSTANTIATING=1]="INSTANTIATING",e[e.INSTANTIATED=2]="INSTANTIATED"}(r||(r={})),t.BaseTelemetrySender=class{constructor(e,t){this._instantiationStatus=r.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){this._telemetryClient?this._telemetryClient.logEvent(e,t):this._instantiationStatus!==r.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t})}sendErrorData(e,t){if(!this._telemetryClient)return void(this._instantiationStatus!==r.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t}));const n={stack:e.stack,message:e.message,name:e.name};if(t){const e=t.properties||t;t.properties={...e,...n}}else t={properties:n};this._telemetryClient.logEvent("unhandlederror",t)}async flush(){return this._telemetryClient?.flush()}async dispose(){this._telemetryClient&&(await this._telemetryClient.dispose(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach((({eventName:e,data:t})=>this.sendEventData(e,t))),this._eventQueue=[],this._exceptionQueue.forEach((({exception:e,data:t})=>this.sendErrorData(e,t))),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===r.NOT_INSTANTIATED&&(this._instantiationStatus=r.INSTANTIATING,this._clientFactory(this._key).then((e=>{this._telemetryClient=e,this._instantiationStatus=r.INSTANTIATED,this._flushQueues()})).catch((e=>{console.error(e),this._instantiationStatus=r.INSTANTIATED})))}}},8393:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryUtil=void 0;class r{static applyReplacements(e,t){for(const r of Object.keys(e))for(const n of t)n.lookup.test(r)&&(void 0!==n.replacementString?e[r]=n.replacementString:delete e[r])}static shouldUseOneDataSystemSDK(e){return 74===e.length&&"-"===e[32]&&"-"===e[41]&&"-"===e[46]&&"-"===e[51]&&"-"===e[56]&&"-"===e[69]}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.9.8"}}static getInstance(){return r._instance||(r._instance=new r),r._instance}}t.TelemetryUtil=r},1170:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=o(r(5692)),a=o(r(857)),c=o(r(1398)),u=r(5396),l=r(2468),d=r(6548),h=r(2396),f=r(8393);function p(){return{sendPOST:(e,t)=>{const r={method:"POST",headers:{...e.headers,"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)}};try{const n=s.request(e.urlString,r,(e=>{e.on("data",(function(r){t(e.statusCode??200,e.headers,r.toString())})),e.on("error",(function(){t(0,{})}))}));n.write(e.data,(e=>{e&&t(0,{})})),n.end()}catch{t(0,{})}}}}class g extends d.BaseTelemetryReporter{constructor(e,t){let r=e=>(0,l.appInsightsClientFactory)(e,c.env.machineId,c.env.sessionId,p(),t);f.TelemetryUtil.shouldUseOneDataSystemSDK(e)&&(r=e=>(0,u.oneDataSystemClientFactory)(e,c,p()));const n={release:a.release(),platform:a.platform(),architecture:a.arch()},i=new h.BaseTelemetrySender(e,r);if(e&&0===e.indexOf("AIF-"))throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(i,c,{additionalCommonProperties:f.TelemetryUtil.getAdditionalCommonProperties(n)})}}t.default=g},1045:(e,t,r)=>{"use strict";var n=r(181).Buffer,i=r(181).SlowBuffer;function o(e,t){if(!n.isBuffer(e)||!n.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}e.exports=o,o.install=function(){n.prototype.equal=i.prototype.equal=function(e){return o(this,e)}};var s=n.prototype.equal,a=i.prototype.equal;o.restore=function(){n.prototype.equal=s,i.prototype.equal=a}},2010:(e,t,r)=>{"use strict";var n=r(2861).Buffer,i=r(3527),o=128;function s(e){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function a(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=o&&--n,n}e.exports={derToJose:function(e,t){e=s(e);var r=i(t),o=r+1,a=e.length,c=0;if(48!==e[c++])throw new Error('Could not find expected "seq"');var u=e[c++];if(129===u&&(u=e[c++]),a-c<u)throw new Error('"seq" specified length of "'+u+'", only "'+(a-c)+'" remaining');if(2!==e[c++])throw new Error('Could not find expected "int" for "r"');var l=e[c++];if(a-c-2<l)throw new Error('"r" specified length of "'+l+'", only "'+(a-c-2)+'" available');if(o<l)throw new Error('"r" specified length of "'+l+'", max of "'+o+'" is acceptable');var d=c;if(c+=l,2!==e[c++])throw new Error('Could not find expected "int" for "s"');var h=e[c++];if(a-c!==h)throw new Error('"s" specified length of "'+h+'", expected "'+(a-c)+'"');if(o<h)throw new Error('"s" specified length of "'+h+'", max of "'+o+'" is acceptable');var f=c;if((c+=h)!==a)throw new Error('Expected to consume entire buffer, but "'+(a-c)+'" bytes remain');var p=r-l,g=r-h,m=n.allocUnsafe(p+l+g+h);for(c=0;c<p;++c)m[c]=0;e.copy(m,c,d+Math.max(-p,0),d+l);for(var v=c=r;c<v+g;++c)m[c]=0;return e.copy(m,c,f+Math.max(-g,0),f+h),(m=m.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=s(e);var r=i(t),c=e.length;if(c!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+c+'"');var u=a(e,0,r),l=a(e,r,e.length),d=r-u,h=r-l,f=2+d+1+1+h,p=f<o,g=n.allocUnsafe((p?2:3)+f),m=0;return g[m++]=48,p?g[m++]=f:(g[m++]=129,g[m++]=255&f),g[m++]=2,g[m++]=d,u<0?(g[m++]=0,m+=e.copy(g,m,0,r)):m+=e.copy(g,m,u,r),g[m++]=2,g[m++]=h,l<0?(g[m++]=0,e.copy(g,m,r)):e.copy(g,m,r+l),g}}},3527:e=>{"use strict";function t(e){return(e/8|0)+(e%8==0?0:1)}var r={ES256:t(256),ES384:t(384),ES512:t(521)};e.exports=function(e){var t=r[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')}},7260:(e,t,r)=>{var n=r(5747);e.exports=function(e,t){t=t||{};var r=n.decode(e,t);if(!r)return null;var i=r.payload;if("string"==typeof i)try{var o=JSON.parse(i);null!==o&&"object"==typeof o&&(i=o)}catch(e){}return!0===t.complete?{header:r.header,payload:i,signature:r.signature}:i}},4040:(e,t,r)=>{e.exports={decode:r(7260),verify:r(1691),sign:r(7651),JsonWebTokenError:r(1741),NotBeforeError:r(3726),TokenExpiredError:r(8980)}},1741:e=>{var t=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(t.prototype=Object.create(Error.prototype)).constructor=t,e.exports=t},3726:(e,t,r)=>{var n=r(1741),i=function(e,t){n.call(this,e),this.name="NotBeforeError",this.date=t};(i.prototype=Object.create(n.prototype)).constructor=i,e.exports=i},8980:(e,t,r)=>{var n=r(1741),i=function(e,t){n.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};(i.prototype=Object.create(n.prototype)).constructor=i,e.exports=i},1977:(e,t,r)=>{const n=r(9589);e.exports=n.satisfies(process.version,">=15.7.0")},4977:(e,t,r)=>{var n=r(9589);e.exports=n.satisfies(process.version,"^6.12.0 || >=8.0.0")},4623:(e,t,r)=>{const n=r(9589);e.exports=n.satisfies(process.version,">=16.9.0")},855:(e,t,r)=>{var n=r(6585);e.exports=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var i=n(e);if(void 0===i)return;return Math.floor(r+i/1e3)}return"number"==typeof e?r+e:void 0}},7019:(e,t,r)=>{const n=r(1977),i=r(4623),o={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},s={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};e.exports=function(e,t){if(!e||!t)return;const r=t.asymmetricKeyType;if(!r)return;const a=o[r];if(!a)throw new Error(`Unknown key type "${r}".`);if(!a.includes(e))throw new Error(`"alg" parameter for "${r}" key type must be one of: ${a.join(", ")}.`);if(n)switch(r){case"ec":const r=t.asymmetricKeyDetails.namedCurve,n=s[e];if(r!==n)throw new Error(`"alg" parameter "${e}" requires curve "${n}".`);break;case"rsa-pss":if(i){const r=parseInt(e.slice(-3),10),{hashAlgorithm:n,mgf1HashAlgorithm:i,saltLength:o}=t.asymmetricKeyDetails;if(n!==`sha${r}`||i!==n)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(void 0!==o&&o>r>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}}}},7651:(e,t,r)=>{const n=r(855),i=r(4977),o=r(7019),s=r(5747),a=r(6111),c=r(7914),u=r(8928),l=r(3639),d=r(9001),h=r(5931),f=r(7083),{KeyObject:p,createSecretKey:g,createPrivateKey:m}=r(6982),v=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];i&&v.splice(3,0,"PS256","PS384","PS512");const y={expiresIn:{isValid:function(e){return u(e)||h(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return u(e)||h(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return h(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:a.bind(null,v),message:'"algorithm" must be a valid string enum value'},header:{isValid:d,message:'"header" must be an object'},encoding:{isValid:h,message:'"encoding" must be a string'},issuer:{isValid:h,message:'"issuer" must be a string'},subject:{isValid:h,message:'"subject" must be a string'},jwtid:{isValid:h,message:'"jwtid" must be a string'},noTimestamp:{isValid:c,message:'"noTimestamp" must be a boolean'},keyid:{isValid:h,message:'"keyid" must be a string'},mutatePayload:{isValid:c,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:c,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:c,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},w={iat:{isValid:l,message:'"iat" should be a number of seconds'},exp:{isValid:l,message:'"exp" should be a number of seconds'},nbf:{isValid:l,message:'"nbf" should be a number of seconds'}};function C(e,t,r,n){if(!d(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(i){const o=e[i];if(o){if(!o.isValid(r[i]))throw new Error(o.message)}else if(!t)throw new Error('"'+i+'" is not allowed in "'+n+'"')}))}const I={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},A=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];e.exports=function(e,t,r,i){"function"==typeof r?(i=r,r={}):r=r||{};const a="object"==typeof e&&!Buffer.isBuffer(e),c=Object.assign({alg:r.algorithm||"HS256",typ:a?"JWT":void 0,kid:r.keyid},r.header);function u(e){if(i)return i(e);throw e}if(!t&&"none"!==r.algorithm)return u(new Error("secretOrPrivateKey must have a value"));if(null!=t&&!(t instanceof p))try{t=m(t)}catch(e){try{t=g("string"==typeof t?Buffer.from(t):t)}catch(e){return u(new Error("secretOrPrivateKey is not valid key material"))}}if(c.alg.startsWith("HS")&&"secret"!==t.type)return u(new Error(`secretOrPrivateKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)){if("private"!==t.type)return u(new Error(`secretOrPrivateKey must be an asymmetric key when using ${c.alg}`));if(!r.allowInsecureKeySizes&&!c.alg.startsWith("ES")&&void 0!==t.asymmetricKeyDetails&&t.asymmetricKeyDetails.modulusLength<2048)return u(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`))}if(void 0===e)return u(new Error("payload is required"));if(a){try{!function(e){C(w,!0,e,"payload")}(e)}catch(e){return u(e)}r.mutatePayload||(e=Object.assign({},e))}else{const t=A.filter((function(e){return void 0!==r[e]}));if(t.length>0)return u(new Error("invalid "+t.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==r.expiresIn)return u(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==r.notBefore)return u(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){C(y,!1,e,"options")}(r)}catch(e){return u(e)}if(!r.allowInvalidAsymmetricKeyTypes)try{o(c.alg,t)}catch(e){return u(e)}const l=e.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete e.iat:a&&(e.iat=l),void 0!==r.notBefore){try{e.nbf=n(r.notBefore,l)}catch(e){return u(e)}if(void 0===e.nbf)return u(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==r.expiresIn&&"object"==typeof e){try{e.exp=n(r.expiresIn,l)}catch(e){return u(e)}if(void 0===e.exp)return u(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(I).forEach((function(t){const n=I[t];if(void 0!==r[t]){if(void 0!==e[n])return u(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=r[t]}}));const d=r.encoding||"utf8";if("function"!=typeof i){let n=s.sign({header:c,payload:e,secret:t,encoding:d});if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(c.alg)&&n.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`);return n}i=i&&f(i),s.createSign({header:c,privateKey:t,payload:e,encoding:d}).once("error",i).once("done",(function(e){if(!r.allowInsecureKeySizes&&/^(?:RS|PS)/.test(c.alg)&&e.length<256)return i(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${c.alg}`));i(null,e)}))}},1691:(e,t,r)=>{const n=r(1741),i=r(3726),o=r(8980),s=r(7260),a=r(855),c=r(7019),u=r(4977),l=r(5747),{KeyObject:d,createSecretKey:h,createPublicKey:f}=r(6982),p=["RS256","RS384","RS512"],g=["ES256","ES384","ES512"],m=["RS256","RS384","RS512"],v=["HS256","HS384","HS512"];u&&(p.splice(p.length,0,"PS256","PS384","PS512"),m.splice(m.length,0,"PS256","PS384","PS512")),e.exports=function(e,t,r,u){let y;if("function"!=typeof r||u||(u=r,r={}),r||(r={}),r=Object.assign({},r),y=u||function(e,t){if(e)throw e;return t},r.clockTimestamp&&"number"!=typeof r.clockTimestamp)return y(new n("clockTimestamp must be a number"));if(void 0!==r.nonce&&("string"!=typeof r.nonce||""===r.nonce.trim()))return y(new n("nonce must be a non-empty string"));if(void 0!==r.allowInvalidAsymmetricKeyTypes&&"boolean"!=typeof r.allowInvalidAsymmetricKeyTypes)return y(new n("allowInvalidAsymmetricKeyTypes must be a boolean"));const w=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return y(new n("jwt must be provided"));if("string"!=typeof e)return y(new n("jwt must be a string"));const C=e.split(".");if(3!==C.length)return y(new n("jwt malformed"));let I;try{I=s(e,{complete:!0})}catch(e){return y(e)}if(!I)return y(new n("invalid token"));const A=I.header;let S;if("function"==typeof t){if(!u)return y(new n("verify must be called asynchronous if secret or public key is provided as a callback"));S=t}else S=function(e,r){return r(null,t)};return S(A,(function(t,s){if(t)return y(new n("error in secret or public key callback: "+t.message));const u=""!==C[2].trim();if(!u&&s)return y(new n("jwt signature is required"));if(u&&!s)return y(new n("secret or public key must be provided"));if(!u&&!r.algorithms)return y(new n('please specify "none" in "algorithms" to verify unsigned tokens'));if(null!=s&&!(s instanceof d))try{s=f(s)}catch(e){try{s=h("string"==typeof s?Buffer.from(s):s)}catch(e){return y(new n("secretOrPublicKey is not valid key material"))}}if(r.algorithms||("secret"===s.type?r.algorithms=v:["rsa","rsa-pss"].includes(s.asymmetricKeyType)?r.algorithms=m:"ec"===s.asymmetricKeyType?r.algorithms=g:r.algorithms=p),-1===r.algorithms.indexOf(I.header.alg))return y(new n("invalid algorithm"));if(A.alg.startsWith("HS")&&"secret"!==s.type)return y(new n(`secretOrPublicKey must be a symmetric key when using ${A.alg}`));if(/^(?:RS|PS|ES)/.test(A.alg)&&"public"!==s.type)return y(new n(`secretOrPublicKey must be an asymmetric key when using ${A.alg}`));if(!r.allowInvalidAsymmetricKeyTypes)try{c(A.alg,s)}catch(e){return y(e)}let S;try{S=l.verify(e,I.header.alg,s)}catch(e){return y(e)}if(!S)return y(new n("invalid signature"));const E=I.payload;if(void 0!==E.nbf&&!r.ignoreNotBefore){if("number"!=typeof E.nbf)return y(new n("invalid nbf value"));if(E.nbf>w+(r.clockTolerance||0))return y(new i("jwt not active",new Date(1e3*E.nbf)))}if(void 0!==E.exp&&!r.ignoreExpiration){if("number"!=typeof E.exp)return y(new n("invalid exp value"));if(w>=E.exp+(r.clockTolerance||0))return y(new o("jwt expired",new Date(1e3*E.exp)))}if(r.audience){const e=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(E.aud)?E.aud:[E.aud]).some((function(t){return e.some((function(e){return e instanceof RegExp?e.test(t):e===t}))})))return y(new n("jwt audience invalid. expected: "+e.join(" or ")))}if(r.issuer&&("string"==typeof r.issuer&&E.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(E.iss)))return y(new n("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&E.sub!==r.subject)return y(new n("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&E.jti!==r.jwtid)return y(new n("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&E.nonce!==r.nonce)return y(new n("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if("number"!=typeof E.iat)return y(new n("iat required when maxAge is specified"));const e=a(r.maxAge,E.iat);if(void 0===e)return y(new n('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(w>=e+(r.clockTolerance||0))return y(new o("maxAge exceeded",new Date(1e3*e)))}if(!0===r.complete){const e=I.signature;return y(null,{header:A,payload:E,signature:e})}return y(null,E)}))}},8789:(e,t,r)=>{var n=r(1045),i=r(2861).Buffer,o=r(6982),s=r(2010),a=r(9023),c="secret must be a string or buffer",u="key must be a string or a buffer",l="key must be a string, a buffer or an object",d="function"==typeof o.createPublicKey;function h(e){if(!i.isBuffer(e)&&"string"!=typeof e){if(!d)throw m(u);if("object"!=typeof e)throw m(u);if("string"!=typeof e.type)throw m(u);if("string"!=typeof e.asymmetricKeyType)throw m(u);if("function"!=typeof e.export)throw m(u)}}function f(e){if(!i.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw m(l)}function p(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function g(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function m(e){var t=[].slice.call(arguments,1),r=a.format.bind(a,e).apply(null,t);return new TypeError(r)}function v(e){var t;return t=e,i.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function y(e){return function(t,r){!function(e){if(!i.isBuffer(e)){if("string"==typeof e)return e;if(!d)throw m(c);if("object"!=typeof e)throw m(c);if("secret"!==e.type)throw m(c);if("function"!=typeof e.export)throw m(c)}}(r),t=v(t);var n=o.createHmac("sha"+e,r);return p((n.update(t),n.digest("base64")))}}function w(e){return function(t,r,o){var s=y(e)(t,o);return n(i.from(r),i.from(s))}}function C(e){return function(t,r){f(r),t=v(t);var n=o.createSign("RSA-SHA"+e);return p((n.update(t),n.sign(r,"base64")))}}function I(e){return function(t,r,n){h(n),t=v(t),r=g(r);var i=o.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function A(e){return function(t,r){f(r),t=v(t);var n=o.createSign("RSA-SHA"+e);return p((n.update(t),n.sign({key:r,padding:o.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function S(e){return function(t,r,n){h(n),t=v(t),r=g(r);var i=o.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:n,padding:o.constants.RSA_PKCS1_PSS_PADDING,saltLength:o.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function E(e){var t=C(e);return function(){var r=t.apply(null,arguments);return s.derToJose(r,"ES"+e)}}function T(e){var t=I(e);return function(r,n,i){return n=s.joseToDer(n,"ES"+e).toString("base64"),t(r,n,i)}}function _(){return function(){return""}}function b(){return function(e,t){return""===t}}d&&(u+=" or a KeyObject",c+="or a KeyObject"),e.exports=function(e){var t={hs:y,rs:C,ps:A,es:E,none:_},r={hs:w,rs:I,ps:S,es:T,none:b},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw m('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:t[i](o),verify:r[i](o)}}},5747:(e,t,r)=>{var n=r(3387),i=r(7599);t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],t.sign=n.sign,t.verify=i.verify,t.decode=i.decode,t.isValid=i.isValid,t.createSign=function(e){return new n(e)},t.createVerify=function(e){return new i(e)}},8948:(e,t,r)=>{var n=r(2861).Buffer,i=r(2203);function o(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=n.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=n.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}r(9023).inherits(o,i),o.prototype.write=function(e){this.buffer=n.concat([this.buffer,n.from(e)]),this.emit("data",e)},o.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=o},3387:(e,t,r)=>{var n=r(2861).Buffer,i=r(8948),o=r(8789),s=r(2203),a=r(2851),c=r(9023);function u(e,t){return n.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function l(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,i=e.encoding,s=o(t.alg),l=function(e,t,r){r=r||"utf8";var n=u(a(e),"binary"),i=u(a(t),r);return c.format("%s.%s",n,i)}(t,r,i),d=s.sign(l,n);return c.format("%s.%s",l,d)}function d(e){var t=e.secret||e.privateKey||e.key,r=new i(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new i(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}c.inherits(d,s),d.prototype.sign=function(){try{var e=l({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},d.sign=l,e.exports=d},2851:(e,t,r)=>{var n=r(181).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||n.isBuffer(e)?e.toString():JSON.stringify(e)}},7599:(e,t,r)=>{var n=r(2861).Buffer,i=r(8948),o=r(8789),s=r(2203),a=r(2851),c=r(9023),u=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function l(e){var t=e.split(".",1)[0];return function(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(e){return}}(n.from(t,"base64").toString("binary"))}function d(e){return e.split(".")[2]}function h(e){return u.test(e)&&!!l(e)}function f(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=d(e=a(e)),s=function(e){return e.split(".",2).join(".")}(e);return o(t).verify(s,i,r)}function p(e,t){if(t=t||{},!h(e=a(e)))return null;var r=l(e);if(!r)return null;var i=function(e,t){t=t||"utf8";var r=e.split(".")[1];return n.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(i=JSON.parse(i,t.encoding)),{header:r,payload:i,signature:d(e)}}function g(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new i(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new i(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}c.inherits(g,s),g.prototype.verify=function(){try{var e=f(this.signature.buffer,this.algorithm,this.key.buffer),t=p(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},g.decode=p,g.isValid=h,g.verify=f,e.exports=g},6111:e=>{var t=1/0,r=9007199254740991,n="[object Function]",i="[object GeneratorFunction]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=/^(?:0|[1-9]\d*)$/,l=parseInt;function d(e){return e!=e}var h,f,p=Object.prototype,g=p.hasOwnProperty,m=p.toString,v=p.propertyIsEnumerable,y=(h=Object.keys,f=Object,function(e){return h(f(e))}),w=Math.max;function C(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||u.test(e))&&e>-1&&e%1==0&&e<t}var I=Array.isArray;function A(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!function(e){var t=S(e)?m.call(e):"";return t==n||t==i}(e)}function S(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function E(e){return!!e&&"object"==typeof e}e.exports=function(e,r,n,i){var u;e=A(e)?e:(u=e)?function(e,t){return function(t,r){for(var n=-1,i=t?t.length:0,o=Array(i);++n<i;)o[n]=(s=t[n],e[s]);var s;return o}(t)}(u,function(e){return A(e)?function(e,t){var r=I(e)||function(e){return function(e){return E(e)&&A(e)}(e)&&g.call(e,"callee")&&(!v.call(e,"callee")||"[object Arguments]"==m.call(e))}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var o in e)!t&&!g.call(e,o)||i&&("length"==o||C(o,n))||r.push(o);return r}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||p))return y(e);var t,r,n=[];for(var i in Object(e))g.call(e,i)&&"constructor"!=i&&n.push(i);return n}(e)}(u)):[],n=n&&!i?function(e){var r=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||E(e)&&"[object Symbol]"==m.call(e)}(e))return NaN;if(S(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=S(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var r=a.test(e);return r||c.test(e)?l(e.slice(2),r?2:8):s.test(e)?NaN:+e}(e))===t||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),n=r%1;return r==r?n?r-n:r:0}(n):0;var h=e.length;return n<0&&(n=w(h+n,0)),function(e){return"string"==typeof e||!I(e)&&E(e)&&"[object String]"==m.call(e)}(e)?n<=h&&e.indexOf(r,n)>-1:!!h&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,o=r+-1;++o<i;)if(t(e[o],o,e))return o;return-1}(e,d,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,r,n)>-1}},7914:e=>{var t=Object.prototype.toString;e.exports=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==t.call(e)}},8928:e=>{var t=1/0,r=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,a=Object.prototype.toString;function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return"number"==typeof e&&e==function(e){var u=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==a.call(e)}(e))return NaN;if(c(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=c(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var u=i.test(e);return u||o.test(e)?s(e.slice(2),u?2:8):n.test(e)?NaN:+e}(e))===t||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),l=u%1;return u==u?l?u-l:u:0}(e)}},3639:e=>{var t=Object.prototype.toString;e.exports=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==t.call(e)}},9001:e=>{var t,r,n=Function.prototype,i=Object.prototype,o=n.toString,s=i.hasOwnProperty,a=o.call(Object),c=i.toString,u=(t=Object.getPrototypeOf,r=Object,function(e){return t(r(e))});e.exports=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=c.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=u(e);if(null===t)return!0;var r=s.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&o.call(r)==a}},5931:e=>{var t=Object.prototype.toString,r=Array.isArray;e.exports=function(e){return"string"==typeof e||!r(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==t.call(e)}},7083:e=>{var t=1/0,r=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,a=Object.prototype.toString;function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e){return function(e,u){var l;if("function"!=typeof u)throw new TypeError("Expected a function");return e=function(e){var u=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==a.call(e)}(e))return NaN;if(c(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=c(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var u=i.test(e);return u||o.test(e)?s(e.slice(2),u?2:8):n.test(e)?NaN:+e}(e))===t||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),l=u%1;return u==u?l?u-l:u:0}(e),function(){return--e>0&&(l=u.apply(this,arguments)),e<=1&&(u=void 0),l}}(2,e)}},6585:e=>{var t=1e3,r=60*t,n=60*r,i=24*n,o=7*i;function s(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,a){a=a||{};var c,u,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var a=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return a*o;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===l&&isFinite(e))return a.long?(c=e,(u=Math.abs(c))>=i?s(c,u,i,"day"):u>=n?s(c,u,n,"hour"):u>=r?s(c,u,r,"minute"):u>=t?s(c,u,t,"second"):c+" ms"):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=n?Math.round(e/n)+"h":o>=r?Math.round(e/r)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2861:(e,t,r)=>{var n=r(181),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},3904:(e,t,r)=>{const n=Symbol("SemVer ANY");class i{static get ANY(){return n}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new l(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return c(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):!((t=o(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(c(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(c(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=i;const o=r(8587),{safeRe:s,t:a}=r(9718),c=r(2111),u=r(7272),l=r(3908),d=r(8311)},8311:(e,t,r)=>{class n{constructor(e,t){if(t=o(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof s)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!m(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&v(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&p)|(this.options.loose&&g))+":"+e,r=i.get(t);if(r)return r;const n=this.options.loose,o=n?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];e=e.replace(o,P(this.options.includePrerelease)),a("hyphen replace",e),e=e.replace(u[l.COMPARATORTRIM],d),a("comparator trim",e),e=e.replace(u[l.TILDETRIM],h),a("tilde trim",e),e=e.replace(u[l.CARETTRIM],f),a("caret trim",e);let c=e.split(" ").map((e=>w(e,this.options))).join(" ").split(/\s+/).map((e=>k(e,this.options)));n&&(c=c.filter((e=>(a("loose invalid filter",e,this.options),!!e.match(u[l.COMPARATORLOOSE]))))),a("range list",c);const v=new Map,y=c.map((e=>new s(e,this.options)));for(const e of y){if(m(e))return[e];v.set(e.value,e)}v.size>1&&v.has("")&&v.delete("");const C=[...v.values()];return i.set(t,C),C}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some((r=>y(r,t)&&e.set.some((e=>y(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(R(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const i=new(r(8794)),o=r(8587),s=r(3904),a=r(7272),c=r(3908),{safeRe:u,t:l,comparatorTrimReplace:d,tildeTrimReplace:h,caretTrimReplace:f}=r(9718),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:g}=r(6874),m=e=>"<0.0.0-0"===e.value,v=e=>""===e.value,y=(e,t)=>{let r=!0;const n=e.slice();let i=n.pop();for(;r&&n.length;)r=n.every((e=>i.intersects(e,t))),i=n.pop();return r},w=(e,t)=>(a("comp",e,t),e=S(e,t),a("caret",e),e=I(e,t),a("tildes",e),e=T(e,t),a("xrange",e),e=b(e,t),a("stars",e),e),C=e=>!e||"x"===e.toLowerCase()||"*"===e,I=(e,t)=>e.trim().split(/\s+/).map((e=>A(e,t))).join(" "),A=(e,t)=>{const r=t.loose?u[l.TILDELOOSE]:u[l.TILDE];return e.replace(r,((t,r,n,i,o)=>{let s;return a("tilde",e,t,r,n,i,o),C(r)?s="":C(n)?s=`>=${r}.0.0 <${+r+1}.0.0-0`:C(i)?s=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:o?(a("replaceTilde pr",o),s=`>=${r}.${n}.${i}-${o} <${r}.${+n+1}.0-0`):s=`>=${r}.${n}.${i} <${r}.${+n+1}.0-0`,a("tilde return",s),s}))},S=(e,t)=>e.trim().split(/\s+/).map((e=>E(e,t))).join(" "),E=(e,t)=>{a("caret",e,t);const r=t.loose?u[l.CARETLOOSE]:u[l.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,i,o,s)=>{let c;return a("caret",e,t,r,i,o,s),C(r)?c="":C(i)?c=`>=${r}.0.0${n} <${+r+1}.0.0-0`:C(o)?c="0"===r?`>=${r}.${i}.0${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.0${n} <${+r+1}.0.0-0`:s?(a("replaceCaret pr",s),c="0"===r?"0"===i?`>=${r}.${i}.${o}-${s} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}-${s} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o}-${s} <${+r+1}.0.0-0`):(a("no pr"),c="0"===r?"0"===i?`>=${r}.${i}.${o}${n} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o} <${+r+1}.0.0-0`),a("caret return",c),c}))},T=(e,t)=>(a("replaceXRanges",e,t),e.split(/\s+/).map((e=>_(e,t))).join(" ")),_=(e,t)=>{e=e.trim();const r=t.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return e.replace(r,((r,n,i,o,s,c)=>{a("xRange",e,r,n,i,o,s,c);const u=C(i),l=u||C(o),d=l||C(s),h=d;return"="===n&&h&&(n=""),c=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(l&&(o=0),s=0,">"===n?(n=">=",l?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===n&&(n="<",l?i=+i+1:o=+o+1),"<"===n&&(c="-0"),r=`${n+i}.${o}.${s}${c}`):l?r=`>=${i}.0.0${c} <${+i+1}.0.0-0`:d&&(r=`>=${i}.${o}.0${c} <${i}.${+o+1}.0-0`),a("xRange return",r),r}))},b=(e,t)=>(a("replaceStars",e,t),e.trim().replace(u[l.STAR],"")),k=(e,t)=>(a("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?l.GTE0PRE:l.GTE0],"")),P=e=>(t,r,n,i,o,s,a,c,u,l,d,h)=>`${r=C(n)?"":C(i)?`>=${n}.0.0${e?"-0":""}`:C(o)?`>=${n}.${i}.0${e?"-0":""}`:s?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=C(u)?"":C(l)?`<${+u+1}.0.0-0`:C(d)?`<${u}.${+l+1}.0-0`:h?`<=${u}.${l}.${d}-${h}`:e?`<${u}.${l}.${+d+1}-0`:`<=${c}`}`.trim(),R=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(a(e[r].semver),e[r].semver!==s.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},3908:(e,t,r)=>{const n=r(7272),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=r(6874),{safeRe:s,t:a}=r(9718),c=r(8587),{compareIdentifiers:u}=r(1123);class l{constructor(e,t){if(t=c(t),e instanceof l){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof l)){if("string"==typeof e&&e===this.version)return 0;e=new l(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof l||(e=new l(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return u(r,i)}while(++t)}compareBuild(e){e instanceof l||(e=new l(e,this.options));let t=0;do{const r=this.build[t],i=e.build[t];if(n("build compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return u(r,i)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=l},7414:(e,t,r)=>{const n=r(144);e.exports=(e,t)=>{const r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},2111:(e,t,r)=>{const n=r(4641),i=r(3999),o=r(5580),s=r(4089),a=r(7059),c=r(5200);e.exports=(e,t,r,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,u);case"!=":return i(e,r,u);case">":return o(e,r,u);case">=":return s(e,r,u);case"<":return a(e,r,u);case"<=":return c(e,r,u);default:throw new TypeError(`Invalid operator: ${t}`)}}},6170:(e,t,r)=>{const n=r(3908),i=r(144),{safeRe:o,t:s}=r(9718);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const n=t.includePrerelease?o[s.COERCERTLFULL]:o[s.COERCERTL];let i;for(;(i=n.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&i.index+i[0].length===r.index+r[0].length||(r=i),n.lastIndex=i.index+i[1].length+i[2].length;n.lastIndex=-1}else r=e.match(t.includePrerelease?o[s.COERCEFULL]:o[s.COERCE]);if(null===r)return null;const a=r[2],c=r[3]||"0",u=r[4]||"0",l=t.includePrerelease&&r[5]?`-${r[5]}`:"",d=t.includePrerelease&&r[6]?`+${r[6]}`:"";return i(`${a}.${c}.${u}${l}${d}`,t)}},909:(e,t,r)=>{const n=r(3908);e.exports=(e,t,r)=>{const i=new n(e,r),o=new n(t,r);return i.compare(o)||i.compareBuild(o)}},1763:(e,t,r)=>{const n=r(560);e.exports=(e,t)=>n(e,t,!0)},560:(e,t,r)=>{const n=r(3908);e.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},1832:(e,t,r)=>{const n=r(144);e.exports=(e,t)=>{const r=n(e,null,!0),i=n(t,null,!0),o=r.compare(i);if(0===o)return null;const s=o>0,a=s?r:i,c=s?i:r,u=!!a.prerelease.length;if(c.prerelease.length&&!u)return c.patch||c.minor?a.patch?"patch":a.minor?"minor":"major":"major";const l=u?"pre":"";return r.major!==i.major?l+"major":r.minor!==i.minor?l+"minor":r.patch!==i.patch?l+"patch":"prerelease"}},4641:(e,t,r)=>{const n=r(560);e.exports=(e,t,r)=>0===n(e,t,r)},5580:(e,t,r)=>{const n=r(560);e.exports=(e,t,r)=>n(e,t,r)>0},4089:(e,t,r)=>{const n=r(560);e.exports=(e,t,r)=>n(e,t,r)>=0},3007:(e,t,r)=>{const n=r(3908);e.exports=(e,t,r,i,o)=>{"string"==typeof r&&(o=i,i=r,r=void 0);try{return new n(e instanceof n?e.version:e,r).inc(t,i,o).version}catch(e){return null}}},7059:(e,t,r)=>{const n=r(560);e.exports=(e,t,r)=>n(e,t,r)<0},5200:(e,t,r)=>{const n=r(560);e.exports=(e,t,r)=>n(e,t,r)<=0},2938:(e,t,r)=>{const n=r(3908);e.exports=(e,t)=>new n(e,t).major},6254:(e,t,r)=>{const n=r(3908);e.exports=(e,t)=>new n(e,t).minor},3999:(e,t,r)=>{const n=r(560);e.exports=(e,t,r)=>0!==n(e,t,r)},144:(e,t,r)=>{const n=r(3908);e.exports=(e,t,r=!1)=>{if(e instanceof n)return e;try{return new n(e,t)}catch(e){if(!r)return null;throw e}}},4493:(e,t,r)=>{const n=r(3908);e.exports=(e,t)=>new n(e,t).patch},1729:(e,t,r)=>{const n=r(144);e.exports=(e,t)=>{const r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},9970:(e,t,r)=>{const n=r(560);e.exports=(e,t,r)=>n(t,e,r)},4277:(e,t,r)=>{const n=r(909);e.exports=(e,t)=>e.sort(((e,r)=>n(r,e,t)))},7638:(e,t,r)=>{const n=r(8311);e.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},3927:(e,t,r)=>{const n=r(909);e.exports=(e,t)=>e.sort(((e,r)=>n(e,r,t)))},6953:(e,t,r)=>{const n=r(144);e.exports=(e,t)=>{const r=n(e,t);return r?r.version:null}},9589:(e,t,r)=>{const n=r(9718),i=r(6874),o=r(3908),s=r(1123),a=r(144),c=r(6953),u=r(7414),l=r(3007),d=r(1832),h=r(2938),f=r(6254),p=r(4493),g=r(1729),m=r(560),v=r(9970),y=r(1763),w=r(909),C=r(3927),I=r(4277),A=r(5580),S=r(7059),E=r(4641),T=r(3999),_=r(4089),b=r(5200),k=r(2111),P=r(6170),R=r(3904),O=r(8311),M=r(7638),x=r(7631),N=r(9628),D=r(270),L=r(1261),U=r(3874),F=r(7075),q=r(5571),H=r(5342),j=r(6780),B=r(2525),$=r(5032);e.exports={parse:a,valid:c,clean:u,inc:l,diff:d,major:h,minor:f,patch:p,prerelease:g,compare:m,rcompare:v,compareLoose:y,compareBuild:w,sort:C,rsort:I,gt:A,lt:S,eq:E,neq:T,gte:_,lte:b,cmp:k,coerce:P,Comparator:R,Range:O,satisfies:M,toComparators:x,maxSatisfying:N,minSatisfying:D,minVersion:L,validRange:U,outside:F,gtr:q,ltr:H,intersects:j,simplifyRange:B,subset:$,SemVer:o,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}},6874:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},7272:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},1123:e=>{const t=/^[0-9]+$/,r=(e,r)=>{const n=t.test(e),i=t.test(r);return n&&i&&(e=+e,r=+r),e===r?0:n&&!i?-1:i&&!n?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},8794:e=>{e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},8587:e=>{const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},9718:(e,t,r)=>{const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=r(6874),s=r(7272),a=(t=e.exports={}).re=[],c=t.safeRe=[],u=t.src=[],l=t.t={};let d=0;const h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",o],[h,i]],p=(e,t,r)=>{const n=(e=>{for(const[t,r]of f)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),i=d++;s(e,i,t),l[e]=i,u[i]=t,a[i]=new RegExp(t,r?"g":void 0),c[i]=new RegExp(n,r?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),p("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",`${h}+`),p("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),p("FULL",`^${u[l.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),p("LOOSE",`^${u[l.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),p("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),p("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),p("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),p("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),p("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?`+`(?:${u[l.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[l.COERCE],!0),p("COERCERTLFULL",u[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},5571:(e,t,r)=>{const n=r(7075);e.exports=(e,t,r)=>n(e,t,">",r)},6780:(e,t,r)=>{const n=r(8311);e.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t,r))},5342:(e,t,r)=>{const n=r(7075);e.exports=(e,t,r)=>n(e,t,"<",r)},9628:(e,t,r)=>{const n=r(3908),i=r(8311);e.exports=(e,t,r)=>{let o=null,s=null,a=null;try{a=new i(t,r)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&-1!==s.compare(e)||(o=e,s=new n(o,r)))})),o}},270:(e,t,r)=>{const n=r(3908),i=r(8311);e.exports=(e,t,r)=>{let o=null,s=null,a=null;try{a=new i(t,r)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&1!==s.compare(e)||(o=e,s=new n(o,r)))})),o}},1261:(e,t,r)=>{const n=r(3908),i=r(8311),o=r(5580);e.exports=(e,t)=>{e=new i(e,t);let r=new n("0.0.0");if(e.test(r))return r;if(r=new n("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!o(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||r&&!o(r,s)||(r=s)}return r&&e.test(r)?r:null}},7075:(e,t,r)=>{const n=r(3908),i=r(3904),{ANY:o}=i,s=r(8311),a=r(7638),c=r(5580),u=r(7059),l=r(5200),d=r(4089);e.exports=(e,t,r,h)=>{let f,p,g,m,v;switch(e=new n(e,h),t=new s(t,h),r){case">":f=c,p=l,g=u,m=">",v=">=";break;case"<":f=u,p=d,g=c,m="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,h))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let s=null,a=null;if(n.forEach((e=>{e.semver===o&&(e=new i(">=0.0.0")),s=s||e,a=a||e,f(e.semver,s.semver,h)?s=e:g(e.semver,a.semver,h)&&(a=e)})),s.operator===m||s.operator===v)return!1;if((!a.operator||a.operator===m)&&p(e,a.semver))return!1;if(a.operator===v&&g(e,a.semver))return!1}return!0}},2525:(e,t,r)=>{const n=r(7638),i=r(560);e.exports=(e,t,r)=>{const o=[];let s=null,a=null;const c=e.sort(((e,t)=>i(e,t,r)));for(const e of c)n(e,t,r)?(a=e,s||(s=e)):(a&&o.push([s,a]),a=null,s=null);s&&o.push([s,null]);const u=[];for(const[e,t]of o)e===t?u.push(e):t||e!==c[0]?t?e===c[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const l=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return l.length<d.length?l:t}},5032:(e,t,r)=>{const n=r(8311),i=r(3904),{ANY:o}=i,s=r(7638),a=r(560),c=[new i(">=0.0.0-0")],u=[new i(">=0.0.0")],l=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=r.includePrerelease?c:u}if(1===t.length&&t[0].semver===o){if(r.includePrerelease)return!0;t=u}const n=new Set;let i,l,f,p,g,m,v;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,r):"<"===t.operator||"<="===t.operator?l=h(l,t,r):n.add(t.semver);if(n.size>1)return null;if(i&&l){if(f=a(i.semver,l.semver,r),f>0)return null;if(0===f&&(">="!==i.operator||"<="!==l.operator))return null}for(const e of n){if(i&&!s(e,String(i),r))return null;if(l&&!s(e,String(l),r))return null;for(const n of t)if(!s(e,String(n),r))return!1;return!0}let y=!(!l||r.includePrerelease||!l.semver.prerelease.length)&&l.semver,w=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver;y&&1===y.prerelease.length&&"<"===l.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(v=v||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,i)if(w&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===w.major&&e.semver.minor===w.minor&&e.semver.patch===w.patch&&(w=!1),">"===e.operator||">="===e.operator){if(p=d(i,e,r),p===e&&p!==i)return!1}else if(">="===i.operator&&!s(i.semver,String(e),r))return!1;if(l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(g=h(l,e,r),g===e&&g!==l)return!1}else if("<="===l.operator&&!s(l.semver,String(e),r))return!1;if(!e.operator&&(l||i)&&0!==f)return!1}return!(i&&m&&!l&&0!==f||l&&v&&!i&&0!==f||w||y)},d=(e,t,r)=>{if(!e)return t;const n=a(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},h=(e,t,r)=>{if(!e)return t;const n=a(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new n(e,r),t=new n(t,r);let i=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,r);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},7631:(e,t,r)=>{const n=r(8311);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},3874:(e,t,r)=>{const n=r(8311);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},2909:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentationService=void 0;var n=r(7291);Object.defineProperty(t,"ExperimentationService",{enumerable:!0,get:function(){return n.ExperimentationService}})},7291:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentationService=void 0;const n=r(2845),i=r(1924),o=r(5761);class s extends o.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],null!=e.refetchInterval?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new n.TasApiFeatureProvider(new i.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}}t.ExperimentationService=s,s.REFRESH_RATE_IN_MINUTES=30},5761:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentationServiceAutoPolling=void 0;const n=r(1714),i=r(3257);class o extends n.ExperimentationServiceBase{constructor(e,t,r,n,o,s,a){if(super(e,n,o,s,a),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=r,this.assignmentContextTelemetryPropertyName=n,this.telemetryEventName=o,this.storageKey=s,this.storage=a,r<1e3&&0!==r)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");r>0&&(this.pollingService=new i.PollingService(r),this.pollingService.OnPollTick((async()=>{await super.getFeaturesAsync()})))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}return await super.getFeaturesAsync(e)}}t.ExperimentationServiceAutoPolling=o},1714:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentationServiceBase=void 0;const n=r(8823);t.ExperimentationServiceBase=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,r,i,o){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=r,this.storageKey=i,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new n.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise(((e,t)=>{this.resolveInitialFetchPromise=e}))}async getFeaturesAsync(e=!1){if(null!=this.fetchPromise){try{await this.fetchPromise}catch(e){}return this.features}if(!this.featureProviders||0===this.featureProviders.length)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map((async e=>await e.getFeatures())));const t=await this.fetchPromise;this.updateFeatures(t,e)}catch(e){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let r={features:[],assignmentContext:"",configs:[]};for(let t of e){for(let e of t.features)r.features.includes(e)||r.features.push(e);for(let e of t.configs){const t=r.configs.find((t=>t.Id===e.Id));t?t.Parameters=Object.assign(Object.assign({},t.Parameters),e.Parameters):r.configs.push(e)}r.assignmentContext+=t.assignmentContext}!t&&this.featuresConsumed||(this.features=r),this.storage&&this.storage.setValue(this.storageKey,r)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),void 0!==e&&void 0===e.configs&&(e.configs=[])),0===this.features.features.length&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){const t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);const r=this.features.configs.find((t=>t.Id===e));return null==r?void 0:r.Parameters[t]}async getTreatmentVariableAsync(e,t,r){if(r){const r=this.featuresConsumed,n=this.getTreatmentVariable(e,t);if(void 0!==n)return n;this.featuresConsumed=r}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(null!=e&&null!=this.featureProviders)for(let t of e)this.featureProviders.push(t)}}},6790:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseFeatureProvider=void 0,t.BaseFeatureProvider=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}}},4111:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilteredFeatureProvider=void 0;const n=r(6790);class i extends n.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let r=t.getFilters();for(let t of r.keys()){let n=r.get(t);e.set(t,n)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;const t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}}t.FilteredFeatureProvider=i},2845:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TasApiFeatureProvider=t.TASAPI_FETCHERROR_EVENTNAME=void 0;const n=r(4111);t.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";const i="ErrorType";class o extends n.FilteredFeatureProvider{constructor(e,t,r){super(t,r),this.httpClient=e,this.telemetry=t,this.filterProviders=r}async fetch(){let e,r=this.getFilters(),n={};for(let e of r.keys()){const t=r.get(e);n[e]=t}try{e=await this.httpClient.get({headers:n})}catch(e){const r=e,n=new Map;r.responseReceived&&!r.responseOk?n.set(i,"ServerError"):!1===r.responseReceived?n.set(i,"NoResponse"):n.set(i,"GenericError"),this.telemetry.postEvent(t.TASAPI_FETCHERROR_EVENTNAME,n)}if(!e)throw Error(t.TASAPI_FETCHERROR_EVENTNAME);r.keys.length>0&&this.PostEventToTelemetry(n);const o=e.data;let s=o.Configs,a=[];for(let e of s)if(e.Parameters)for(let t of Object.keys(e.Parameters)){const r=t+(e.Parameters[t]?"":"cf");a.includes(r)||a.push(r)}return{features:a,assignmentContext:o.AssignmentContext,configs:s}}}t.TasApiFeatureProvider=o},1924:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpClient=t.FetchError=void 0;class r extends Error{constructor(e,t,r){super(e),this.responseReceived=t,this.responseOk=r}}t.FetchError=r,t.HttpClient=class{constructor(e){this.endpoint=e}async get(e){const t=await fetch(this.endpoint,{method:"GET",headers:null==e?void 0:e.headers});if(!t)throw new r("No response received",!1);if(!t.ok)throw new r("Response not ok",!0,!1);const n=await t.json();if(!n)throw new r("No data received",!1);return{data:n}}}},8823:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryKeyValueStorage=void 0,t.MemoryKeyValueStorage=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}}},3257:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PollingService=void 0,t.PollingService=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),null!=this.onTick&&(e&&this.onTick().then((()=>{})).catch((()=>{})),this.intervalHandle=setInterval((async()=>{await this.onTick()}),this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}}},2107:(e,t,r)=>{"use strict";Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return n.default}});i(r(8610)),i(r(3208));var n=i(r(4061));i(r(3358)),i(r(6348)),i(r(51)),i(r(129)),i(r(2298)),i(r(2356));function i(e){return e&&e.__esModule?e:{default:e}}},8435:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(6982))&&n.__esModule?n:{default:n};t.default=function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i.default.createHash("md5").update(e).digest()}},6348:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},2356:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(129))&&n.__esModule?n:{default:n};t.default=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}},996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},9614:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return s>o.length-16&&(i.default.randomFillSync(o),s=0),o.slice(s,s+=16)};var n,i=(n=r(6982))&&n.__esModule?n:{default:n};const o=new Uint8Array(256);let s=o.length},622:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(6982))&&n.__esModule?n:{default:n};t.default=function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),i.default.createHash("sha1").update(e).digest()}},2298:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(129))&&n.__esModule?n:{default:n};const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).substr(1));t.default=function(e,t=0){const r=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!(0,i.default)(r))throw TypeError("Stringified UUID is invalid");return r}},8610:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(9614)),i=o(r(2298));function o(e){return e&&e.__esModule?e:{default:e}}let s,a,c=0,u=0;t.default=function(e,t,r){let o=t&&r||0;const l=t||new Array(16);let d=(e=e||{}).node||s,h=void 0!==e.clockseq?e.clockseq:a;if(null==d||null==h){const t=e.random||(e.rng||n.default)();null==d&&(d=s=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=a=16383&(t[6]<<8|t[7]))}let f=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:u+1;const g=f-c+(p-u)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||f>c)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=f,u=p,a=h,f+=122192928e5;const m=(1e4*(268435455&f)+p)%4294967296;l[o++]=m>>>24&255,l[o++]=m>>>16&255,l[o++]=m>>>8&255,l[o++]=255&m;const v=f/4294967296*1e4&268435455;l[o++]=v>>>8&255,l[o++]=255&v,l[o++]=v>>>24&15|16,l[o++]=v>>>16&255,l[o++]=h>>>8|128,l[o++]=255&h;for(let e=0;e<6;++e)l[o+e]=d[e];return t||(0,i.default)(l)}},3208:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(1525)),i=o(r(8435));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,n.default)("v3",48,i.default);t.default=s},1525:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){function o(e,o,s,a){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof o&&(o=(0,i.default)(o)),16!==o.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+e.length);if(c.set(o),c.set(e,o.length),c=r(c),c[6]=15&c[6]|t,c[8]=63&c[8]|128,s){a=a||0;for(let e=0;e<16;++e)s[a+e]=c[e];return s}return(0,n.default)(c)}try{o.name=e}catch(e){}return o.DNS=s,o.URL=a,o},t.URL=t.DNS=void 0;var n=o(r(2298)),i=o(r(2356));function o(e){return e&&e.__esModule?e:{default:e}}const s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=s;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},4061:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(9614)),i=o(r(2298));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,r){const o=(e=e||{}).random||(e.rng||n.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return(0,i.default)(o)}},3358:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(1525)),i=o(r(622));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,n.default)("v5",80,i.default);t.default=s},129:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(996))&&n.__esModule?n:{default:n};t.default=function(e){return"string"==typeof e&&i.default.test(e)}},51:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(129))&&n.__esModule?n:{default:n};t.default=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},1566:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetPopulation=t.getExperimentationServiceAsync=t.getExperimentationService=void 0;var n=r(2493);Object.defineProperty(t,"getExperimentationService",{enumerable:!0,get:function(){return n.getExperimentationService}}),Object.defineProperty(t,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return n.getExperimentationServiceAsync}});var i=r(8967);Object.defineProperty(t,"TargetPopulation",{enumerable:!0,get:function(){return i.TargetPopulation}})},8142:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MementoKeyValueStorage=void 0,t.MementoKeyValueStorage=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}}},9052:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}}},8967:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetPopulation=t.Filters=t.VSCodeFilterProvider=void 0;const n=r(1398);class i{constructor(e,t,r){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=r}static trimVersionSuffix(e){return e.split(/\-[a-zA-Z0-9]+$/)[0]}getFilterValue(e){switch(e){case o.ApplicationVersion:return i.trimVersionSuffix(n.version);case o.Build:return n.env.appName;case o.ClientId:return n.env.machineId;case o.ExtensionName:return this.extensionName;case o.ExtensionVersion:return i.trimVersionSuffix(this.extensionVersion);case o.Language:return n.env.language;case o.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(o);for(let r of t)e.set(r,this.getFilterValue(r));return e}}var o,s;t.VSCodeFilterProvider=i,function(e){e.Market="X-MSEdge-Market",e.CorpNet="X-FD-Corpnet",e.ApplicationVersion="X-VSCode-AppVersion",e.Build="X-VSCode-Build",e.ClientId="X-MSEdge-ClientId",e.ExtensionName="X-VSCode-ExtensionName",e.ExtensionVersion="X-VSCode-ExtensionVersion",e.Language="X-VSCode-Language",e.TargetPopulation="X-VSCode-TargetPopulation"}(o||(t.Filters=o={})),function(e){e.Team="team",e.Internal="internal",e.Insiders="insider",e.Public="public"}(s||(t.TargetPopulation=s={}))},2493:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExperimentationServiceAsync=t.getExperimentationService=void 0;const n=r(8967),i=r(2909),o=r(1398),s=r(8142),a=r(9052);function c(e,t,r,c,u,...l){if(!u)throw new Error("Memento storage was not provided.");const d=o.workspace.getConfiguration("telemetry");if(!(void 0===o.env.isTelemetryEnabled?d.get("enableTelemetry",!0):o.env.isTelemetryEnabled))return new a.default;const h=[new n.VSCodeFilterProvider(e,t,r),...l],f=new s.MementoKeyValueStorage(u);return new i.ExperimentationService({filterProviders:h,telemetry:c,storageKey:"VSCode.ABExp.FeatureData",keyValueStorage:f,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:"abexp.assignmentcontext",telemetryEventName:"query-expfeature",endpoint:"https://default.exp-tas.com/vscode/ab",refetchInterval:18e5})}t.getExperimentationService=c,t.getExperimentationServiceAsync=async function(e,t,r,n,i,...o){const s=c(e,t,r,n,i,...o);return await s.initializePromise,s}},9008:(e,t)=>{t.setPassword=()=>Promise.resolve(),t.getPassword=()=>Promise.resolve(),t.deletePassword=()=>Promise.resolve()},8447:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),s=0;s<r.length;s++)"default"!==r[s]&&i(t,e,r[s]);return o(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AzureActiveDirectoryService=t.REFRESH_NETWORK_FAILURE=void 0;const c=s(r(1398)),u=s(r(6928)),l=r(9529),d=r(1619),h=r(5951),f=r(1589),p=r(2866),g=a(r(3034)),m=r(8197),v="https://vscode.dev/redirect",y=m.Environment.AzureCloud.activeDirectoryEndpointUrl,w="aebc6443-996d-45c2-90f0-388ff96faa56";t.REFRESH_NETWORK_FAILURE="Network failure";class C{constructor(e,t,r,n,i,o){this._logger=e,this._uriHandler=r,this._tokenStorage=n,this._telemetryReporter=i,this._env=o,this._tokens=[],this._refreshTimeouts=new Map,this._sessionChangeEmitter=new c.EventEmitter,this._pendingNonces=new Map,this._codeExchangePromises=new Map,this._codeVerfifiers=new Map,this._pendingTokensToStore=new Map,this._sequencer=new d.SequencerByKey,t.subscriptions.push(this._tokenStorage.onDidChangeInOtherWindow((e=>this.checkForUpdates(e)))),t.subscriptions.push(c.window.onDidChangeWindowState((async e=>e.focused&&await this.storePendingTokens())));const s=new d.IntervalTimer;s.cancelAndSet((()=>!c.window.state.focused&&this.storePendingTokens()),18e6+Math.floor(3e4*Math.random())),t.subscriptions.push(s)}async initialize(){this._logger.trace("Reading sessions from secret storage...");const e=await this._tokenStorage.getAll((e=>this.sessionMatchesEndpoint(e)));this._logger.trace(`Got ${e.length} stored sessions`);const r=e.map((async e=>{this._logger.trace(`[${e.scope}] '${e.id}' Read stored session`);const r=e.scope.split(" "),n={scopes:r,scopeStr:e.scope,scopesToSend:r.filter((e=>!e.startsWith("VSCODE_"))).join(" "),clientId:this.getClientId(r),tenant:this.getTenantId(r)};try{await this.refreshToken(e.refreshToken,n,e.id)}catch(r){r.message===t.REFRESH_NETWORK_FAILURE?this._tokens.push({accessToken:void 0,refreshToken:e.refreshToken,account:{...e.account,type:"unknown"},scope:e.scope,sessionId:e.id}):(c.window.showErrorMessage(c.l10n.t("You have been signed out because reading stored authentication information failed.")),this._logger.error(r),await this.removeSessionByIToken({accessToken:void 0,refreshToken:e.refreshToken,account:{...e.account,type:"unknown"},scope:e.scope,sessionId:e.id}))}})),n=await Promise.allSettled(r);for(const e of n)if("rejected"===e.status){this._logger.error(`Failed to initialize stored data: ${e.reason}`),this.clearSessions();break}for(const e of this._tokens)this._telemetryReporter.sendTelemetryEvent("account",{scopes:JSON.stringify(e.scope.replace(/[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/i,"{guid}").split(" ")),accountType:e.account.type})}get onDidChangeSessions(){return this._sessionChangeEmitter.event}getSessions(e,t){if(!e){this._logger.info("Getting sessions for all scopes...");const e=this._tokens.filter((e=>!t?.label||e.account.label===t.label)).map((e=>this.convertToSessionSync(e)));return this._logger.info(`Got ${e.length} sessions for all scopes${t?` for account '${t.label}'`:""}...`),Promise.resolve(e)}let r=[...e];r.includes("openid")||r.push("openid"),r.includes("email")||r.push("email"),r.includes("profile")||r.push("profile"),r.includes("offline_access")||r.push("offline_access"),r=r.sort();const n=r.join(" "),i={clientId:this.getClientId(e),originalScopes:e,scopes:r,scopeStr:n,scopesToSend:r.filter((e=>!e.startsWith("VSCODE_"))).join(" "),tenant:this.getTenantId(e)};return this._logger.trace(`[${i.scopeStr}] Queued getting sessions`+t?` for ${t?.label}`:""),this._sequencer.queue(n,(()=>this.doGetSessions(i,t)))}async doGetSessions(e,t){this._logger.info(`[${e.scopeStr}] Getting sessions`+t?` for ${t?.label}`:"");const r=this._tokens.filter((t=>t.scope===e.scopeStr)).filter((e=>!t?.label||e.account.label===t.label));if(!r.length){let n;for(const r of this._tokens)if(r.refreshToken&&(!t?.label||r.account.label===t.label)){if(e.clientId===w&&!r.scope.includes("VSCODE_CLIENT_ID")){n=r;break}if(e.clientId!==w&&r.scope.includes(`VSCODE_CLIENT_ID:${e.clientId}`)){n=r;break}}if(n){this._logger.trace(`[${e.scopeStr}] '${n.sessionId}' Found a matching token with a different scopes '${n.scope}'. Attempting to get a new session using the existing session.`);try{const t=await this.doRefreshToken(n.refreshToken,e);this._sessionChangeEmitter.fire({added:[this.convertToSessionSync(t)],removed:[],changed:[]}),r.push(t)}catch(t){this._logger.error(`[${e.scopeStr}] Attempted to get a new session using the existing session with scopes '${n.scope}' but it failed due to: ${t.message??t}`)}}}return this._logger.info(`[${e.scopeStr}] Got ${r.length} sessions`),(await Promise.allSettled(r.map((t=>this.convertToSession(t,e))))).filter((e=>"fulfilled"===e.status)).map((e=>e.value))}createSession(e,t){let r=[...e];r.includes("openid")||r.push("openid"),r.includes("email")||r.push("email"),r.includes("profile")||r.push("profile"),r.includes("offline_access")||r.push("offline_access"),r=r.sort();const n={originalScopes:e,scopes:r,scopeStr:r.join(" "),scopesToSend:r.filter((e=>!e.startsWith("VSCODE_"))).join(" "),clientId:this.getClientId(e),tenant:this.getTenantId(e)};return this._logger.trace(`[${n.scopeStr}] Queued creating session`),this._sequencer.queue(n.scopeStr,(()=>this.doCreateSession(n,t)))}async doCreateSession(e,t){this._logger.info(`[${e.scopeStr}] Creating session`+t?` for ${t?.label}`:"");const r=void 0!==c.env.remoteName,n=void 0===c.env.remoteName&&c.env.uiKind===c.UIKind.Web;if(n&&this._env.activeDirectoryEndpointUrl!==y)throw new Error("Sign in to non-public clouds is not supported on the web.");return await c.window.withProgress({location:c.ProgressLocation.Notification,title:c.l10n.t("Signing in to your account..."),cancellable:!0},(async(i,o)=>{if(r||n)return await this.createSessionWithoutLocalServer(e,t?.label,o);try{return await this.createSessionWithLocalServer(e,t?.label,o)}catch(r){if(this._logger.error(`[${e.scopeStr}] Error creating session: ${r}`),"Error listening to server"===r.message||"Closed"===r.message||"Timeout waiting for port"===r.message)return this.createSessionWithoutLocalServer(e,t?.label,o);throw r}}))}async createSessionWithLocalServer(e,t,r){this._logger.trace(`[${e.scopeStr}] Starting login flow with local server`);const n=(0,h.generateCodeVerifier)(),i=await(0,h.generateCodeChallenge)(n),o=new URLSearchParams({response_type:"code",response_mode:"query",client_id:e.clientId,redirect_uri:v,scope:e.scopesToSend,code_challenge_method:"S256",code_challenge:i});t?o.set("login_hint",t):o.set("prompt","select_account");const s=new URL(`${e.tenant}/oauth2/v2.0/authorize?${o.toString()}`,this._env.activeDirectoryEndpointUrl).toString(),a=new f.LoopbackAuthServer(u.join(__dirname,"../media"),s);let l;await a.start();try{c.env.openExternal(c.Uri.parse(`http://127.0.0.1:${a.port}/signin?nonce=${encodeURIComponent(a.nonce)}`));const{code:e}=await(0,d.raceCancellationAndTimeoutError)(a.waitForOAuthResponse(),r,3e5);l=e}finally{setTimeout((()=>{a.stop()}),5e3)}const p=await this.exchangeCodeForSession(l,n,e);return this._logger.trace(`[${e.scopeStr}] '${p.id}' Sending change event for added session`),this._sessionChangeEmitter.fire({added:[p],removed:[],changed:[]}),this._logger.info(`[${e.scopeStr}] '${p.id}' session successfully created!`),p}async createSessionWithoutLocalServer(e,t,r){this._logger.trace(`[${e.scopeStr}] Starting login flow without local server`);let n=await c.env.asExternalUri(c.Uri.parse(`${c.env.uriScheme}://vscode.microsoft-authentication`));const i=(0,h.generateCodeVerifier)(),o=new URLSearchParams(n.query);o.set("nonce",encodeURIComponent(i)),n=n.with({query:o.toString()});const s=encodeURIComponent(n.toString(!0)),a=(0,h.generateCodeVerifier)(),u=await(0,h.generateCodeChallenge)(a),f=new URL(`${e.tenant}/oauth2/v2.0/authorize`,this._env.activeDirectoryEndpointUrl),p=new URLSearchParams({response_type:"code",client_id:encodeURIComponent(e.clientId),response_mode:"query",redirect_uri:v,state:s,scope:e.scopesToSend,code_challenge_method:"S256",code_challenge:u});t?p.append("login_hint",t):p.append("prompt","select_account"),f.search=p.toString();const g=c.Uri.parse(f.toString());c.env.openExternal(g);const m=this._pendingNonces.get(e.scopeStr)||[];this._pendingNonces.set(e.scopeStr,[...m,i]);let y,w=this._codeExchangePromises.get(e.scopeStr);return w||((0,l.isSupportedEnvironment)(n)?w=this.handleCodeResponse(e):(y=c.window.createInputBox(),w=this.handleCodeInputBox(y,a,e)),this._codeExchangePromises.set(e.scopeStr,w)),this._codeVerfifiers.set(i,a),await(0,d.raceCancellationAndTimeoutError)(w,r,3e5).finally((()=>{this._pendingNonces.delete(e.scopeStr),this._codeExchangePromises.delete(e.scopeStr),this._codeVerfifiers.delete(i),y?.dispose()}))}async removeSessionById(e,t=!0){const r=this._tokens.findIndex((t=>t.sessionId===e));if(-1===r)return this._logger.warn(`'${e}' Session not found to remove`),Promise.resolve(void 0);const n=this._tokens.splice(r,1)[0];return this._logger.trace(`[${n.scope}] '${e}' Queued removing session`),this._sequencer.queue(n.scope,(()=>this.removeSessionByIToken(n,t)))}async clearSessions(){this._logger.trace("Logging out of all sessions"),this._tokens=[],await this._tokenStorage.deleteAll((e=>this.sessionMatchesEndpoint(e))),this._refreshTimeouts.forEach((e=>{clearTimeout(e)})),this._refreshTimeouts.clear(),this._logger.trace("All sessions logged out")}async removeSessionByIToken(e,t=!0){this._logger.info(`[${e.scope}] '${e.sessionId}' Logging out of session`),this.removeSessionTimeout(e.sessionId),t&&await this._tokenStorage.delete(e.sessionId);const r=this._tokens.findIndex((t=>t.sessionId===e.sessionId));-1!==r&&this._tokens.splice(r,1);const n=this.convertToSessionSync(e);return this._logger.trace(`[${e.scope}] '${e.sessionId}' Sending change event for session that was removed`),this._sessionChangeEmitter.fire({added:[],removed:[n],changed:[]}),this._logger.info(`[${e.scope}] '${e.sessionId}' Logged out of session successfully!`),n}setSessionTimeout(e,r,n,i){this._logger.trace(`[${n.scopeStr}] '${e}' Setting refresh timeout for ${i} milliseconds`),this.removeSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout((async()=>{try{const t=await this.refreshToken(r,n,e);this._logger.trace(`[${n.scopeStr}] '${e}' Sending change event for session that was refreshed`),this._sessionChangeEmitter.fire({added:[],removed:[],changed:[this.convertToSessionSync(t)]}),this._logger.trace(`[${n.scopeStr}] '${e}' refresh timeout complete`)}catch(r){r.message!==t.REFRESH_NETWORK_FAILURE&&(c.window.showErrorMessage(c.l10n.t("You have been signed out because reading stored authentication information failed.")),await this.removeSessionById(e))}}),i))}removeSessionTimeout(e){const t=this._refreshTimeouts.get(e);t&&(clearTimeout(t),this._refreshTimeouts.delete(e))}convertToTokenSync(e,t,r){let n;this._logger.trace(`[${t.scopeStr}] '${r??"new"}' Attempting to parse token response.`);try{e.id_token?n=JSON.parse((0,p.base64Decode)(e.id_token.split(".")[1])):(this._logger.warn(`[${t.scopeStr}] '${r??"new"}' Attempting to parse access_token instead since no id_token was included in the response.`),n=JSON.parse((0,p.base64Decode)(e.access_token.split(".")[1])))}catch(e){throw e}const i=`${n.tid}/${n.oid??n.altsecid??""+n.ipd}`,o=r||`${i}/${(0,h.randomUUID)()}`;return this._logger.trace(`[${t.scopeStr}] '${o}' Token response parsed successfully.`),{expiresIn:e.expires_in,expiresAt:e.expires_in?Date.now()+1e3*e.expires_in:void 0,accessToken:e.access_token,idToken:e.id_token,refreshToken:e.refresh_token,scope:t.scopeStr,sessionId:o,account:{label:n.preferred_username??n.email??n.unique_name??"user@example.com",id:i,type:"9188040d-6c67-4c5b-b112-36a304b66dad"===n.tid||"f8cdef31-a31e-4b4a-93e4-5f571e91255a"===n.tid?"msa":"aad"}}}convertToSessionSync(e){return{id:e.sessionId,accessToken:e.accessToken,idToken:e.idToken,account:e.account,scopes:e.scope.split(" ")}}async convertToSession(e,t){if(e.accessToken&&(!e.expiresAt||e.expiresAt>Date.now()))return this._logger.trace(`[${t.scopeStr}] '${e.sessionId}' Token available from cache${e.expiresAt?`, expires in ${e.expiresAt-Date.now()} milliseconds`:""}.`),{id:e.sessionId,accessToken:e.accessToken,idToken:e.idToken,account:e.account,scopes:t.originalScopes??t.scopes};try{this._logger.trace(`[${t.scopeStr}] '${e.sessionId}' Token expired or unavailable, trying refresh`);const r=await this.refreshToken(e.refreshToken,t,e.sessionId);if(r.accessToken)return{id:e.sessionId,accessToken:r.accessToken,idToken:r.idToken,account:e.account,scopes:t.originalScopes??t.scopes};throw new Error}catch(e){throw new Error("Unavailable due to network problems")}}refreshToken(e,t,r){return this._logger.trace(`[${t.scopeStr}] '${r??"new"}' Queued refreshing token`),this._sequencer.queue(t.scopeStr,(()=>this.doRefreshToken(e,t,r)))}async doRefreshToken(e,r,n){this._logger.trace(`[${r.scopeStr}] '${n??"new"}' Refreshing token`);const i=new URLSearchParams({refresh_token:e,client_id:r.clientId,grant_type:"refresh_token",scope:r.scopesToSend}).toString();try{const e=await this.fetchTokenResponse(i,r),t=this.convertToTokenSync(e,r,n);return t.expiresIn&&this.setSessionTimeout(t.sessionId,t.refreshToken,r,t.expiresIn*C.REFRESH_TIMEOUT_MODIFIER),this.setToken(t,r),this._logger.trace(`[${r.scopeStr}] '${t.sessionId}' Token refresh success`),t}catch(i){if(i.message===t.REFRESH_NETWORK_FAILURE)throw n&&this.setSessionTimeout(n,e,r,C.POLLING_CONSTANT),i;throw this._logger.error(`[${r.scopeStr}] '${n??"new"}' Refreshing token failed: ${i.message}`),i}}getClientId(e){return e.reduce(((e,t)=>t.startsWith("VSCODE_CLIENT_ID:")?t.split("VSCODE_CLIENT_ID:")[1]:e),void 0)??w}getTenantId(e){return e.reduce(((e,t)=>t.startsWith("VSCODE_TENANT:")?t.split("VSCODE_TENANT:")[1]:e),void 0)??"organizations"}async handleCodeResponse(e){let t;return new Promise(((r,n)=>{t=this._uriHandler.event((async t=>{try{const n=new URLSearchParams(t.query);let i=n.get("code"),o=n.get("nonce");if(Array.isArray(i)&&(i=i[0]),!i)throw new Error("No code included in query");if(Array.isArray(o)&&(o=o[0]),!o)throw new Error("No nonce included in query");const s=this._pendingNonces.get(e.scopeStr)||[];if(!s.includes(o)&&!s.includes(decodeURIComponent(o)))throw new Error("Nonce does not match.");const a=this._codeVerfifiers.get(o)??this._codeVerfifiers.get(decodeURIComponent(o));if(!a)throw new Error("No available code verifier");const c=await this.exchangeCodeForSession(i,a,e);this._sessionChangeEmitter.fire({added:[c],removed:[],changed:[]}),this._logger.info(`[${e.scopeStr}] '${c.id}' session successfully created!`),r(c)}catch(e){n(e)}}))})).then((e=>(t.dispose(),e))).catch((e=>{throw t.dispose(),e}))}async handleCodeInputBox(e,t,r){return this._logger.trace(`[${r.scopeStr}] Starting login flow with input box`),e.ignoreFocusOut=!0,e.title=c.l10n.t("Microsoft Authentication"),e.prompt=c.l10n.t("Provide the authorization code to complete the sign in flow."),e.placeholder=c.l10n.t("Paste authorization code here..."),new Promise(((n,i)=>{e.show(),e.onDidAccept((async()=>{const i=e.value;if(i){e.dispose();const o=await this.exchangeCodeForSession(i,t,r);this._logger.trace(`[${r.scopeStr}] '${o.id}' sending session changed event because session was added.`),this._sessionChangeEmitter.fire({added:[o],removed:[],changed:[]}),this._logger.trace(`[${r.scopeStr}] '${o.id}' session successfully created!`),n(o)}})),e.onDidHide((()=>{e.value||(e.dispose(),i("Cancelled"))}))}))}async exchangeCodeForSession(e,t,r){let n;this._logger.trace(`[${r.scopeStr}] Exchanging login code for session`);try{const i=new URLSearchParams({grant_type:"authorization_code",code:e,client_id:r.clientId,scope:r.scopesToSend,code_verifier:t,redirect_uri:v}).toString(),o=await this.fetchTokenResponse(i,r);this._logger.trace(`[${r.scopeStr}] Exchanging code for token succeeded!`),n=this.convertToTokenSync(o,r)}catch(e){throw this._logger.error(`[${r.scopeStr}] Error exchanging code for token: ${e}`),e}return n.expiresIn&&this.setSessionTimeout(n.sessionId,n.refreshToken,r,n.expiresIn*C.REFRESH_TIMEOUT_MODIFIER),this.setToken(n,r),this._logger.trace(`[${r.scopeStr}] '${n.sessionId}' Exchanging login code for session succeeded!`),await this.convertToSession(n,r)}async fetchTokenResponse(e,r){let n;if(this._env.activeDirectoryEndpointUrl!==y)n=this._env.activeDirectoryEndpointUrl;else{const e=await c.commands.executeCommand("workbench.getCodeExchangeProxyEndpoints");n=e?.microsoft||this._env.activeDirectoryEndpointUrl}const i=new URL(`${r.tenant}/oauth2/v2.0/token`,n);let o=0;for(;o<=3;){let t,n;o++;try{t=await(0,g.default)(i.toString(),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e})}catch(e){n=e.message??e}if(t&&!(t.status>499)){if(!t.ok)throw new Error(await t.text());return await t.json()}if(o>3){this._logger.error(`[${r.scopeStr}] Fetching token failed: ${t?await t.text():n}`);break}await new Promise((e=>setTimeout(e,5*o*o*1e3)))}throw new Error(t.REFRESH_NETWORK_FAILURE)}setToken(e,t){this._logger.trace(`[${t.scopeStr}] '${e.sessionId}' Setting token`);const r=this._tokens.findIndex((t=>t.sessionId===e.sessionId));r>-1?this._tokens.splice(r,1,e):this._tokens.push(e),this.storeToken(e,t)}async storeToken(e,t){if(!c.window.state.focused)return this._pendingTokensToStore.has(e.sessionId)?this._logger.trace(`[${t.scopeStr}] '${e.sessionId}' Window is not focused, replacing token to be stored`):this._logger.trace(`[${t.scopeStr}] '${e.sessionId}' Window is not focused, pending storage of token`),void this._pendingTokensToStore.set(e.sessionId,e);await this._tokenStorage.store(e.sessionId,{id:e.sessionId,refreshToken:e.refreshToken,scope:e.scope,account:e.account,endpoint:this._env.activeDirectoryEndpointUrl}),this._logger.trace(`[${t.scopeStr}] '${e.sessionId}' Stored token`)}async storePendingTokens(){if(0===this._pendingTokensToStore.size)return void this._logger.trace("No pending tokens to store");const e=[...this._pendingTokensToStore.values()];this._pendingTokensToStore.clear(),this._logger.trace(`Storing ${e.length} pending tokens...`),await Promise.allSettled(e.map((async e=>{this._logger.trace(`[${e.scope}] '${e.sessionId}' Storing pending token`),await this._tokenStorage.store(e.sessionId,{id:e.sessionId,refreshToken:e.refreshToken,scope:e.scope,account:e.account,endpoint:this._env.activeDirectoryEndpointUrl}),this._logger.trace(`[${e.scope}] '${e.sessionId}' Stored pending token`)}))),this._logger.trace("Done storing pending tokens")}async checkForUpdates(e){for(const r of e.added){const n=await this._tokenStorage.get(r);if(n){if(this.sessionMatchesEndpoint(n)&&!this._tokens.some((e=>e.scope===n.scope&&e.sessionId===n.id))&&n.refreshToken)try{const e=n.scope.split(" "),t={scopes:e,scopeStr:n.scope,scopesToSend:e.filter((e=>!e.startsWith("VSCODE_"))).join(" "),clientId:this.getClientId(e),tenant:this.getTenantId(e)};this._logger.trace(`[${t.scopeStr}] '${n.id}' Session added in another window`);const r=await this.refreshToken(n.refreshToken,t,n.id);this._logger.trace(`[${t.scopeStr}] '${r.sessionId}' Sending change event for session that was added`),this._sessionChangeEmitter.fire({added:[this.convertToSessionSync(r)],removed:[],changed:[]}),this._logger.trace(`[${t.scopeStr}] '${r.sessionId}' Session added in another window added here`);continue}catch(e){e.message!==t.REFRESH_NETWORK_FAILURE&&(c.window.showErrorMessage(c.l10n.t("You have been signed out because reading stored authentication information failed.")),await this.removeSessionById(n.id));continue}}else this._logger.error("session not found that was apparently just added")}for(const{value:t}of e.removed)this._logger.trace(`[${t.scope}] '${t.id}' Session removed in another window`),this.sessionMatchesEndpoint(t)?(await this.removeSessionById(t.id,!1),this._logger.trace(`[${t.scope}] '${t.id}' Session removed in another window removed here`)):this._logger.trace(`[${t.scope}] '${t.id}' Session doesn't match endpoint. Skipping...`);for(const t of e.updated)this._pendingTokensToStore.delete(t)&&this._logger.trace(`'${t}' Cancelled pending token storage because token was updated in another window`)}sessionMatchesEndpoint(e){return e.endpoint||(e.endpoint=y),e.endpoint===this._env.activeDirectoryEndpointUrl}}t.AzureActiveDirectoryService=C,C.REFRESH_TIMEOUT_MODIFIER=2e3/3,C.POLLING_CONSTANT=18e5},3683:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),s=0;s<r.length;s++)"default"!==r[s]&&i(t,e,r[s]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.UriEventHandler=void 0;const a=s(r(1398));class c extends a.EventEmitter{constructor(){super(...arguments),this._disposable=a.window.registerUriHandler(this)}handleUri(e){this.fire(e)}dispose(){super.dispose(),this._disposable.dispose()}}t.UriEventHandler=c},2410:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BetterTokenStorage=void 0;const i=n(r(8377)),o=r(1398);t.BetterTokenStorage=class{constructor(e,t){this.keylistKey=e,this._operationInProgress=!1,this._tokensPromise=Promise.resolve(new Map),this._didChangeInOtherWindow=new o.EventEmitter,this.onDidChangeInOtherWindow=this._didChangeInOtherWindow.event,this._secretStorage=t.secrets,t.subscriptions.push(t.secrets.onDidChange((e=>this.handleSecretChange(e)))),this.initialize()}initialize(){this._operationInProgress=!0,this._tokensPromise=new Promise(((e,t)=>{this._secretStorage.get(this.keylistKey).then((t=>{if(!t)return void e(new Map);const r=JSON.parse(t).map((e=>new Promise(((t,r)=>{this._secretStorage.get(e).then((r=>{t({key:e,value:r})}),r)}))));Promise.allSettled(r).then((t=>{const r=new Map;t.forEach((e=>{if("fulfilled"===e.status&&e.value.value){const t=this.parseSecret(e.value.value);r.set(e.value.key,t)}else"rejected"===e.status?i.default.error(e.reason):i.default.error("Key was not found in SecretStorage.")})),e(r)}))}),(t=>{i.default.error(t),e(new Map)}))})),this._operationInProgress=!1}async get(e){return(await this.getTokens()).get(e)}async getAll(e){const t=await this.getTokens(),r=new Array;for(const[n,i]of t)e&&!e(i)||r.push(i);return r}async store(e,t){const r=await this.getTokens(),n=!r.has(e);r.set(e,t);const o=this.serializeSecret(t);this._operationInProgress=!0,this._tokensPromise=new Promise(((t,s)=>{const a=[this._secretStorage.store(e,o)];n&&a.push(this.updateKeyList(r)),Promise.allSettled(a).then((e=>{e.forEach((e=>{"rejected"===e.status&&i.default.error(e.reason)})),t(r)}))})),this._operationInProgress=!1}async delete(e){const t=await this.getTokens();t.has(e)&&(t.delete(e),this._operationInProgress=!0,this._tokensPromise=new Promise(((r,n)=>{Promise.allSettled([this._secretStorage.delete(e),this.updateKeyList(t)]).then((e=>{e.forEach((e=>{"rejected"===e.status&&i.default.error(e.reason)})),r(t)}))})),this._operationInProgress=!1)}async deleteAll(e){const t=await this.getTokens(),r=[];for(const[n,i]of t)e&&!e(i)||r.push(this.delete(n));await Promise.all(r)}async updateKeyList(e){const t=[];for(const[r]of e)t.push(r);const r=JSON.stringify(t);await this._secretStorage.store(this.keylistKey,r)}parseSecret(e){return JSON.parse(e)}serializeSecret(e){return JSON.stringify(e)}async getTokens(){let e;do{e=await this._tokensPromise}while(this._operationInProgress);return e}async handleSecretChange(e){const t=e.key;if(t===this.keylistKey)return;const r=await this.getTokens();this._operationInProgress=!0,this._tokensPromise=new Promise(((e,n)=>{this._secretStorage.get(t).then((e=>{if(!e){if(r.has(t)){const e=r.get(t);r.delete(t),this._didChangeInOtherWindow.fire({added:[],updated:[],removed:[{key:t,value:e}]})}return r}const n=this.parseSecret(e),i=r.get(t);return i?(e!==this.serializeSecret(i)&&(r.set(t,n),this._didChangeInOtherWindow.fire({added:[],updated:[t],removed:[]})),r):(r.set(t,n),this._didChangeInOtherWindow.fire({added:[t],updated:[],removed:[]}),r)}),(e=>(i.default.error(e),r))).then(e)})),this._operationInProgress=!1}}},3310:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScopedAccountAccess=void 0;const n=r(1398);class i{constructor(e,t=[]){this._accountAccessSecretStorage=e,this._onDidAccountAccessChangeEmitter=new n.EventEmitter,this.onDidAccountAccessChange=this._onDidAccountAccessChangeEmitter.event,this.value=new Array,this._disposable=n.Disposable.from(...t,this._onDidAccountAccessChangeEmitter,this._accountAccessSecretStorage.onDidChange((()=>this.update())))}static async create(e,t,r,n){const s=await o.create(e,t,r,n),a=new i(s,[s]);return await a.initialize(),a}dispose(){this._disposable.dispose()}async initialize(){await this.update()}isAllowedAccess(e){return this.value.includes(e.homeAccountId)}async setAllowedAccess(e,t){if(t){if(this.value.includes(e.homeAccountId))return;await this._accountAccessSecretStorage.store([...this.value,e.homeAccountId])}else await this._accountAccessSecretStorage.store(this.value.filter((t=>t!==e.homeAccountId)))}async update(){const e=new Set(this.value),t=await this._accountAccessSecretStorage.get();this.value=t??[],e.size===this.value.length&&this.value.every((t=>e.has(t)))||this._onDidAccountAccessChangeEmitter.fire()}}t.ScopedAccountAccess=i;class o{constructor(e,t,r,i){this._secretStorage=e,this._cloudName=t,this._logger=r,this._migrations=i,this._onDidChangeEmitter=new n.EventEmitter,this.onDidChange=this._onDidChangeEmitter.event,this._key=`accounts-${this._cloudName}`,this._disposable=n.Disposable.from(this._onDidChangeEmitter,this._secretStorage.onDidChange((e=>{e.key===this._key&&this._onDidChangeEmitter.fire()})))}static async create(e,t,r,n){const i=new o(e,t,r,n);return await i.initialize(),i}async initialize(){if(this._migrations&&!await this.get())try{const e=new Set;for(const{clientId:t,authority:r}of this._migrations){const n=`accounts-${this._cloudName}-${t}-${r}`,i=await this._secretStorage.get(n);i&&JSON.parse(i).forEach((t=>e.add(t)))}e.size>0&&await this.store(Array.from(e))}catch(e){this._logger.error(`Failed to migrate account access secret storage: ${e}`)}}async get(){const e=await this._secretStorage.get(this._key);if(e)return JSON.parse(e)}store(e){return this._secretStorage.store(this._key,JSON.stringify(e))}delete(){return this._secretStorage.delete(this._key)}dispose(){this._disposable.dispose()}}},1619:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeferredPromise=t.IntervalTimer=t.SequencerByKey=void 0,t.raceCancellationAndTimeoutError=function(e,t,r){return function(e,t){return new Promise(((r,i)=>{const o=t.onCancellationRequested((()=>{o.dispose(),i(new n.CancellationError)}));e.then(r,i).finally((()=>o.dispose()))}))}(function(e,t){return new Promise(((r,i)=>{const o=setTimeout((()=>{i(new n.CancellationError)}),t);e.then(r,i).finally((()=>clearTimeout(o)))}))}(e,r),t)},t.toPromise=function(e){return new Promise((t=>function(e){return(t,r=null,n)=>{let i,o=!1;return i=e((e=>{if(!o)return i?i.dispose():o=!0,t.call(r,e)}),null,n),o&&i.dispose(),i}}(e)(t)))};const n=r(1398);t.SequencerByKey=class{constructor(){this.promiseMap=new Map}queue(e,t){const r=(this.promiseMap.get(e)??Promise.resolve()).catch((()=>{})).then(t).finally((()=>{this.promiseMap.get(e)===r&&this.promiseMap.delete(e)}));return this.promiseMap.set(e,r),r}};class i extends n.Disposable{constructor(){super((()=>this.cancel())),this._token=-1}cancel(){-1!==this._token&&(clearInterval(this._token),this._token=-1)}cancelAndSet(e,t){this.cancel(),this._token=setInterval((()=>{e()}),t)}}t.IntervalTimer=i,t.DeferredPromise=class{get isRejected(){return 1===this.outcome?.outcome}get isResolved(){return 0===this.outcome?.outcome}get isSettled(){return!!this.outcome}get value(){return 0===this.outcome?.outcome?this.outcome?.value:void 0}constructor(){this.p=new Promise(((e,t)=>{this.completeCallback=e,this.errorCallback=t}))}complete(e){return new Promise((t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()}))}error(e){return new Promise((t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()}))}cancel(){return this.error(new n.CancellationError)}}},3518:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecretStorageCachePlugin=void 0;const n=r(1398);t.SecretStorageCachePlugin=class{constructor(e,t){this._secretStorage=e,this._key=t,this._onDidChange=new n.EventEmitter,this.onDidChange=this._onDidChange.event,this._disposable=n.Disposable.from(this._onDidChange,this._registerChangeHandler())}_registerChangeHandler(){return this._secretStorage.onDidChange((e=>{e.key===this._key&&this._onDidChange.fire()}))}async beforeCacheAccess(e){const t=await this._secretStorage.get(this._key);this._value=t,t&&e.tokenCache.deserialize(t)}async afterCacheAccess(e){if(e.cacheHasChanged){const t=e.tokenCache.serialize();t!==this._value&&await this._secretStorage.store(this._key,t)}}dispose(){this._disposable.dispose()}}},8016:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupportedClient=function(e){return r.includes(e.scheme)||/(?:^|\.)vscode\.dev$/.test(e.authority)||/(?:^|\.)github\.dev$/.test(e.authority)||/^localhost:\d+$/.test(e.authority)||/^127\.0\.0\.1:\d+$/.test(e.authority)};const r=["vscode","vscode-insiders","vscode-wsl","vscode-exploration"]},4539:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventBufferer=void 0,t.EventBufferer=class{constructor(){this.data=[]}wrapEvent(e,t,r){return(n,i,o)=>e((e=>{const o=this.data[this.data.length-1];if(!t)return void(o?o.buffers.push((()=>n.call(i,e))):n.call(i,e));const s=o;s?(s.items??(s.items=[]),s.items.push(e),0===s.buffers.length&&o.buffers.push((()=>{s.reducedResult??(s.reducedResult=r?s.items.reduce(t,r):s.items.reduce(t)),n.call(i,s.reducedResult)}))):n.call(i,t(r,e))}),void 0,o)}bufferEvents(e){const t={buffers:new Array};this.data.push(t);const r=e();return this.data.pop(),t.buffers.forEach((e=>e())),r}async bufferEventsAsync(e){const t={buffers:new Array};this.data.push(t);try{return await e()}finally{this.data.pop(),t.buffers.forEach((e=>e()))}}}},5803:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createExperimentationService=async function(e,t,r){const i=e.extension.id,o=e.extension.packageJSON.version,s=(0,n.getExperimentationService)(i,o,r?n.TargetPopulation.Insiders:n.TargetPopulation.Public,t,e.globalState);return await s.initializePromise,await s.initialFetch,s};const n=r(1566)},5541:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsalLoggerOptions=void 0;const n=r(341),i=r(1398);t.MsalLoggerOptions=class{constructor(e,t){this._output=e,this._telemtryReporter=t,this.piiLoggingEnabled=!1}get logLevel(){return this._toMsalLogLevel(i.env.logLevel)}loggerCallback(e,t,r){if(r)this._output.debug("Skipped logging message because it may contain PII");else switch(e){case n.LogLevel.Error:return this._output.error(t),void this._telemtryReporter.sendTelemetryErrorEvent(t);case n.LogLevel.Warning:return void this._output.warn(t);case n.LogLevel.Info:return void this._output.debug(t);case n.LogLevel.Verbose:return void this._output.trace(t);case n.LogLevel.Trace:return;default:return void this._output.debug(t)}}_toMsalLogLevel(e){switch(e){case i.LogLevel.Trace:return n.LogLevel.Trace;case i.LogLevel.Debug:return n.LogLevel.Verbose;case i.LogLevel.Info:return n.LogLevel.Info;case i.LogLevel.Warning:return n.LogLevel.Warning;case i.LogLevel.Error:return n.LogLevel.Error;default:return n.LogLevel.Info}}}},583:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UriHandlerLoopbackClient=void 0;const n=r(1398),i=r(1619),o=r(8016);t.UriHandlerLoopbackClient=class{constructor(e,t,r){this._uriHandler=e,this._redirectUri=t,this._logger=r}async listenForAuthCode(){await(this._responseDeferred?.cancel()),this._responseDeferred=new i.DeferredPromise;const e=await this._responseDeferred.p;if(this._responseDeferred=void 0,e)return e;throw new Error("No valid response received for authorization code.")}getRedirectUri(){return this._redirectUri}closeServer(){}async openBrowser(e){const t=await n.env.asExternalUri(n.Uri.parse(`${n.env.uriScheme}://vscode.microsoft-authentication`));(0,o.isSupportedClient)(t)?this._getCodeResponseFromUriHandler():this._getCodeResponseFromQuickPick();const r=n.Uri.parse(e+`&state=${encodeURI(t.toString(!0))}`);await n.env.openExternal(r)}async _getCodeResponseFromUriHandler(){if(!this._responseDeferred)throw new Error("No listener for auth code");const e=await(0,i.toPromise)(this._uriHandler.event);this._logger.debug(`Received URL event. Authority: ${e.authority}`);const t=new URL(e.toString(!0));this._responseDeferred?.complete({code:t.searchParams.get("code")??void 0,state:t.searchParams.get("state")??void 0,error:t.searchParams.get("error")??void 0,error_description:t.searchParams.get("error_description")??void 0,error_uri:t.searchParams.get("error_uri")??void 0})}async _getCodeResponseFromQuickPick(){if(!this._responseDeferred)throw new Error("No listener for auth code");const e=n.window.createInputBox();e.ignoreFocusOut=!0,e.title=n.l10n.t("Microsoft Authentication"),e.prompt=n.l10n.t("Provide the authorization code to complete the sign in flow."),e.placeholder=n.l10n.t("Paste authorization code here..."),e.show();const t=await new Promise((t=>{let r;const i=n.Disposable.from(e,e.onDidAccept((async()=>{if(!e.value)return void(e.validationMessage=n.l10n.t("Authorization code is required."));const i=e.value;r=i,t(i),e.hide()})),e.onDidChangeValue((()=>{e.validationMessage=void 0})),e.onDidHide((()=>{i.dispose(),r||t(void 0)})));Promise.allSettled([this._responseDeferred?.p]).then((()=>i.dispose()))}));if(!this._responseDeferred.isSettled)return t?(this._logger.debug("Received auth code from quick pick"),void this._responseDeferred.complete({code:t,state:void 0,error:void 0,error_description:void 0,error_uri:void 0})):void this._responseDeferred.complete({code:void 0,state:void 0,error:"User cancelled",error_description:"User cancelled",error_uri:void 0})}}},1883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScopeData=void 0;const r=["openid","email","profile","offline_access"];t.ScopeData=class{constructor(e=[]){this.originalScopes=e;const t=[...e];t.sort(),this.allScopes=t,this.scopeStr=t.join(" "),this.scopesToSend=this.getScopesToSend(t),this.clientId=this.getClientId(this.allScopes),this.tenant=this.getTenant(this.allScopes),this.tenantId=this.getTenantId(this.tenant)}getClientId(e){return e.reduce(((e,t)=>t.startsWith("VSCODE_CLIENT_ID:")?t.split("VSCODE_CLIENT_ID:")[1]:e),void 0)??"aebc6443-996d-45c2-90f0-388ff96faa56"}getTenant(e){return e.reduce(((e,t)=>t.startsWith("VSCODE_TENANT:")?t.split("VSCODE_TENANT:")[1]:e),void 0)??"organizations"}getTenantId(e){switch(e){case"organizations":case"common":case"consumers":return;default:return this.tenant}}getScopesToSend(e){const t=e.filter((e=>!e.startsWith("VSCODE_"))),n=new Set(t);for(const e of r)n.delete(e);return n.size||t.push("User.Read"),t}}},2417:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MicrosoftSovereignCloudAuthenticationTelemetryReporter=t.MicrosoftAuthenticationTelemetryReporter=void 0;const i=n(r(1170));class o{constructor(e){this.sharedProperties={},this._telemetryReporter=new i.default(e)}get telemetryReporter(){return this._telemetryReporter}setSharedProperty(e,t){this.sharedProperties[e]=t}postEvent(e,t){const r={...this.sharedProperties,...Object.fromEntries(t)};this._telemetryReporter.sendTelemetryEvent(e,r)}sendLoginEvent(e){this._telemetryReporter.sendTelemetryEvent("login",{scopes:JSON.stringify(this._scrubGuids(e))})}sendLoginFailedEvent(){this._telemetryReporter.sendTelemetryEvent("loginFailed")}sendLogoutEvent(){this._telemetryReporter.sendTelemetryEvent("logout")}sendLogoutFailedEvent(){this._telemetryReporter.sendTelemetryEvent("logoutFailed")}sendTelemetryErrorEvent(e){const t=e instanceof Error?e.message:String(e),r=e instanceof Error?e.stack:void 0,n=e instanceof Error?e.name:void 0;this._telemetryReporter.sendTelemetryErrorEvent("msalError",{errorMessage:t,errorStack:r,errorName:n})}sendAccountEvent(e,t){this._telemetryReporter.sendTelemetryEvent("account",{scopes:JSON.stringify(this._scrubGuids(e)),accountType:t})}_scrubGuids(e){return e.map((e=>e.replace(/[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/i,"{guid}")))}}t.MicrosoftAuthenticationTelemetryReporter=o,t.MicrosoftSovereignCloudAuthenticationTelemetryReporter=class extends o{sendLoginEvent(e){this._telemetryReporter.sendTelemetryEvent("loginMicrosoftSovereignCloud",{scopes:JSON.stringify(this._scrubGuids(e))})}sendLoginFailedEvent(){this._telemetryReporter.sendTelemetryEvent("loginMicrosoftSovereignCloudFailed")}sendLogoutEvent(){this._telemetryReporter.sendTelemetryEvent("logoutMicrosoftSovereignCloud")}sendLogoutFailedEvent(){this._telemetryReporter.sendTelemetryEvent("logoutMicrosoftSovereignCloudFailed")}}},9529:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupportedEnvironment=function(e){return n.env.uiKind===n.UIKind.Desktop||(!!function(e){if(!/^https?$/i.test(e.scheme))return!1;const t=e.authority.split(":")[0];return i.indexOf(t)>=0}(e)||"https"===e.scheme&&(/(?:^|\.)vscode\.dev$/.test(e.authority)||/(?:^|\.)github\.dev$/.test(e.authority)||/(?:^|\.)github\.localhost$/.test(e.authority)))};const n=r(1398),i=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"]},5951:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomUUID=function(){return crypto.randomUUID()},t.generateCodeVerifier=function(){const e=new Uint32Array(28);return crypto.getRandomValues(e),Array.from(e,i).join("")},t.generateCodeChallenge=async function(e){return function(e){let t="";const r=new Uint8Array(e),i=r.byteLength;for(let e=0;e<i;e++)t+=String.fromCharCode(r[e]);return(0,n.base64Encode)(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(await function(e){const t=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-256",t)}(e))};const n=r(2866);function i(e){return("0"+e.toString(16)).slice(-2)}},5256:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),s=0;s<r.length;s++)"default"!==r[s]&&i(t,e,r[s]);return o(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=async function(e){const t=new h.MicrosoftAuthenticationTelemetryReporter(e.extension.packageJSON.aiKey),r=await(0,d.createExperimentationService)(e,t,"vscode"!==c.env.uriScheme);g=p(r);const n=c.workspace.getConfiguration("microsoft-authentication").get("clientIdVersion","v1");e.subscriptions.push(c.workspace.onDidChangeConfiguration((async e=>{if(!e.affectsConfiguration("microsoft-authentication"))return;if(g===p(r)&&n===c.workspace.getConfiguration("microsoft-authentication").get("clientIdVersion","v1"))return;const t=c.l10n.t("Reload");await c.window.showInformationMessage("Reload required",{modal:!0,detail:c.l10n.t("Microsoft Account configuration has been changed.")},t)===t&&c.commands.executeCommand("workbench.action.reloadWindow")}))),g&&"undefined"==typeof navigator?await l.activate(e,t):await u.activate(e,t.telemetryReporter)},t.deactivate=function(){g?l.deactivate():u.deactivate()};const c=r(1398),u=s(r(7773)),l=s(r(8428)),d=r(5803),h=r(2417),f=a(r(8377));function p(e){const t=c.workspace.getConfiguration("microsoft-authentication").inspect("implementation");if(void 0!==t?.workspaceFolderValue)return f.default.info(`Acquired MSAL enablement value from 'workspaceFolderValue'. Value: ${t.workspaceFolderValue}`),"msal"===t.workspaceFolderValue;if(void 0!==t?.workspaceValue)return f.default.info(`Acquired MSAL enablement value from 'workspaceValue'. Value: ${t.workspaceValue}`),"msal"===t.workspaceValue;if(void 0!==t?.globalValue)return f.default.info(`Acquired MSAL enablement value from 'globalValue'. Value: ${t.globalValue}`),"msal"===t.globalValue;const r=e.getTreatmentVariable("vscode","microsoft.useMsal");return void 0!==r?(f.default.info(`Acquired MSAL enablement value from 'exp'. Value: ${r}`),r):(f.default.info("Acquired MSAL enablement value from default. Value: false"),!0)}let g},7773:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),s=0;s<r.length;s++)"default"!==r[s]&&i(t,e,r[s]);return o(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=async function(e,t){e.globalState.update("msalMigration",!1);const r=new h.UriEventHandler;e.subscriptions.push(r);const n=new d.BetterTokenStorage("microsoft.login.keylist",e),i=new l.AzureActiveDirectoryService(f.default,e,r,n,t,u.Environment.AzureCloud);await i.initialize(),e.subscriptions.push(c.authentication.registerAuthenticationProvider("microsoft","Microsoft",{onDidChangeSessions:i.onDidChangeSessions,getSessions:(e,t)=>i.getSessions(e,t?.account),createSession:async(e,r)=>{try{return t.sendTelemetryEvent("login",{scopes:JSON.stringify(e.map((e=>e.replace(/[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/i,"{guid}"))))}),await i.createSession(e,r?.account)}catch(e){throw t.sendTelemetryEvent("loginFailed"),e}},removeSession:async e=>{try{t.sendTelemetryEvent("logout"),await i.removeSessionById(e)}catch(e){t.sendTelemetryEvent("logoutFailed")}}},{supportsMultipleAccounts:!0}));let o=await p(e,t,r,n);e.subscriptions.push(c.workspace.onDidChangeConfiguration((async i=>{i.affectsConfiguration("microsoft-sovereign-cloud")&&(o?.dispose(),o=await p(e,t,r,n))})))},t.deactivate=function(){};const c=s(r(1398)),u=r(8197),l=r(8447),d=r(2410),h=r(3683),f=a(r(8377));async function p(e,t,r,n){const i=c.workspace.getConfiguration("microsoft-sovereign-cloud").get("environment");let o;if(!i)return;if("custom"===i){const e=c.workspace.getConfiguration("microsoft-sovereign-cloud").get("customEnvironment");if(!e)return void(await c.window.showErrorMessage(c.l10n.t("You must also specify a custom environment in order to use the custom environment auth provider."),c.l10n.t("Open settings"))&&await c.commands.executeCommand("workbench.action.openSettingsJson","microsoft-sovereign-cloud.customEnvironment"));try{u.Environment.add(e)}catch(e){return void(await c.window.showErrorMessage(c.l10n.t("Error validating custom environment setting: {0}",e.message),c.l10n.t("Open settings"))&&await c.commands.executeCommand("workbench.action.openSettings","microsoft-sovereign-cloud.customEnvironment"))}o=e.name}else o=i;const s=u.Environment.get(o);if(!s)return void await c.window.showErrorMessage(c.l10n.t("The environment `{0}` is not a valid environment.",o),c.l10n.t("Open settings"));const a=new l.AzureActiveDirectoryService(c.window.createOutputChannel(c.l10n.t("Microsoft Sovereign Cloud Authentication"),{log:!0}),e,r,n,t,s);await a.initialize();const d=c.authentication.registerAuthenticationProvider("microsoft-sovereign-cloud",o,{onDidChangeSessions:a.onDidChangeSessions,getSessions:e=>a.getSessions(e),createSession:async e=>{try{return t.sendTelemetryEvent("loginMicrosoftSovereignCloud",{scopes:JSON.stringify(e.map((e=>e.replace(/[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/i,"{guid}"))))}),await a.createSession(e)}catch(e){throw t.sendTelemetryEvent("loginMicrosoftSovereignCloudFailed"),e}},removeSession:async e=>{try{t.sendTelemetryEvent("logoutMicrosoftSovereignCloud"),await a.removeSessionById(e)}catch(e){t.sendTelemetryEvent("logoutMicrosoftSovereignCloudFailed")}}},{supportsMultipleAccounts:!0});return e.subscriptions.push(d),d}},8428:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=async function(e,t){const r=new a.UriEventHandler;e.subscriptions.push(r);const n=await s.MsalAuthProvider.create(e,t,o.default,r);e.subscriptions.push(c.authentication.registerAuthenticationProvider("microsoft","Microsoft",n,{supportsMultipleAccounts:!0}));let i=await l(e,r);e.subscriptions.push(c.workspace.onDidChangeConfiguration((async t=>{t.affectsConfiguration("microsoft-sovereign-cloud")&&(i?.dispose(),i=await l(e,r))})))},t.deactivate=function(){};const i=r(8197),o=n(r(8377)),s=r(2583),a=r(3683),c=r(1398),u=r(2417);async function l(e,t){const r=c.workspace.getConfiguration("microsoft-sovereign-cloud").get("environment");let n;if(!r)return;if("custom"===r){const e=c.workspace.getConfiguration("microsoft-sovereign-cloud").get("customEnvironment");if(!e)return void(await c.window.showErrorMessage(c.l10n.t("You must also specify a custom environment in order to use the custom environment auth provider."),c.l10n.t("Open settings"))&&await c.commands.executeCommand("workbench.action.openSettingsJson","microsoft-sovereign-cloud.customEnvironment"));try{i.Environment.add(e)}catch(e){return void(await c.window.showErrorMessage(c.l10n.t("Error validating custom environment setting: {0}",e.message),c.l10n.t("Open settings"))&&await c.commands.executeCommand("workbench.action.openSettings","microsoft-sovereign-cloud.customEnvironment"))}n=e.name}else n=r;const o=i.Environment.get(n);if(!o)return void await c.window.showErrorMessage(c.l10n.t("The environment `{0}` is not a valid environment.",n),c.l10n.t("Open settings"));const a=await s.MsalAuthProvider.create(e,new u.MicrosoftSovereignCloudAuthenticationTelemetryReporter(e.extension.packageJSON.aiKey),c.window.createOutputChannel(c.l10n.t("Microsoft Sovereign Cloud Authentication"),{log:!0}),t,o),l=c.authentication.registerAuthenticationProvider("microsoft-sovereign-cloud",n,a,{supportsMultipleAccounts:!0});return e.subscriptions.push(l),l}},8377:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),s=0;s<r.length;s++)"default"!==r[s]&&i(t,e,r[s]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0});const a=s(r(1398)),c=a.window.createOutputChannel(a.l10n.t("Microsoft Authentication"),{log:!0});t.default=c},2583:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsalAuthProvider=void 0;const n=r(341),i=r(1398),o=r(8197),s=r(3226),a=r(1883),c=r(4539),u=r(2410),l=r(3563);class d{constructor(e,t,r,n,s,a=o.Environment.AzureCloud){this._context=e,this._telemetryReporter=t,this._logger=r,this._uriHandler=n,this._publicClientManager=s,this._env=a,this._eventBufferer=new c.EventBufferer,this._onDidChangeSessionsEmitter=new i.EventEmitter,this.onDidChangeSessions=this._onDidChangeSessionsEmitter.event,this._disposables=e.subscriptions;const u=this._eventBufferer.wrapEvent(this._publicClientManager.onDidAccountsChange,((e,t)=>{if(!e)return t;const r={added:[...e.added??[],...t.added??[]],deleted:[...e.deleted??[],...t.deleted??[]],changed:[...e.changed??[],...t.changed??[]]};return{added:Array.from(new Map(r.added.map((e=>[e.username,e]))).values()),deleted:Array.from(new Map(r.deleted.map((e=>[e.username,e]))).values()),changed:Array.from(new Map(r.changed.map((e=>[e.username,e]))).values())}}),{added:new Array,deleted:new Array,changed:new Array})((e=>this._handleAccountChange(e)));this._disposables.push(this._onDidChangeSessionsEmitter,u)}static async create(e,t,r,n,i=o.Environment.AzureCloud){const a=await s.CachedPublicClientApplicationManager.create(e.secrets,r,t,i.name);e.subscriptions.push(a);const c=new d(e,t,r,n,a,i);return await c.initialize(),c}async _migrateSessions(){const e=new u.BetterTokenStorage("microsoft.login.keylist",this._context),t=await e.getAll((e=>(e.endpoint||(e.endpoint=o.Environment.AzureCloud.activeDirectoryEndpointUrl),e.endpoint===this._env.activeDirectoryEndpointUrl)));this._context.globalState.update("msalMigration",!0);const r=new Map;for(const e of t){const t=new a.ScopeData(e.scope.split(" ")),n=`${t.clientId}:${t.tenant}`;r.has(n)||r.set(n,{clientId:t.clientId,tenant:t.tenant,refreshTokens:[]}),r.get(n).refreshTokens.push(e.refreshToken)}for(const{clientId:e,refreshTokens:t}of r.values())await this._publicClientManager.getOrCreate(e,t)}async initialize(){this._context.globalState.get("msalMigration",!1)||await this._migrateSessions();for(const e of this._publicClientManager.getAll())for(const t of e.accounts){if(!t.idTokenClaims?.tid)continue;const e=t.idTokenClaims.tid,r="9188040d-6c67-4c5b-b112-36a304b66dad"===e||"f8cdef31-a31e-4b4a-93e4-5f571e91255a"===e?"msa":"aad";this._telemetryReporter.sendAccountEvent([],r)}}_handleAccountChange({added:e,changed:t,deleted:r}){this._logger.debug(`[_handleAccountChange] added: ${e.length}, changed: ${t.length}, deleted: ${r.length}`),this._onDidChangeSessionsEmitter.fire({added:e.map(this.sessionFromAccountInfo),changed:t.map(this.sessionFromAccountInfo),removed:r.map(this.sessionFromAccountInfo)})}async getSessions(e,t){const r=void 0===e,n=new a.ScopeData(e);if(this._logger.info("[getSessions]",r?"[all]":`[${n.scopeStr}]`,"starting"),r){const e=new Map;for(const t of this._publicClientManager.getAll())for(const r of t.accounts)e.has(r.homeAccountId)||e.set(r.homeAccountId,this.sessionFromAccountInfo(r));const t=Array.from(e.values());return this._logger.info("[getSessions] [all]",`returned ${t.length} session(s)`),t}const i=await this._publicClientManager.getOrCreate(n.clientId),o=await this.getAllSessionsForPca(i,n,t?.account);return this._logger.info(`[getSessions] [${n.scopeStr}] returned ${o.length} session(s)`),o}async createSession(e,t){const r=new a.ScopeData(e);this._logger.info("[createSession]",`[${r.scopeStr}]`,"starting");const o=await this._publicClientManager.getOrCreate(r.clientId);let s;const c=i.l10n.t("Yes"),u=i.l10n.t("No"),d=async e=>{if(void 0===s)return;const t=s?i.l10n.t("Having trouble logging in? Would you like to try a different way? ({0})",e):i.l10n.t("You have not yet finished authorizing this extension to use your Microsoft Account. Would you like to try a different way? ({0})",e);if(await i.window.showWarningMessage(t,c,u)!==c)throw new i.CancellationError},h=(0,l.getMsalFlows)({extensionHost:"undefined"==typeof navigator?this._context.extension.extensionKind===i.ExtensionKind.UI?2:1:0}),f=new URL(r.tenant,this._env.activeDirectoryEndpointUrl).toString();let p;for(const e of h){if(e!==h[0])try{await d(e.label)}finally{this._telemetryReporter.sendLoginFailedEvent()}try{const n=await e.trigger({cachedPca:o,authority:f,scopes:r.scopesToSend,loginHint:t.account?.label,windowHandle:i.window.nativeHandle?Buffer.from(i.window.nativeHandle):void 0,logger:this._logger,uriHandler:this._uriHandler}),s=this.sessionFromAuthenticationResult(n,r.originalScopes);return this._telemetryReporter.sendLoginEvent(s.scopes),this._logger.info("[createSession]",`[${r.scopeStr}]`,"returned session"),s}catch(e){if(p=e,e instanceof n.ServerError||e?.errorCode===n.ClientAuthErrorCodes.userCanceled)throw this._telemetryReporter.sendLoginFailedEvent(),e;e instanceof i.CancellationError&&(s=!0)}}throw this._telemetryReporter.sendLoginFailedEvent(),p??new Error("No auth flow succeeded")}async removeSession(e){this._logger.info("[removeSession]",e,"starting");const t=new Array;for(const r of this._publicClientManager.getAll()){const n=r.accounts;for(const i of n)i.homeAccountId===e&&(this._telemetryReporter.sendLogoutEvent(),t.push(r.removeAccount(i)),this._logger.info(`[removeSession] [${e}] [${r.clientId}] removing session...`))}if(!t.length)return void this._logger.info("[removeSession]",e,"session not found");const r=await Promise.allSettled(t);for(const t of r)"rejected"===t.status&&(this._telemetryReporter.sendLogoutFailedEvent(),this._logger.error("[removeSession]",e,"error removing session",t.reason));this._logger.info("[removeSession]",e,`attempted to remove ${t.length} sessions`)}async getAllSessionsForPca(e,t,r){let n=r?e.accounts.filter((e=>e.homeAccountId===r.id)):e.accounts;const i=new Map;for(const e of n){const t=i.get(e.homeAccountId)||[];t.push(e),i.set(e.homeAccountId,t)}n=Array.from(i.values()).map((e=>{if(1===e.length)return e[0];if(t.tenantId){const r=e.find((e=>e.tenantId===t.tenantId));if(r)return r}return e.find((e=>e.tenantId===e.idTokenClaims?.tid))||e[0]}));const o=new URL(t.tenant,this._env.activeDirectoryEndpointUrl).toString(),s=[];return this._eventBufferer.bufferEventsAsync((async()=>{for(const r of n)try{let n;t.tenantId?r.tenantId!==t.tenantId&&(n=!0):r.tenantId!==r.idTokenClaims?.tid&&(n=!0);const i=await e.acquireTokenSilent({account:r,authority:o,scopes:t.scopesToSend,redirectUri:"https://vscode.dev/redirect",forceRefresh:n});s.push(this.sessionFromAuthenticationResult(i,t.originalScopes))}catch(e){this._telemetryReporter.sendTelemetryErrorEvent(e);continue}return s}))}sessionFromAuthenticationResult(e,t){return{accessToken:e.accessToken,idToken:e.idToken,id:e.account?.homeAccountId??e.uniqueId,account:{id:e.account?.homeAccountId??e.uniqueId,label:e.account?.username.toLowerCase()??"Unknown"},scopes:t}}sessionFromAccountInfo(e){return{accessToken:"1234",id:e.homeAccountId,scopes:[],account:{id:e.homeAccountId,label:e.username.toLowerCase()},idToken:e.idToken}}}t.MsalAuthProvider=d},1589:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),s=0;s<r.length;s++)"default"!==r[s]&&i(t,e,r[s]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.LoopbackAuthServer=void 0;const a=s(r(8611)),c=r(7016),u=s(r(9896)),l=s(r(6928)),d=r(6982);function h(e,t){u.readFile(t,((t,r)=>{t?(console.error(t),e.writeHead(404),e.end()):(e.writeHead(200,{"content-length":r.length}),e.end(r))}))}t.LoopbackAuthServer=class{set state(e){e?this._startingRedirect.searchParams.set("state",e):this._startingRedirect.searchParams.delete("state")}get state(){return this._startingRedirect.searchParams.get("state")??void 0}constructor(e,t){if(this.nonce=(0,d.randomBytes)(16).toString("base64"),!e)throw new Error("serveRoot must be defined");if(!t)throw new Error("startingRedirect must be defined");let r;this._startingRedirect=new c.URL(t),this._resultPromise=new Promise(((e,t)=>r={resolve:e,reject:t})),this._server=a.createServer(((t,n)=>{const i=new c.URL(t.url,`http://${t.headers.host}`);switch(i.pathname){case"/signin":(i.searchParams.get("nonce")??"").replace(/ /g,"+")!==this.nonce&&(n.writeHead(302,{location:`/?error=${encodeURIComponent("Nonce does not match.")}`}),n.end()),n.writeHead(302,{location:this._startingRedirect.toString()}),n.end();break;case"/callback":{const e=i.searchParams.get("code")??void 0,t=i.searchParams.get("state")??void 0,o=(i.searchParams.get("nonce")??"").replace(/ /g,"+"),s=i.searchParams.get("error")??void 0;if(s){n.writeHead(302,{location:`/?error=${i.searchParams.get("error_description")}`}),n.end(),r.reject(new Error(s));break}if(!e||!t||!o){n.writeHead(400),n.end();break}if(this.state!==t){n.writeHead(302,{location:`/?error=${encodeURIComponent("State does not match.")}`}),n.end(),r.reject(new Error("State does not match."));break}if(this.nonce!==o){n.writeHead(302,{location:`/?error=${encodeURIComponent("Nonce does not match.")}`}),n.end(),r.reject(new Error("Nonce does not match."));break}r.resolve({code:e,state:t}),n.writeHead(302,{location:"/"}),n.end();break}case"/":h(n,l.join(e,"index.html"));break;default:h(n,l.join(e,i.pathname.substring(1)))}}))}start(){return new Promise(((e,t)=>{if(this._server.listening)throw new Error("Server is already started");const r=setTimeout((()=>{t(new Error("Timeout waiting for port"))}),5e3);this._server.on("listening",(()=>{const t=this._server.address();if("string"==typeof t)this.port=parseInt(t);else{if(!(t instanceof Object))throw new Error("Unable to determine port");this.port=t.port}clearTimeout(r),this.state=`http://127.0.0.1:${this.port}/callback?nonce=${encodeURIComponent(this.nonce)}`,e(this.port)})),this._server.on("error",(e=>{t(new Error(`Error listening to server: ${e}`))})),this._server.on("close",(()=>{t(new Error("Closed"))})),this._server.listen(0,"127.0.0.1")}))}stop(){return new Promise(((e,t)=>{if(!this._server.listening)throw new Error("Server is not started");this._server.close((r=>{r?t(r):e()}))}))}waitForOAuthResponse(){return this._resultPromise}}},2866:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.base64Encode=function(e){return Buffer.from(e,"binary").toString("base64")},t.base64Decode=function(e){return Buffer.from(e,"base64").toString("utf8")}},6244:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sequencer=t.CachedPublicClientApplication=void 0;const n=r(341),i=r(6560),o=r(1398),s=r(1619),a=r(3518),c=r(5541);class u{constructor(e,t,r,s,u){this._clientId=e,this._secretStorage=t,this._accountAccess=r,this._logger=s,this._accounts=[],this._sequencer=new l,this._secretStorageCachePlugin=new a.SecretStorageCachePlugin(this._secretStorage,`pca:${this._clientId}`),this._onDidAccountsChangeEmitter=new o.EventEmitter,this.onDidAccountsChange=this._onDidAccountsChangeEmitter.event,this._onDidRemoveLastAccountEmitter=new o.EventEmitter,this.onDidRemoveLastAccount=this._onDidRemoveLastAccountEmitter.event,this._lastSeen=new Map;const d=new c.MsalLoggerOptions(s,u),h=new i.NativeBrokerPlugin;this._isBrokerAvailable=h.isBrokerAvailable,this._pca=new n.PublicClientApplication({auth:{clientId:e},system:{loggerOptions:{correlationId:e,loggerCallback:(e,t,r)=>d.loggerCallback(e,t,r),logLevel:n.LogLevel.Trace}},broker:{nativeBrokerPlugin:h},cache:{cachePlugin:this._secretStorageCachePlugin}}),this._disposable=o.Disposable.from(this._registerOnSecretStorageChanged(),this._onDidAccountsChangeEmitter,this._onDidRemoveLastAccountEmitter,this._secretStorageCachePlugin)}get accounts(){return this._accounts}get clientId(){return this._clientId}static async create(e,t,r,n,i){const o=new u(e,t,r,n,i);return await o.initialize(),o}async initialize(){await this._sequencer.queue((()=>this._update()))}dispose(){this._disposable.dispose()}async acquireTokenSilent(e){this._logger.debug(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] starting...`);let t=await this._sequencer.queue((()=>this._pca.acquireTokenSilent(e)));this._logger.debug(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] got result`);const r=t.idTokenClaims.exp;if(r){if(new Date(1e3*(r-300))<new Date){this._logger.debug(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] id token is expired or about to expire. Forcing refresh...`);const r=this._isBrokerAvailable?{...e,claims:'{ "id_token": {}}'}:{...e,forceRefresh:!0};t=await this._sequencer.queue((()=>this._pca.acquireTokenSilent(r))),this._logger.debug(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] got forced result`)}const n=t.idTokenClaims.exp;if(n&&new Date(1e3*(n-300))<new Date&&(this._logger.error(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] id token is still expired.`),this._isBrokerAvailable)){this._logger.error(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] forcing refresh with different claims...`);const r={...e,claims:'{ "access_token": {}}'};t=await this._sequencer.queue((()=>this._pca.acquireTokenSilent(r))),this._logger.debug(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] got forced result with different claims`);const n=t.idTokenClaims.exp;n&&new Date(1e3*(n-300))<new Date&&this._logger.error(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] id token is still expired.`)}}return t.account?!t.fromCache&&this._verifyIfUsingBroker(t)&&(this._logger.debug(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] firing event due to change`),this._onDidAccountsChangeEmitter.fire({added:[],changed:[t.account],deleted:[]})):this._logger.error(`[acquireTokenSilent] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}] [${e.account.username}] no account found in result`),t}async acquireTokenInteractive(e){return this._logger.debug(`[acquireTokenInteractive] [${this._clientId}] [${e.authority}] [${e.scopes?.join(" ")}] loopbackClientOverride: ${e.loopbackClient?"true":"false"}`),await o.window.withProgress({location:o.ProgressLocation.Notification,cancellable:!0,title:o.l10n.t("Signing in to Microsoft...")},((t,r)=>this._sequencer.queue((async()=>{const t=await(0,s.raceCancellationAndTimeoutError)(this._pca.acquireTokenInteractive(e),r,3e5);return this._isBrokerAvailable&&await this._accountAccess.setAllowedAccess(t.account,!0),await this._update(),t}))))}async acquireTokenByRefreshToken(e){this._logger.debug(`[acquireTokenByRefreshToken] [${this._clientId}] [${e.authority}] [${e.scopes.join(" ")}]`);const t=await this._sequencer.queue((async()=>{const t=await this._pca.acquireTokenByRefreshToken(e);return await this._update(),t}));return t&&this._isBrokerAvailable&&t.account&&await this._accountAccess.setAllowedAccess(t.account,!0),t}removeAccount(e){return this._isBrokerAvailable?this._accountAccess.setAllowedAccess(e,!1):this._sequencer.queue((()=>this._pca.getTokenCache().removeAccount(e)))}_registerOnSecretStorageChanged(){return this._isBrokerAvailable?this._accountAccess.onDidAccountAccessChange((()=>this._sequencer.queue((()=>this._update())))):this._secretStorageCachePlugin.onDidChange((()=>this._sequencer.queue((()=>this._update()))))}_verifyIfUsingBroker(e){if(!e.fromNativeBroker)return!0;let t=e.account.nativeAccountId;t||(this._logger.error(`[verifyIfUsingBroker] [${this._clientId}] [${e.account.username}] no nativeAccountId found. Using homeAccountId instead.`),t=e.account.homeAccountId);const r=this._lastSeen.get(t),n=e.account.idTokenClaims.iat;return r?r!==n&&(this._lastSeen.set(t,n),!0):(this._lastSeen.set(t,n),!0)}async _update(){const e=this._accounts;this._logger.debug(`[update] [${this._clientId}] CachedPublicClientApplication update before: ${e.length}`),this._pca.clearCache();let t=await this._pca.getAllAccounts();this._isBrokerAvailable&&(t=t.filter((e=>this._accountAccess.isAllowedAccess(e)))),this._accounts=t,this._logger.debug(`[update] [${this._clientId}] CachedPublicClientApplication update after: ${t.length}`);const r=new Set(e.map((e=>e.homeAccountId))),n=new Set(t.map((e=>e.homeAccountId))),i=t.filter((e=>!r.has(e.homeAccountId))),o=e.filter((e=>!n.has(e.homeAccountId)));(i.length>0||o.length>0)&&(this._onDidAccountsChangeEmitter.fire({added:i,changed:[],deleted:o}),this._logger.debug(`[update] [${this._clientId}] CachedPublicClientApplication accounts changed. added: ${i.length}, deleted: ${o.length}`),t.length||(this._logger.debug(`[update] [${this._clientId}] CachedPublicClientApplication final account deleted. Firing event.`),this._onDidRemoveLastAccountEmitter.fire())),this._logger.debug(`[update] [${this._clientId}] CachedPublicClientApplication update complete`)}}t.CachedPublicClientApplication=u;class l{constructor(){this.current=Promise.resolve(null)}queue(e){return this.current=this.current.then((()=>e()),(()=>e()))}}t.Sequencer=l},3034:(e,t,r)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0});try{n=r(4482).net.fetch}catch{n=fetch}t.default=n},3563:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMsalFlows=function(e){return s.filter((t=>{let r=!0;switch(e.extensionHost){case 1:r&&(r=t.options.supportsRemoteExtensionHost);break;case 0:r&&(r=t.options.supportsWebWorkerExtensionHost)}return r}))};const n=r(1398),i=r(583),o=r(215),s=[new class{constructor(){this.label="default",this.options={supportsRemoteExtensionHost:!1,supportsWebWorkerExtensionHost:!1}}async trigger({cachedPca:e,authority:t,scopes:r,loginHint:i,windowHandle:s,logger:a}){return a.info("Trying default msal flow..."),await e.acquireTokenInteractive({openBrowser:async e=>{await n.env.openExternal(n.Uri.parse(e))},scopes:r,authority:t,successTemplate:o.loopbackTemplate,errorTemplate:o.loopbackTemplate,loginHint:i,prompt:i?void 0:"select_account",windowHandle:s})}},new class{constructor(){this.label="protocol handler",this.options={supportsRemoteExtensionHost:!0,supportsWebWorkerExtensionHost:!1}}async trigger({cachedPca:e,authority:t,scopes:r,loginHint:n,windowHandle:o,logger:s,uriHandler:a}){s.info("Trying protocol handler flow...");const c=new i.UriHandlerLoopbackClient(a,"https://vscode.dev/redirect",s);return await e.acquireTokenInteractive({openBrowser:e=>c.openBrowser(e),scopes:r,authority:t,loopbackClient:c,loginHint:n,prompt:n?void 0:"select_account",windowHandle:o})}}]},215:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loopbackTemplate=void 0,t.loopbackTemplate='\n<!DOCTYPE html>\n<html lang="en">\n\n<head>\n\t<meta charset="utf-8" />\n\t<title>Microsoft Account - Sign In</title>\n\t<meta name="viewport" content="width=device-width, initial-scale=1">\n\t<style>\n\t\thtml {\n\t\t\theight: 100%;\n\t\t}\n\n\t\tbody {\n\t\t\tbox-sizing: border-box;\n\t\t\tmin-height: 100%;\n\t\t\tmargin: 0;\n\t\t\tpadding: 15px 30px;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tcolor: white;\n\t\t\tfont-family: "Segoe UI","Helvetica Neue","Helvetica",Arial,sans-serif;\n\t\t\tbackground-color: #2C2C32;\n\t\t}\n\n\t\t.branding {\n\t\t\tbackground-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAhGVYSWZNTQAqAAAACAAFARIAAwAAAAEAAQAAARoABQAAAAEAAABKARsABQAAAAEAAABSASgAAwAAAAEAAgAAh2kABAAAAAEAAABaAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAlqADAAQAAAABAAAAlgAAAADkcSUjAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAAxaElEQVR4Ae19CbgdRbXu6j2cecoECTIkICCGzAg+7qeQ9544QFQgiXpVEJTEe59ALsbMwE5AMZCQELgKeSoqDlyiQogCSUAC6FNCQhIwQMALCbNMGc68p37/v7prnz47++yzzzl76OCu851d3dXV1VXVf69atWqtVZaUg397IPJwSCKT46zgx16wh+19XSYnO6PjE7H4MDuZ7BSxXhQJ/On5KTWbTSMm3bYlvHXmJNxj2SatFLFVioeWn5lDDwAgMvOU2NG/3DMo2h691rLtr4bqBtVX1NVJRUOVBIIiyYSI3RkXO9q5NZmU5S98tu7XpmQF2AwAzCoNwMrAMm/CT3HkrgqJTI/KwodOD4ZDa5MVdUPtfe+KxONKiSob6+SIE46XqsYGK5FIBoLVtQEJiSRaWp+xktaNuzpqfirTLcBOZNJtdnjrDCk6wMrA8hOgWJcZoFSrT4nJogfPESu4Dv8AVLTTEqsC9MkSDHB2NIYfkZGnjJOqpiZQrkTCAmWyKqtDgXBAEs0tLyZtWRl7953/u/uiUR0sVgH2xuKERCJJnhc6lIFV6B7OuXyAJrIpqDzVlQ99TUKVt0scAEomQaXskBAONlEFrgpvLdkZk6r6Wjn6IxMx2qVeY0IsSVrhqnCgMiiJA62v4a5Vkmz/4a7PDWtmVXSIfGMSAGYVFGCpGvGh5VCiHohEAiJXi77sKx+eLZU1N0hHCyuTAJCCDqCAKIUCYxv4AcY6YnL0qeOkZuhQSeoo6b5OG+AC4ZJQRThQFQbAWt7Bvf8ZSNg3P3deA8ZUF2AzADCrMAArA4u9XMoQsQMp6nHlH5dKdcMcad+fJGVCCKRAxfMU1XKB1dYpI8acKI0jj5FkDNSti3LpzSgjCQQmrFA4HKiuIMAO2EnrtkBb+8pdXxr2OjOd+bAd2vQ2cro8mXPjwH/LwBp4H/a/hLvuCsr06cpky6KHfiK1jRdJ235M80ClABMtmMMfKJQDNB4j1VCstg4ZcTKANWpkZmCxAJZiABYIhgO1VRwi21HGj63OxI27pje9xGz5BlgZWOzVUgSPjEqufOheqWmcIq37YwBCWKsDDGlQULnAUh6L4CLFAh/fCmCNOSE7sNxi3IilxiUQCAdrayR+oCWBcn4q0eSy56c2PMc80+6yg2t4MEAKVgYWO7HYwcz8Ig9XSTz5kNQ0nC7tB6KoBmZ+bnAZdaVUhIMHVDxWQtQCYI3thWKZ8rrHLICiCwCslmIKFGn/GoPm9S+cW7ddswJgZw4Ta9NkC/n6HsrA6nufDewOV/Ap8x8cggHvMUztTpLO5igkCV2g4hMIJI3dY56mqBdwgXOlWP0DlhbNkhVgtoQDELza7Z1iJ2J3J2P2DX8/r+Evmsm2A2dukkBfAYbZSDkUrQco+IQ0XeY9eKwEraekovYkzP4OBhUrlGLEXYB1q6QnzXPYLUtuJ5SLcei1k62tMYDKDtTWnRusrf5/J9zbcv9xa5snc9aooLJti3xYbsVy1lEOxekBI01f8NBECVnbJVx1hHS2YSrnGf4y1SQTwAyYTJzpvr6lAWA2AWYlW1vidrQjGait/VS4pvaPx9/bvOn43+4/GwCzDcAoC0P+rKNd1ot9q1s5d489YIa/BQ9+Ap/yAxKsgJSJ8gGXUc94I1BD4Og/j91zDodYGFTmvf88VsYnpiWSt7ICNXWcoQoo2uNJ217298/X/8bky7ZcVKZYppcKE0OaDg0FDn9XPfwFCYc3YEYGUEUpTQeFUNTgyZniDBUyfJdecu9hVJjAYS+YbGuJ8z9QXXNaqL5uzQlrm3d88O79X+Ujt860MIu17ExDZJliFealkMJYMn1NQNZATnXlQ9+ScPXNEm3H02zKrZQK9PpoxQ5+PBJ3pVwqbkBJpFhjPiSNx47sWY7V60Nyy4BaQDQhdqCyJgRWX5LNLbuA8xUfaKz7sTtEkkhhMuBoU5QpVm792rdclKbzkyWoFj64WCrrAKo2SNMxhukSjb4CvoZe/pGBebyfP88ZTNx14KQX6BdV4McQSna2JZItLXGrsurEUEPdra8daPnv43934CIy+Qoqth2hDKx8v4hpkKbrAi++3AUbf4AlmqukvTmuiytgWfr3OBdg/bs533cpwMDgJ6BFEQtUVB4dGlz/kxPuab5TH8S2A1z9bGi+6/o+KY/8FKkUw6KH/ktqm/4Ngk8y6UHltvVCH39IrQx1SsXmoI9l5Tc72xS2Y50AWGtnaEjdF46/p3mtPuJqqmOUQ356YMZtYai8xITrfzsGb4Dg8392W6IZ8FOygImXslwe8KOzF0Dti2D8vZbO0KC6z37wdwfm/d2yvu8dvbPfXr7acw8YcULkrw0Sa34EoBovHZCmq3Jez7dlvwKkGMCoqIHn+E8tQtse5n1UwZn37HXVq0nOeO14sj0Ws44tD4U59FjWLEaaPue+IyXWskMqa11QUfCZQgaK6OtxhqeaIkpInjLUyiRBjJKMhRrrqkOh5IXlodB0S3/ilDR9/cngyx+RcOVg6WjtXZqe67OUUqVnJroQsgu+nTzF/oXUlsIUTIk/WaZY/e18A6r5D34MXbkV0vTBEoVKZ1Zpen8flv2+FCHLnq0YV4N2Zwcwb48pU6z+dDfVXiKnRKGh8HksJt+tIp44penZlmj68yBzD6DjRQ8pmQbwWR4u2aSau0oQg2JRT9EaUqZYfep9vEaKFGhFs2DDN6Si8m594Yk4RQyF+0gVMRlgwyTzb9qRIZu51C02+Uzc7WLaSS55eIvJh1WHwnVGWt0O+VM1eFgMg4dIXBY8OF+qar8HlRd0JciHRRutEoXUy/Q836R5kjIemnwmzpjJTcwlD7O6+crAytaZ5ppK013B5/wNy6W6/goIPkmlMBD1V5puCu8h5gs66GV6E7zHPZRRsmSrgOS7ZI3K84O9Bg/zN/wcuulfVYMHZ+3Mw+Hk+bmmuHT8pPgrZki/aG4qfVymWNneAfmp6Y5TDpm34T6s+306v9L0bA/ntSzAMZdK45qht4qXKVaPPeTM/GISWVcjnZV/xPB3mho8WL1ofPZY4AAuGHmWAZMpKv3cpPsgLlOsTC/BLNHMXn+YRAOPglE/ERoK3a1oMt1XrDQdDsne4YEEl/kv1vOzPcetUxlY6Z3kLNFEZdGG42Gk/hh00w9Xg4fedNPTy8n7OdBjgKRl+5RcudUqy7G8ADDS9DkPnApQbYNjjsOlsz1/SzTeZ/V2bKiQiZk/HUvp572VWcTrfaNYVLddvTUkgyYl5Rk2c1NARtRbUkIHX3nrKyNNn/fgp6BCcL8E0DUxuHShNL3ULzBFqVCR1KwwlZi3LshnQbkDizMkS61i2dkmqDa2zMQpr7tuDc3FQyOmNH0TtD4hTZ97/1ckFLxDEniBCbpvUZMofzQjHdzp5/6oZaoWuQHLMLOrXmgQO34hvugzUMJgfMnvIH5I9rXfgRfTJpqv9P4vU63r7cAYPESmx2X+A7NgQLoCtn68q7BLNL3VK3U9DT1pp6lsPjzoBVj8mqFWSzOfW549B7ZwP4W67RB1fgm7ACh24T84DZTsKlm2/WKZOX499Z1l512OdYoPG5yqkho8qBAoIXMf+K5UNiyAch4axbdXwiWaVAU9BwZQqdHPJCAPD82/55aSHbp17BlY/JrXQLVmOoa/VTtnSqjqVuFI2LI3itkJmX6nCLrICVceIRVVD8iNTy2RK6yrtVGGypWshVke7Bg8kCqJzF2/Gk45LoGMynEf5HGPl6WEIl/yAIlPTjstcmWyP86tW+ZZoWvCo65sbvrblVLVcCuGCFtiUb6MCjQshH/oOquAtQJMbgKzp6TUD7lKVjy9Ua57bJAaaUZ2dnd0kb1KxblKXtAYPMxd/zss0VwibTB4sEGlaF7sl8AXZP61TjhxX1qqirYO2alTPx0c3JHetbGbdq6SmqZLpXUfAEUnAo7NWA8NYLNjkFBXQJj4NpxkTpMrJj6ixgXPTLNTXut6uLkoyTR4WD0zpg5kB7+3EbrpZ6g0veQyqh5abyTuRBSP1dsM8iYwnMBTn91ph4afdKw0jDrWtqForq+oh6KKmWyDoegOLO/MbuXOO6V20BekdS9ngRwyu+ftsaZ2DPIfmI8je7Rtvlwx9vuatdRDo/FJNe/3gzDZg8FD3RjH4KE/SzTsinTy0WOH9OFCWrl8hD4GPwZYSSj/wmzBqm2y7Ff23H7cZ856Lzxk6LfjLc30nFw69R1PKwmsrqGQL57iAg6DK3c+CCadoOIyhnoh8dzXy6EVhvvohMQ7bQyN18mNf1sHUURdSYdGCj6pnDd349H4RmDwUD0AULH5hQBVT+WaZwF0YEYkGA5KKGRZrfsWyS++fHGgtvofYEpArArjpLaXl93jZYd5N9SE4oTkM5vAd0yQln1k0vvLI/HLsZXa1TbCX7n1nNyw43z5zujHBZ7iVLhaYHfQqRYbafrcB8ZhDHkEk5BG6YD7oP63LVV04Q8AKhIxGuZjsAOVBZtx4C1JJKYmb/78Y/r8aKLKrsYR1A0NBAtfryxPcIkuPPbajjeUVTuOhBcUfM11E6Aa4iy4sqb9/4fPJVCvNrhADFd+QCqr/irLd8zSCYFjht3zjDRLvft0SakwdniYd/+ZuG+LhMKNKk03fj77VFiJMiuDjnGwuoG860a4ED1RAKojbttSwxrB7zYGHuc1MS55AF4IGUjLIUO46RksuNp/lYpqmC/Bw1x+mVln1mhB07Ju6AoMjf8iL738FTy3UzhrjIzm8/IfyKjTfdCc+6bC1eYa/Z7jMcfggS33BsPamDjTtfQ0c55eFtO95XiPzT0m5jUGU0Z6XhvyQ3g6ViXVtr2LZeWUiOZH2044YVL0dT3x5w8oFhys2rIeqiEwX2rPN6hMqx0n+G37YuDdpsqoY56V67eNV1DphCHSxeuZO/obU/7GMjn7m/PANyFNX6MC3XiCzvgpJjk4mDQTe3P0lMb0TNd4rzfde+wt1+TzXk8d66gWxUYC8P4f2yvtLWfJjQAV9e7JA7NtPg8haTzsPzD7GyUt72GbMqksYH35PWJoxDBbUTUK85ptsvypb8q3x96mz/TOSPtbCTV4wGvlJGTu+kWwSr7GFwYPfWoP51RoA4e+1n2PSqdMlZs/97aKSCKngOJGUvDrXiyTDQnsfqX4Z7bOCqc6DsHwNRcnYGjsgJQbHVE3+FZZ/vQdcC7u7CGDnar6XQUtI+L4aJpz/01gdK8BTwL5Gx9Egwd2vJ//teUY+kIBsCRBgGqpLPvMGXLzZxxQcVbrNCCti5wFBCfRL+2juMGW0QoseAzRd8D30O2fzUlP6+nc5DWxN583jUMSCm2Dw/y6QV+R007aKUu3nqRrkpxMcDjrS6BQ10jT59z/K6luvAyg4syPQ6wLqr4UWIq8Nih5NYe+Vuk48FmAap72Az8YB1Q9VwrdfNA3w9wm3RybOD2d5yakX2N6+nWTZtLNPeYc17lXC10yp93NcxM8uU1Sj7HJa2JvRm+aHjueelsh1qiqOREzx7/Jsh0X6mSC7gY5NOYSyKRz2xC24zv3rccQ8iXsRYOv2/ECnEsRpc2jQ19ch77Ols0ST5woy6as06GPn5f5YLJV0tu1Jp83zRybuKc83uvm2Bt7jzOVwTTmwT9dGu6ERS+TvDSV58UKFViH5EaNAfB6PwXftVofTD6J4oJsQaXpYGRnr6+V79y/GUs0ZykPR9/lbgN9G7NdNjeoDGLoqw2h3jfJDWefJiumvJbaszBX0VTf6Hu2Hs3bNQwT1m+kgiIRiB1KFSxYZFNLghoGdYMvkRuf3iHXbzlOxQUEV6ahcZorTZ/1wAjoiO3AyzkFwx+c8XORHKjiv5+DLRz6sA8h9nZuOzBdbvjMLK1uLkOfn9vl1g3A2r8CM8I9mEFV4qU4MiXvOzHH3th7zIK85+nH5rynfCYdW2ugnJBK/Ctrx0qw6hm5fvsXFFwcGimxN4HS9DUQfH573YfwPTwFg4fjpJM7PKjmhcnlV3Bx1ucOfe07xI6dJDees0Y4pNPFRy5DX1cLfXsUkCtOxxZjyU/Br9M+fEFUiekClwFFeszmpKeZc+8102xeM9dNbPJ5z538FbrkEghWQOZ1pyx7apUmczcqUi/VTQeoZq37H3g9T8J90FDpgMGDoVR8kLdMf1EuZ8ivqgthdWO1LPv0eFn22ZecoY+yKX+syjivYWC/kLxjFjYba3k37RwHbYQ/gU85qgDS977WMgyhZhL1SGJovFSWPf1ReIs7T2aOe1ULunTt2Vgp+L0EQcSiEF1YWDqiSoluDwKGg++HE0vDexhwmfO+1iYv+S0ubVHUksTQ9zVZfvYdWqzK71SU0L+nOFIv517vB9W/0gZ+l9vHkOSCtyIluHz0yxK1x0GV5GmdoeCVDfwpAyqBogJ82Zg1Vtd/RIKBF8B7nSUX/OJf4drz90qVYjHOBimecKgUY90ShOfuMaJU8B6nEgt+gFePpZlqLCBH25/DBzNaQUVAkXfMhwEK21Wath3ceW5d+PIkxSTPH7tXmk+eiOn6I1Dwo2ZDqcHF2nHxNY79jaskWLleRh33S2irQqVQfVIFHSDh3XHWrpQJLdPGeWMee/9ZbFECJkSY7VbVYcWh+eey7AmAaspz+iETUO4uDgOuSUkpcebad8mKuGCrZFlnh2fKsr/9FtP/86TNVfSDWkbmIoqQylljPEaib0lTExaGwra8/lpQosB9GE1QIOEqPxPW0tSUMa9pwEnqnIkmk3s5/1EUCo8V0E0TiBJmyvJzVusj2Mfs6/d5cCiWaSS/IkqxGWaffD70qWBoMIgyIcq4Uq9Irxfzx3myA5t43JKamoCMHClSXw+aSlkoMpihzwyFhKFJ1/vdPE5ZXdfy3Q5oTqFI6E5BRTvW8SK2lx+voNKPNgLWA338TxC6A4sNphRbjSkw/s8+eaa07fsurFhI2dhhfF2lDWTQoaggQVTpA0eJHHY4XiPOwetrDVNgwrnqiBtApRDl5DOtYP78BQ5vAlCFsSxzl7zcClHClB2iyoYAVARrmf8koWso9DZYFfHwdX0Y9oHTRy/CrOxt8AkrIZJALjpcpm51Xl+I9+m9H3MU05UQxEOHiVRXibwO7SRSrwoOjahbgJkQWE0e8oVztmji9Fkj0wcWMPRVVKiKTtuBy+XGsx0xiVKqyYXlVdlG/vshuN2YGVisoH5dnLWoOOImyJPeAc/wC3QcGGa4xnUMLErfFFaltk5k5CiRN94QaW4GuCBrVPGDCyRvLfkC2Hj+6zEO9Nh9MzzOOWhm3hhXteGOlldBTc/HssxmxzrpGbsYQ182omua21OT3FZrFzBPT+e85u0ak8+km3OVxOGkZ2DxDn7iEXQaxREzx/4SDD1M6m3sEAqO2ewQakrU/O6Pvije7p5785hrvGSu89jk8V7PlMdcN/eS0pih8UgMje++LfI2qoklOLXUZkt1wOcDkFfv1x8cI874Vkw+VgCB2RlMHXmsRejegwGIZ8JYjlon1rtfkhUXtOrQNx1C3CIFVstbtfTHZrtm8qbnST9nvkxp6enMw/+DeSzmTA86Y4Qa8eyT16NHT8UMrRVGCWTqM89uTA3MU7zlmWtMM9fT09Lzm3zmHhOn0vGWafJPkAw9TOQoAIygUb8eyJxi6HE9xXchnflT/ywUQctkunPaleY552HStZgJhi3M+uZBNgVVF4CKSzOR4oGKVTG457FfQm7AYm2pm04d9dknPwFqMB4znjexvkjtg6J9mVk7jUBiIPWqw2zxmFGC2SNqh+oRPBnB5QJIQcRjPXDKMYBzzry/zARVH7Q9EXsL1uEfx1rfUkdZ8dBQG/Y2plDHuQOLNTDgumL03/Gmxkln6y61fPYLuFhHMzSGgfkjj3aYezL1pGgMBjA8V+rlUjoDKr3uZE3l7zoFakHLqDbc0bIRVk0nyopzHtO1Pi4eF8ukras+vj3qG7DYDIKLPNd3xr0lweYJ4C0ehx2iX6T0TkcTXAZIFEccBYBxFqgyL2QheMyQmKJkSNc0FpGJenHoCwWx3hfAWl8EVOosWXnuPh36etPwZJH/ZKEX5r2H3lCeC7PFKyzunv1Ruf6pP0BK/xnIvEAaqFvFt1jqgCpw0OLQWN8gMhLKjG+8JtIK/1ecNbKGJGLpNeU9BCbTnWOagsZgMQOFRGiAWPHpECVsVIuZnR+Gh8PpmflM3F6UwDawnvz3S0Bd+k6xTOW5eG10pOaMPRuLxXCuTyl90hkuTL6Sx0AIlxXDIKpHjRQZMsShXPTa56VcqSHQTdcXBbJnQ2BWSWPR1kelDUPfcoBKVXci9vtFd6oQr6j/wGJtqCNFjUeGOWMuxBLQcixekwriO/KRLwHv0Hj4CPBeRzqgov0qAaT8Fqps+C4m2kkYY0BmEa4KghIvlZXnnCG3nveWZ+hT6LHp5XBwD/RvKPSWo0wrZkMMc6zZGBbfgT+t66DRyY6nkagDPM1Qwh+Ci4FDYwMWsisprcfQ2IGhkYw+KRazONloLIq1vvZWiFa+BJP2dchgybQ1MBYt8dCnjfD/z8AolmkfZ0NXA0JcvpgDt0Wdzd/Al45XFODSD4dG/wQCjOCiAcnRI0WaBrtMPb8D12KmAgvIHa2bpS3+IQUVhz6G94nasLalwD8Dp1imgo5ukSulH/NjuQGUywrdA78JQch7yGLmB8TmeQONCS6CbPgRWDSGu5Z/vAF+CkNfTS1mfXtXya1TL9dHqCXQIaLmwm/DBFJe7znT09PMuYl7upfXGdLLc1K7/7p58/+yOWNUccTYtVhS+QgsaPaBcPE5BJd/gndoHDTYlpHHBeB36oC89drZCirObA8VixkltmldmwkE6Wnm3MSmiEzn6Wkmb3rMfPjPP7D4oK3u0/78Z5FX9jhMsVq551o79/5iRDo0gomvAs818liR8ad1PXVa12H5qA89AKqVf2BxrYwCw5lrPieHD31C2jub5OUXk2CCAw7L5UNwcUxMQKHLCjTAKvsPct2Om5Bkq24aqW859LkH8ggsDB1k3uli59/v/jqMYO9Rvj2AmWFHR0BefglMMhza0LKGMzD/hQDUgRyj2fpBl8l12zdL5K9HpuwBVHTvv0r7tUb5AZb6bVoMYEFL8lv3zINu0o/AsBM9CTCMWAbBHCEOATXB1Y7pvU4WcZk5/PXfZTRLy6Cq6ufke09+VsHFehq1bb++TR/Va+CzQjK4EXe/5MvWLoerSeyXDPdBAVCwpOvFlxQqRHBhJrZnt7M4TOU8MzPzUYe4VaG4gS6FatGetfK97ddjaJyLa47RrB+NIQh8PwTOClGXgVEsgsrIdi5f+zOs+l8Bwahj7UuzJz5E//mDgDVcPX9lt8iB/Y7euj+HRdbWMZqNtiakfvAc8F2PSmTHYV1Do7aE+UobONf2C6jYE6gL33b/gUV+KgWqdX+AT6oLoOnARWhnhwcDKM669JhPRSCPxf/XXhHZS01PHPuqZ7SW5of9E3CNZj8mVbJLrtl+loIr4oojTM4Sxn7CFbuB9enfUKhakpNj8h93VUuyGvsl130UVilw323R94MTCCg9YYygp7hI1RQaOpB6vQEDCA6H1PrkOp03v97kgx/HnpL6V1CbqWgCv7hevrttsSy0Ilq7EgtQ2Wump33QW6kq9B1YpiMvvW8YhJ+PqdO0Ds9+yYoj/Ojam56kHqYHmgRwMaZFzVtvOuAaNtzBlR/B5bSAGqPYGAFbi9QPuVq+t+NfJJqcJpEJ+4QuLrlDWjmkeqBvQ6HZ4eGydcdLAO6DKqpPhI4SVZOp6OeARYHhAsekKZjwo8OiJ+Z16kbRAOLNV3nm5NElO5RhyvJLTHea3MiJ/iRq6v+3VFjPy7VPflxBxRmj2mNqK/7pf3IHltnh4fJ7P4IZ3zZoUg6Hdxp+pQ6oTFfqEOieKKBwzDh17AKLwyH/mR/meLJ/L7QN9jhDIvdB9CtTr0qMNneIiKEPhmH7lEfku9vnOoa+WIw3C9amP4oR+/AbzA1Y7Cxanlz++08CCI9DRbcWPgnIqGeWSnvBpR0L8JiYh/qPH+bTf6RREa8FNoFcAqKtoJ/B5bQFewZhO7141IaD3u9DJLFOZu+o1VUHP26np3Uu3k8vwDLSdCzRzFr7ZciiHgAQsPwBuyobfEW2LyVFokxjCCIee8BkQMV02v8RXNSPenk3zOYxwhpBKm/LFkw9TB6eDySY+03MsjIeu3I6qmTXYM+gwfYuWbLlNLULoHZtUYdGVtD8pzc+vfLefOnXvPem5zN5M6V3v9YzsChNp2Ibpemz7p0l4dpfqOeUJFSPnQ0wvTXo4ViR5FxLgYqnBlxpMTuGSnc02SK4OqBST3AZIwfTnvTYeUL3fk3P05dzlsf8DOa+no45a6QzXe4ZFKr6APjOv8o12y4v6p5BWlHvj6m0idMrb/Jma6S5Zu5Nvyc9vft5ZmDpEk3E0em+7N5rIX1eIdFWzGyVq6bgKfdAqmSCF1wpapUJXHgEh8NXXoILoBa/C1JN6+CyqBOUPI7t9AatxKzxLrn0vkp1bPdPODQeDCxdook4QqVZa2/D7GchZDjcL5mwQH7zFfQh5p0KKjc2YPOCy0vF+Koo5+KzXtkNfwz7HHBpAp/r2wALJdSNGyPUNE6DEuGzsuTJcY49JgTKzpYsvq18PivWHVjdpOlrfwvd9RmuM/787Jes4HIB6QUaW6Tgw4+Czb1IqTyZ+NdeFtn3btKR0pMZ85GhxsFvg5V39wyqHgWB6na5ZutMZSnoaIV9XKrQn2+yP/egfV2NNNJ0xjXDN0ql2S8Z0vR8BgLHK0pgxV0cOY/xnDAflU8tGIu+9aYzWRgCt0UJOF9znMH1bVjOZzt6L8vZM4h9zD2Drt3+LxIf97WUz9d8LWSbBYtcAZBrPm/7+noP8jsUS5XzoEc16+4mqR6+RSrqzkjtl8xCc/lnRUw+7zHTTEgde8Bz0LCIzLys/5oPFjPwkxCQDnn+2bPgYO1fwSTjOrh6G4Ya5pn+jDE0grpS5lXb9FUJP7VTIls+5Kw1gnL5wrDXvJz8xpj1oYFUzrt83dGSCMAZf81Y8FQHO+Pv7bkp0CCj95j3mZdujhl7yZSCCyDSYZCXcBzACwnAKLYGxqLxts2QPxwvd39zo8w/+ddQGDxHqR73Rwa3rMX59kc3RjBD44cw690JvusCHRqppVrKobGAfeaIEy5feyImfNg2pOooSNO7lmgK+GAt2lArnihxYkyAYeijAUYl9pjpaF4lt00/TX70lVfVWJSqwgvH/AE5T8eQ2AEzMw7n7jpdOqJxJWPIlC/XtPQCM92XMQ/ccbt7BtU1/QwiidWai+Kc96H6c0C+xh1W7fWQvzTBNVHxQGX6vhu4lGphjxnsLCrJKDZvmp4yw1KLGVBW9RsBd0oLxv4FIJyAOr+NZRXkx7ZsGviie/tnxvQ8uablcl9PecBv2VDj0D2DBl0i127bLpEnjtU26VIQBNLvkxCQ+v1XQJfqGHxNUEjHGthBHZ7eSQU4d7qTbChcLtLbMPaYSdgnyQ/Py7zHjHGntGDscxhaMHS3/re6asy0XYvBi/eFsQnpwdsscy0930DymHsdvha7fWEhu7J2HDZAfxYAm+bsSYih0fjDMHXoT2yeZervPc+WxmeZ6+bYe6+pS7Y0Nw+1PKfiq+dp1wzRFFC8OA5+Co72MfS1H1gtt5w7Xn54/otZ95gx7pTmjH5T4vvGw2nHFvVbZcDFupsO8B6bjjPXTOxtqzfNHDP2BpPONHOcLY+5tysvvdeg3dgzqKr+Llmy/SbNYvYMMvlzibvK7A4M3ptep2xpJq8pL/3ZmdLT09xzzgpH61INfSyYTMWMsYCDWV4Iin5JqDVfAFDN1PbopAJrlNmCDos2BI+TW2Th2FMByg3ujhrZ78tWZlGvweWTs2cQttNrugx81+MQS3xAh0blu3IbGv04ftIqJTOqC93BxtF+pTrafw6mYqNl1bl36CyJ03AytbkE406JM6xF4z8Jge6vAK6wTgDcvWNzKaaEefhxO0NjVd2pON4li7dOUXDx3ZC37CUwmwnmdZrYpDP2ppljE5t86efp96XnY34TzDFjSh//Bv/kvAYd4aIFGFzgj3vMdGCPmSHbR8stU59z/E4BUI4fiNwr43WntHDcl8G/rJJqgIu+rfwtpfe2EbNG1zKouv5eiWxbqv1Au4JeZo0GDObFegvNdC1bPnNvT/eZdJOPsTfNlM09oddgys7ruVEI5hxIsDj0VYKfAwFvb54Jby4XYg3NWeoYiMtFvgCqqZDaLRp/OcB1JZakKOci3YLDD1Ta7/9JWgbBRq6TlkGD5sjiJx+V2X/2n2VQDu8/IC17V2L42A1xA/z64KUXKujQR5eL2F4tFn0RBHI8+KnVOvSpNkWOQ1+2+tGdEgP5s0Xjr8WOW/8GgS9oozqOKCZFzlbL7NccXjfoWAY1fEzqq3fJVds+4YhZImARXF9k3lL89MGwXqhPQH56UQcsts6CuOE93ahR5UF5rimXXshhco+Z9pY1MrTzJLn5vB3gHypSi7PejhrIsUqzAVLKha4afytEF1NVpyug6hLFocoDqT/vdWR7mDU2O5ZBVdUb5KqtEYey4+Pxqj87n9JAn5i/+wkdBGdJZ9WUFyCQxA6rHS/hCyfDxSWd/AwdOuurgHYEFNw7sMfMLZ+frmrOpCrc17lQgcMqeZNF434LmdhkDDHc8zAEgB8iM0b2P3eOhWVQtD0J58FXy5VPbpBZ25oo83r++TfyqxyQ5/fgLOlwEfrm818Vq3U8KNc2LEI74BrYwwBNDH0sK9b5GmZ9p4FKrdJZTr6Gvt7qZ6T0V47ZBHP5SRCr7JMwpfQ+B5f71euXzaGRE522/di0oP4TUpvcJXM3f/z1mUdAhxvB5jDvv+BUiovQpCA3f+WADN1xCuRJD6oEnIx2/4KjdVCFPWY6WtZJdcuJcvO5m3XoUyZbFQn7V3Jf7zJS+oVjnsIEcTx2Z31FKqAtQUGqUmXi32f/rJjWCY1lHeFgCb/caTYGqnsY+OFHAnO3LGJXBMIWWBkeaU498MOPUyVTE4LLyI++dc+vAa4vYvji0EGpfPe85p70mGAM0CoCIR6dJ/953lI99patCUX+4bBICjbvsUFwB/kIpPRj8KL44fhzSCGgGBh3Axn41aQdsGqHWPZbr99+zLgT3gsNGvrtROuBBF5QrzIvLbPQP6jzwWDxOvr41t2rAK5LIWvijIp5s5FdKi9j6KvlUsVbYECnQpTwmA59o6fZUHArPZtJptfwXv8IboT68Bk6xPgRXClg4cALLvZiEjIVKDraiXBo2PB6qR9xmG1z59kMr7PQGMpYPup7MFCcocqRB91y7mUA1VVYLOVyDypuPCBrS1EmYwam47OiFL2zZSPoG4Y+BVWFOg7xA6hYTYKKlJOU66oJZ0rr/rtTS0CHgpReuxs/jmVQCPywI0JxztlC34SDKZapGgWN02H+RaB963ffxHreDzGzwteC3bNtBSTvZZOgkIehjzxkLBqRH5y7WIswWqmmPD/FNIfnFsUMS7bDYKRxBgSqFEVwKOm5T5i/WKELROxl/W7R06RW+g+KJXZnTIYdNVzqh9ONBprjVUEqVj0zPQd1660TIZB7GIaXkAv9+2+mADy3Y2gcgoVTp6E0dCCgOg5g1pe8WH4wbQNkLQHhHjMEpJ8DBY0RvjK8osg27HvduACCYjNcH0zJi90W1Ayd7DyVkbGtzAiswwAsfBeHELCchhnqM+OuRqkIXoD2noEL8LxvvY3GPCTh2B2yYnq7sx3ITH75bo84t/v210uVl2ybBf5wBfhDNAvrpqXeUUN70O1Gwt0w8OnAOhIUa8ShCiwio7dZXW/X/YsuUOVNDlVevA1uBCp+4Qz5HPd1NlyamucCrA53KDykgcXu5Rc+c3VI9g5KymhspE3m//UR2FptBumw+3mV5j0M+KlGHBHZ+ikM7/dj32sMP7EYKBcFqsUP2YCFncu681igWLQcTx8KWUZPzE62awNtLcru6bEDLfrQvJ+m8CpQ3X4q3tzD0PqogXYt5XjFB1cmYPXIvPtvKCw9k+onCBopfWT8ZkjksLzV+aYadqSk9KgsX3gx/k2/pD/LpPs8LgMr/QUZXfprJ2Bh3sK+123P6/JWIVWK0utgzg2ozPkhNL6UgWVemjemAJU8VwT7XjcMHQ8h8eNqqFEIlaKeyB9ngb0FD/ByyN1baXm9fgh9A3ltd26FRWysnVqcHWJW/OR9kNJ/GoLU4vBcBilGzGBil8/iAhkFpEMpIPXhrLBMsbJBzBhqKLAmcjN17HsNXXpHjdu8+mwl9P9apk9eKRR+0p9szvU6HlnK2G1xGVi9vXqvoUZk4oUA140w8KW2B2hGARfWDThYP++x1tckmNjNo9dK/ONWKdN3UeKa+fTxRtecC+pXbZkPcH0PqsPU5GdX5v8DZakMZgg0cZrkXYfC4Yf7bkkn/x3idMf775eAigBEXGFYcgo3U79EQtXQ7cSCKXX6CxIMunoo3KUOPVwtaXIZWH3qfi5Yu4YakQk/go3A51XafUi4U+pTQweWGSpIZWD1pwtVrwtS+iUT1ko8/nFVJaKtZKENNQyFMnF/6l7Ye2wrCIc62GukDKz+drSR0l8z6TG4s5yIPXbew9BIXXqKI7oYbgOCvsbeepl7vWneY/JfDMqH4bhEMRj2hAXjZxCsp8vAcl5J/34NuK4av1OsTpjPte+GQa5jqNG/ErvuUjDhVbmY6bqQ6cgFU6ZLRUyzEdRnbFIeKANroB1vloAiH31VAlEsAbVsd6T0/bZw8tQoJ1Qhvy8m99ysPZxs2d8mVujnZWB5XmO/D7kEREONyEcPyMkTTsEuFX+ERir2boRdZSGDUrVCPqAPZYMFCNbX84Yluy+qe7MMrD70XdasxlCDAtVrJv4vWP+sgadkDIsElzI9uN0gIdfYPNGlXOnFmMsljdFeLNAHmxorE/v33bv7oqalaK4/rWhL2k8DeThFEcaf1ZKJ0+HY4wegXOS5YAuI31zx5OJI8cib9L5UImpojgdS2QHfS0DFrFA4GKxrrEjs3/9fuy8e9DktdbFaQgz4AeUCvD2g5nOuO6VrJv0fDItL4E4JogjVsOUScm7BYMfEB93FC+b/oIuFTEiAcMYx+wsGahvDyVjnq4nmfReDUn1RH6pGKlayPBQW4hUYO0qamV0z8WpYMV0KhUH0tY4Q+ZfSG/AZnBUmTuDTiFsVNcFgbWPIjna8YLfun1H38uvHgVLdnvJN5rbdF9OJQrxbn5RJf1Yw1IDqzZVPfhEbiP5aN1BLUkG9F0MNBQt+UiBxj71rhdCaHno07QoLt1YIgGA7M9BbGC1zM5Bk+4GnwUIt3XNxw69cKixnPmyHNk121Yvcji9TrMIiEEtA6HAqDV4z8U5I6T+hzmyD3GW9Hx5vCDIGAzZzrIn5/eFwhxITVlVdKFBVF7Q7W59IdLSev/viprF7vt74S4JqEtsFlKWDijUpU6z8vo+eS0sZamyBlN7aBEONejXUsGCoYQDjvVvT8GNAZGaEXoqVUvTLH8VS/snCnmvVDQFa/tjR1sdsO3AdwHS/Wz0LgAptnTmJZkGZaq7ZysDyvsxCHxtwLdoxCiPMn2AgewQc2mb2eJMJWAQV0xHzlXZpkA4YWCiNQ5kdCtQ0WuCf4NmscwOmsd/f8/VBD2u3gDKduUmCmahTpm4rAytTrxQyLWW/uGUoKNejMNQ4CTr13cFF8GggenDgpVY89wLr6BHgsQ7DOjidTff5dbI0DnlhAEqSHdjNNh5fiw3Llu75+pC/IB0q2aqoAHcE3XkovZblp881yVJW+VKuPWDcKV36QqU0qJT+dPiN6AIXX7cGHPA4G7COGiF1AFaffDfQsw55KMsCoBok2bqfT7sTz7l+zzcGbdNHc+uVZzZh8jGZwOtzKAOrz12Wpxu8LgkWbr0XUvopEKimGWp4gEUJmAGZl2L1DVgsAYAKhAO19ZJs3o9j+Zkkg8v3XFL/rLaM9frwmbZulj6AppaBNYDOG/CtpApcAmJYuPUnMNS4SNr2gmO2HP/0TDdgMjEBRmDxkjLvOVEs3pWA92hQqDpJtuxrR7k/hl/AFS9f3PQirolAZCBvI9XURxP7/1MGVv/7Lj93upJqLWzh1qWQ0s/pcqdECT6umKGQxwAV05R5j9L8C8A6vMehUAFlBcNhq7oGgNp/wLKTt8bDVatevbDmNT6TIoOtg15MpvyFMTEPoQysPHTigIugTzG5Gowy9OoXPPEdMPTXwykwAUVqxi2KFUwKMgUWKRYYpWhchn/wGGCxAU5BkLWLeQegrATW8cJWVTUB9Q6YqlsqrI4f/P3iEW+zvpNus8Nb3wAVM6sEA25E9wLKwOreHyU8gycf405pwdavwZ3S7ZIAP5+EOyUbUvoUuFxQxeLY76FSjjj+WC+giK6kFa4IWxVVYMr3vQ5ErgzG965+ceZxyqErhXpjUsEAZTqwDCzTE36JzYxx/tZzYFS2DkpzdMHZiRcF7866L5DjFhJE7IhRx8CNfi135COg7EBFdQig4izvJSwdLU80t/7k1SuOamfTCk2h0ruvDKz0HvHDuRGkLtx2OpistXZlw1C7+T2w3xBWwV9yuKpKhh0xApuIYJ+gZDJgVdUGaMQAQD0HfN2w59Wmnxu5kwOoxaBQEfJbRQtlYBWtq/v4IJdyjbx9b1Pzu3uvxXB4QbCmqT4MnqmiBgYL4Mq4aZ7diQleLPokhKM37P5G453mKTrkzcCyi6OuY5KLFpeBVbSu7seDPLKuCffZw5rfjU6OJ2LjIQyFm2S7E2B7MRBI/OmlbwzdbEpXQPWyjmfyFjL+/4JPu45FLkyEAAAAAElFTkSuQmCC\');\n\t\t\tbackground-size: 24px;\n\t\t\tbackground-repeat: no-repeat;\n\t\t\tbackground-position: left center;\n\t\t\tpadding-left: 36px;\n\t\t\tfont-size: 20px;\n\t\t\tletter-spacing: -0.04rem;\n\t\t\tfont-weight: 400;\n\t\t\tcolor: white;\n\t\t\ttext-decoration: none;\n\t\t}\n\n\t\t.message-container {\n\t\t\tflex-grow: 1;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tmargin: 0 30px;\n\t\t}\n\n\t\t.message {\n\t\t\tfont-weight: 300;\n\t\t\tfont-size: 1.4rem;\n\t\t}\n\n\t\tbody.error .message {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\tbody.error .error-message {\n\t\t\tdisplay: block;\n\t\t}\n\n\t\t.error-message {\n\t\t\tdisplay: none;\n\t\t\tmax-width: 800px;\n\t\t\tfont-weight: 300;\n\t\t\tfont-size: 1.3rem;\n\t\t}\n\n\t\t.error-text {\n\t\t\tcolor: salmon;\n\t\t\tfont-size: 1rem;\n\t\t}\n\n\t\t@font-face {\n\t\t\tfont-family: \'Segoe UI\';\n\t\t\tsrc: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot?#iefix") format("embedded-opentype");\n\t\t\tsrc: local("Segoe UI Light"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.svg#web") format("svg");\n\t\t\tfont-weight: 200\n\t\t}\n\n\t\t@font-face {\n\t\t\tfont-family: \'Segoe UI\';\n\t\t\tsrc: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot?#iefix") format("embedded-opentype");\n\t\t\tsrc: local("Segoe UI Semilight"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.svg#web") format("svg");\n\t\t\tfont-weight: 300\n\t\t}\n\n\t\t@font-face {\n\t\t\tfont-family: \'Segoe UI\';\n\t\t\tsrc: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot?#iefix") format("embedded-opentype");\n\t\t\tsrc: local("Segoe UI"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.svg#web") format("svg");\n\t\t\tfont-weight: 400\n\t\t}\n\n\t\t@font-face {\n\t\t\tfont-family: \'Segoe UI\';\n\t\t\tsrc: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot?#iefix") format("embedded-opentype");\n\t\t\tsrc: local("Segoe UI Semibold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.svg#web") format("svg");\n\t\t\tfont-weight: 600\n\t\t}\n\n\t\t@font-face {\n\t\t\tfont-family: \'Segoe UI\';\n\t\t\tsrc: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot?#iefix") format("embedded-opentype");\n\t\t\tsrc: local("Segoe UI Bold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.svg#web") format("svg");\n\t\t\tfont-weight: 700\n\t\t}\n\t</style>\n</head>\n\n<body>\n\t<a class="branding" href="https://code.visualstudio.com/">\n\t\tVisual Studio Code\n\t</a>\n\t<div class="message-container">\n\t\t<div class="message">\n\t\t\tYou are signed in now and can close this page.\n\t\t</div>\n\t\t<div class="error-message">\n\t\t\tAn error occurred while signing in:\n\t\t\t<div class="error-text"></div>\n\t\t</div>\n\t</div>\n\t<script>\n\t\tvar search = new URLSearchParams(window.location.search);\n\t\tvar error = search.get(\'error\');\n\t\tif (error) {\n\t\t\tconst description = search.get(\'error_description\');\n\t\t\tdocument.querySelector(\'.error-text\')\n\t\t\t\t.textContent = error + \' - \' + description;\n\t\t\tdocument.querySelector(\'body\')\n\t\t\t\t.classList.add(\'error\');\n\t\t}\n\t<\/script>\n</body>\n\n</html>\n'},3226:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachedPublicClientApplicationManager=void 0;const n=r(1398),i=r(6244),o=r(3310);class s{constructor(e,t,r,i,o,s){this._pcasSecretStorage=e,this._accountAccess=t,this._secretStorage=r,this._logger=i,this._telemetryReporter=o,this._pcas=new Map,this._pcaDisposables=new Map,this._onDidAccountsChangeEmitter=new n.EventEmitter,this.onDidAccountsChange=this._onDidAccountsChangeEmitter.event,this._disposable=n.Disposable.from(...s,this._registerSecretStorageHandler(),this._onDidAccountsChangeEmitter)}static async create(e,t,r,n){const i=await a.create(e,n),c=await i.getOldValue(),u=await o.ScopedAccountAccess.create(e,n,t,c),l=new s(i,u,e,t,r,[i,u]);return await l.initialize(),l}_registerSecretStorageHandler(){return this._pcasSecretStorage.onDidChange((()=>this._handleSecretStorageChange()))}async initialize(){let e;this._logger.debug("[initialize] Initializing PublicClientApplicationManager");try{e=await this._pcasSecretStorage.get()}catch(e){this._logger.error("[initialize] Error initializing PublicClientApplicationManager:",e),await this._pcasSecretStorage.delete()}if(!e)return;const t=new Array;for(const r of e)try{t.push(this._doCreatePublicClientApplication(r))}catch(e){this._logger.error("[initialize] Error intitializing PCA:",r)}const r=await Promise.allSettled(t);let n=!1;for(const e of r)if("rejected"===e.status)this._logger.error("[initialize] Error getting PCA:",e.reason);else if(!e.value.accounts.length){n=!0;const t=e.value.clientId;this._pcaDisposables.get(t)?.dispose(),this._pcaDisposables.delete(t),this._pcas.delete(t),this._logger.debug(`[initialize] [${t}] PCA disposed because it's empty.`)}n&&await this._storePublicClientApplications(),this._logger.debug("[initialize] PublicClientApplicationManager initialized")}dispose(){this._disposable.dispose(),n.Disposable.from(...this._pcaDisposables.values()).dispose()}async getOrCreate(e,t){let r=this._pcas.get(e);if(r?this._logger.debug(`[getOrCreate] [${e}] PublicClientApplicationManager cache hit`):(this._logger.debug(`[getOrCreate] [${e}] PublicClientApplicationManager cache miss, creating new PCA...`),r=await this._doCreatePublicClientApplication(e),await this._storePublicClientApplications(),this._logger.debug(`[getOrCreate] [${e}] PCA created.`)),t?.length){this._logger.debug(`[getOrCreate] [${e}] Migrating refresh tokens to PCA...`);for(const n of t)try{const t=await r.acquireTokenByRefreshToken({refreshToken:n,forceCache:!0,scopes:[]});t?.account&&this._logger.debug(`[getOrCreate] [${e}] Refresh token migrated to PCA.`)}catch(t){this._logger.error(`[getOrCreate] [${e}] Error migrating refresh token:`,t)}}return r}async _doCreatePublicClientApplication(e){const t=await i.CachedPublicClientApplication.create(e,this._secretStorage,this._accountAccess,this._logger,this._telemetryReporter);this._pcas.set(e,t);const r=n.Disposable.from(t,t.onDidAccountsChange((e=>this._onDidAccountsChangeEmitter.fire(e))),t.onDidRemoveLastAccount((()=>{r.dispose(),this._pcaDisposables.delete(e),this._pcas.delete(e),this._logger.debug(`[_doCreatePublicClientApplication] [${e}] PCA disposed. Firing off storing of PCAs...`),this._storePublicClientApplications()})));return this._pcaDisposables.set(e,r),t.accounts.length>0&&this._onDidAccountsChangeEmitter.fire({added:t.accounts,changed:[],deleted:[]}),t}getAll(){return Array.from(this._pcas.values())}async _handleSecretStorageChange(){let e;this._logger.debug("[_handleSecretStorageChange] Handling PCAs secret storage change...");try{e=await this._pcasSecretStorage.get()}catch(e){return void await this._storePublicClientApplications()}if(!e)return this._logger.debug("[_handleSecretStorageChange] PCAs deleted in secret storage. Disposing all..."),n.Disposable.from(...this._pcaDisposables.values()).dispose(),this._pcas.clear(),this._pcaDisposables.clear(),void this._logger.debug("[_handleSecretStorageChange] Finished PCAs secret storage change.");const t=new Set(e);for(const e of this._pcas.keys())t.delete(e)||this._logger.debug(`[_handleSecretStorageChange] PCA was deleted in another window: ${e}`);for(const e of t)try{this._logger.debug(`[_handleSecretStorageChange] [${e}] Creating new PCA that was created in another window...`),await this._doCreatePublicClientApplication(e),this._logger.debug(`[_handleSecretStorageChange] [${e}] PCA created.`)}catch(t){this._logger.error(`Failed to create new PublicClientApplication: ${e}`);continue}this._logger.debug("[_handleSecretStorageChange] Finished handling PCAs secret storage change.")}_storePublicClientApplications(){return this._pcasSecretStorage.store(Array.from(this._pcas.keys()))}}t.CachedPublicClientApplicationManager=s;class a{constructor(e,t){this._secretStorage=e,this._cloudName=t,this._onDidChangeEmitter=new n.EventEmitter,this.onDidChange=this._onDidChangeEmitter.event,this._oldKey=`publicClientApplications-${this._cloudName}`,this._key=`publicClients-${this._cloudName}`,this._disposable=n.Disposable.from(this._onDidChangeEmitter,this._secretStorage.onDidChange((e=>{e.key===this._key&&this._onDidChangeEmitter.fire()})))}static async create(e,t){const r=new a(e,t);return await r.initialize(),r}async initialize(){const e=await this.getOldValue();if(!e)return;const t=await this.get()??[];for(const{clientId:r}of e)t.includes(r)||t.push(r);await this.store(t)}async get(){const e=await this._secretStorage.get(this._key);if(e)return JSON.parse(e)}async getOldValue(){const e=await this._secretStorage.get(this._oldKey);if(!e)return;const t=[];for(const r of JSON.parse(e)){const e=JSON.parse(r);e.clientId&&e.authority&&t.push(e)}return t}store(e){return this._secretStorage.store(this._key,JSON.stringify(e))}delete(){return this._secretStorage.delete(this._key)}dispose(){this._disposable.dispose()}}},7247:e=>{"use strict";e.exports=require("./msal-node-runtime")},4482:e=>{"use strict";e.exports=require("electron")},1398:e=>{"use strict";e.exports=require("vscode")},181:e=>{"use strict";e.exports=require("buffer")},6982:e=>{"use strict";e.exports=require("crypto")},9896:e=>{"use strict";e.exports=require("fs")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},6560:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DataProtectionScope:()=>P,Environment:()=>N,FilePersistence:()=>T,FilePersistenceWithDataProtection:()=>R,KeychainPersistence:()=>M,LibSecretPersistence:()=>x,NativeBrokerPlugin:()=>ue,PersistenceCachePlugin:()=>y,PersistenceCreator:()=>D});var n=r(9896);const i=require("process"),o="EEXIST",s="ENOENT",a="Dummy data to verify underlying persistence mechanism",c="HOME",u="LOGNAME",l="USER",d="LNAME",h="USERNAME",f="LOCALAPPDATA",p="unknown_error";class g extends Error{constructor(e,t){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,g.prototype),this.errorCode=e,this.errorMessage=t,this.name="PersistenceError"}static createFileSystemError(e,t){return new g(e,t)}static createLibSecretError(e){return new g("GnomeKeyringError",e)}static createKeychainPersistenceError(e){return new g("KeychainError",e)}static createFilePersistenceWithDPAPIError(e){return new g("DPAPIEncryptedFileError",e)}static createCrossPlatformLockError(e){return new g("CrossPlatformLockError",e)}static createCachePersistenceError(e){return new g("CachePersistenceError",e)}static createNotSupportedError(e){return new g("NotSupportedError",e)}static createPersistenceNotVerifiedError(e){return new g("PersistenceNotVerifiedError",e)}static createPersistenceNotValidatedError(e){return new g("PersistenceNotValidatedError",e)}}const m=e=>!!e&&"object"==typeof e&&e.hasOwnProperty("code");class v{constructor(e,t,r){this.lockFilePath=e,this.retryNumber=r?r.retryNumber:500,this.retryDelay=r?r.retryDelay:100,this.logger=t}async lock(){for(let e=0;e<this.retryNumber;e++)try{return this.logger.info(`Pid ${i.pid} trying to acquire lock`),this.lockFileHandle=await n.promises.open(this.lockFilePath,"wx+"),this.logger.info(`Pid ${i.pid} acquired lock`),void await this.lockFileHandle.write(i.pid.toString())}catch(e){if(!m(e))throw e;if(e.code!==o&&"EPERM"!==e.code)throw this.logger.error(`${i.pid} was not able to acquire lock. Ran into error: ${e.message}`),g.createCrossPlatformLockError(e.message);this.logger.info(e.message),await this.sleep(this.retryDelay)}throw this.logger.error(`${i.pid} was not able to acquire lock. Exceeded amount of retries set in the options`),g.createCrossPlatformLockError("Not able to acquire lock. Exceeded amount of retries set in options")}async unlock(){try{this.lockFileHandle?(await n.promises.unlink(this.lockFilePath),await this.lockFileHandle.close(),this.logger.info("lockfile deleted")):this.logger.warning("lockfile handle does not exist, so lockfile could not be deleted")}catch(e){if(!m(e))throw e;if(e.code!==s)throw this.logger.error(`${i.pid} was not able to release lock. Ran into error: ${e.message}`),g.createCrossPlatformLockError(e.message);this.logger.info("Tried to unlock but lockfile does not exist")}}sleep(e){return new Promise((t=>{setTimeout(t,e)}))}}class y{constructor(e,t){this.persistence=e,this.logger=e.getLogger(),this.lockFilePath=`${this.persistence.getFilePath()}.lockfile`,this.crossPlatformLock=new v(this.lockFilePath,this.logger,t),this.lastSync=0,this.currentCache=null}async beforeCacheAccess(e){if(this.logger.info("Executing before cache access"),await this.persistence.reloadNecessary(this.lastSync)||null===this.currentCache)try{this.logger.info(`Reload necessary. Last sync time: ${this.lastSync}`),await this.crossPlatformLock.lock(),this.currentCache=await this.persistence.load(),this.lastSync=(new Date).getTime(),this.currentCache?e.tokenCache.deserialize(this.currentCache):this.logger.info("Cache empty."),this.logger.info(`Last sync time updated to: ${this.lastSync}`)}finally{e.cacheHasChanged?this.logger.info(`Pid ${i.pid} beforeCacheAccess did not release lock`):(await this.crossPlatformLock.unlock(),this.logger.info(`Pid ${i.pid} released lock`))}else e.cacheHasChanged&&(this.logger.verbose("Cache context has changed"),await this.crossPlatformLock.lock())}async afterCacheAccess(e){this.logger.info("Executing after cache access");try{e.cacheHasChanged?(this.logger.info("Msal in-memory cache has changed. Writing changes to persistence"),this.currentCache=e.tokenCache.serialize(),await this.persistence.save(this.currentCache)):this.logger.info("Msal in-memory cache has not changed. Did not write to persistence")}finally{await this.crossPlatformLock.unlock(),this.logger.info(`Pid ${i.pid} afterCacheAccess released lock`)}}}var w=r(6928);class C{async verifyPersistence(){const e=await this.createForPersistenceValidation();try{await e.save(a);const t=await e.load();if(!t)throw g.createCachePersistenceError("Persistence check failed. Data was written but it could not be read. Possible cause: on Linux, LibSecret is installed but D-Bus isn't running                     because it cannot be started over SSH.");if(t!==a)throw g.createCachePersistenceError(`Persistence check failed. Data written ${a} is different                     from data read ${t}`);return await e.delete(),!0}catch(e){throw g.createCachePersistenceError(`Verifing persistence failed with the error: ${e}`)}}}const I="",A={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};var S;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(S||(S={}));class E{constructor(e,t,r){this.level=S.Info;const n=e||E.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:S.Info,this.correlationId=n.correlationId||I,this.packageName=t||I,this.packageVersion=r||I}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:S.Info}}clone(e,t,r){return new E({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${S[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:S.Error,containsPii:!1,correlationId:t||I})}errorPii(e,t){this.logMessage(e,{logLevel:S.Error,containsPii:!0,correlationId:t||I})}warning(e,t){this.logMessage(e,{logLevel:S.Warning,containsPii:!1,correlationId:t||I})}warningPii(e,t){this.logMessage(e,{logLevel:S.Warning,containsPii:!0,correlationId:t||I})}info(e,t){this.logMessage(e,{logLevel:S.Info,containsPii:!1,correlationId:t||I})}infoPii(e,t){this.logMessage(e,{logLevel:S.Info,containsPii:!0,correlationId:t||I})}verbose(e,t){this.logMessage(e,{logLevel:S.Verbose,containsPii:!1,correlationId:t||I})}verbosePii(e,t){this.logMessage(e,{logLevel:S.Verbose,containsPii:!0,correlationId:t||I})}trace(e,t){this.logMessage(e,{logLevel:S.Trace,containsPii:!1,correlationId:t||I})}tracePii(e,t){this.logMessage(e,{logLevel:S.Trace,containsPii:!0,correlationId:t||I})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}class T extends C{constructor(e,t){super(),this.logger=new E(t||T.createDefaultLoggerOptions()),this.filePath=e}static async create(e,t){const r=new T(e,t);return await r.createCacheFile(),r}async save(e){try{await n.promises.writeFile(this.getFilePath(),e,"utf-8")}catch(e){throw m(e)?g.createFileSystemError(e.code||p,e.message):e}}async saveBuffer(e){try{await n.promises.writeFile(this.getFilePath(),e)}catch(e){throw m(e)?g.createFileSystemError(e.code||p,e.message):e}}async load(){try{return await n.promises.readFile(this.getFilePath(),"utf-8")}catch(e){throw m(e)?g.createFileSystemError(e.code||p,e.message):e}}async loadBuffer(){try{return await n.promises.readFile(this.getFilePath())}catch(e){throw m(e)?g.createFileSystemError(e.code||p,e.message):e}}async delete(){try{return await n.promises.unlink(this.getFilePath()),!0}catch(e){if(m(e)){if(e.code===s)return this.logger.warning("Cache file does not exist, so it could not be deleted"),!1;throw g.createFileSystemError(e.code||p,e.message)}throw e}}getFilePath(){return this.filePath}async reloadNecessary(e){return e<await this.timeLastModified()}getLogger(){return this.logger}createForPersistenceValidation(){const e=`${(0,w.dirname)(this.filePath)}/test.cache`;return T.create(e)}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:S.Info}}async timeLastModified(){try{return(await n.promises.stat(this.filePath)).mtime.getTime()}catch(e){if(m(e)){if(e.code===s)return this.logger.verbose("Cache file does not exist"),0;throw g.createFileSystemError(e.code||p,e.message)}throw e}}async createCacheFile(){await this.createFileDirectory();const e=await n.promises.open(this.filePath,"a");await e.close(),this.logger.info(`File created at ${this.filePath}`)}async createFileDirectory(){try{await n.promises.mkdir((0,w.dirname)(this.filePath),{recursive:!0})}catch(e){if(!m(e))throw e;if(e.code!==o)throw g.createFileSystemError(e.code||p,e.message);this.logger.info(`Directory ${(0,w.dirname)(this.filePath)}  already exists`)}}}const _=require("module");class b{constructor(e){this.errorMessage=e}protectData(){throw new Error(this.errorMessage)}unprotectData(){throw new Error(this.errorMessage)}}let k;if("win32"!==process.platform)k=new b("Dpapi is not supported on this platform");else{const e="undefined"!=typeof require?require:(0,_.createRequire)("file:///mnt/vss/_work/1/s/extensions/microsoft-authentication/node_modules/@azure/msal-node-extensions/dist/Dpapi.mjs");try{k=e(`../bin/${process.arch}/dpapi`)}catch(e){k=new b("Dpapi bindings unavailable")}}const P={CurrentUser:"CurrentUser",LocalMachine:"LocalMachine"};class R extends C{constructor(e,t,r){super(),this.scope=t,this.optionalEntropy=r?Buffer.from(r,"utf-8"):null,this.filePersistence=e}static async create(e,t,r,n){const i=await T.create(e,n);return new R(i,t,r)}async save(e){try{const t=k.protectData(Buffer.from(e,"utf-8"),this.optionalEntropy,this.scope.toString());await this.filePersistence.saveBuffer(t)}catch(e){throw m(e)?g.createFilePersistenceWithDPAPIError(e.message):e}}async load(){try{const e=await this.filePersistence.loadBuffer();return void 0!==e&&e&&0!==e.length?k.unprotectData(e,this.optionalEntropy,this.scope.toString()).toString():(this.filePersistence.getLogger().info("Encrypted contents loaded from file were null or empty"),null)}catch(e){throw m(e)?g.createFilePersistenceWithDPAPIError(e.message):e}}async delete(){return this.filePersistence.delete()}async reloadNecessary(e){return this.filePersistence.reloadNecessary(e)}getFilePath(){return this.filePersistence.getFilePath()}getLogger(){return this.filePersistence.getLogger()}createForPersistenceValidation(){const e=`${(0,w.dirname)(this.filePersistence.getFilePath())}/test.cache`;return R.create(e,P.CurrentUser)}}var O=r(9008);class M extends C{constructor(e,t,r){super(),this.filePersistence=e,this.serviceName=t,this.accountName=r}static async create(e,t,r,n){const i=await T.create(e,n);return new M(i,t,r)}async save(e){try{await O.setPassword(this.serviceName,this.accountName,e)}catch(e){throw m(e)?g.createKeychainPersistenceError(e.message):e}await this.filePersistence.save("{}")}async load(){try{return await O.getPassword(this.serviceName,this.accountName)}catch(e){throw m(e)?g.createKeychainPersistenceError(e.message):e}}async delete(){try{return await this.filePersistence.delete(),await O.deletePassword(this.serviceName,this.accountName)}catch(e){throw m(e)?g.createKeychainPersistenceError(e.message):e}}async reloadNecessary(e){return this.filePersistence.reloadNecessary(e)}getFilePath(){return this.filePersistence.getFilePath()}getLogger(){return this.filePersistence.getLogger()}createForPersistenceValidation(){const e=`${(0,w.dirname)(this.filePersistence.getFilePath())}/test.cache`;return M.create(e,"persistenceValidationServiceName","persistencValidationAccountName")}}class x extends C{constructor(e,t,r){super(),this.filePersistence=e,this.serviceName=t,this.accountName=r}static async create(e,t,r,n){const i=await T.create(e,n);return new x(i,t,r)}async save(e){try{await O.setPassword(this.serviceName,this.accountName,e)}catch(e){throw m(e)?g.createLibSecretError(e.message):e}await this.filePersistence.save("{}")}async load(){try{return await O.getPassword(this.serviceName,this.accountName)}catch(e){throw m(e)?g.createLibSecretError(e.message):e}}async delete(){try{return await this.filePersistence.delete(),await O.deletePassword(this.serviceName,this.accountName)}catch(e){throw m(e)?g.createLibSecretError(e.message):e}}async reloadNecessary(e){return this.filePersistence.reloadNecessary(e)}getFilePath(){return this.filePersistence.getFilePath()}getLogger(){return this.filePersistence.getLogger()}createForPersistenceValidation(){const e=`${(0,w.dirname)(this.filePersistence.getFilePath())}/test.cache`;return x.create(e,"persistenceValidationServiceName","persistencValidationAccountName")}}class N{static get homeEnvVar(){return this.getEnvironmentVariable(c)}static get lognameEnvVar(){return this.getEnvironmentVariable(u)}static get userEnvVar(){return this.getEnvironmentVariable(l)}static get lnameEnvVar(){return this.getEnvironmentVariable(d)}static get usernameEnvVar(){return this.getEnvironmentVariable(h)}static getEnvironmentVariable(e){return process.env[e]||""}static getEnvironmentPlatform(){return process.platform}static isWindowsPlatform(){return"win32"===this.getEnvironmentPlatform()}static isLinuxPlatform(){return"linux"===this.getEnvironmentPlatform()}static isMacPlatform(){return"darwin"===this.getEnvironmentPlatform()}static isLinuxRootUser(){return"function"==typeof process.getuid&&0===process.getuid()}static getUserRootDirectory(){return this.isWindowsPlatform()?this.getUserHomeDirOnWindows():this.getUserHomeDirOnUnix()}static getUserHomeDirOnWindows(){return this.getEnvironmentVariable(f)}static getUserHomeDirOnUnix(){if(this.isWindowsPlatform())throw g.createNotSupportedError("Getting the user home directory for unix is not supported in windows");if(this.homeEnvVar)return this.homeEnvVar;let e=null;if(this.lognameEnvVar?e=this.lognameEnvVar:this.userEnvVar?e=this.userEnvVar:this.lnameEnvVar?e=this.lnameEnvVar:this.usernameEnvVar&&(e=this.usernameEnvVar),this.isMacPlatform())return e?w.join("/Users",e):null;if(this.isLinuxPlatform())return this.isLinuxRootUser()?"/root":e?w.join("/home",e):null;throw g.createNotSupportedError("Getting the user home directory for unix is not supported in windows")}}class D{static async createPersistence(e){let t;if(N.isWindowsPlatform()){if(!e.cachePath||!e.dataProtectionScope)throw g.createPersistenceNotValidatedError("Cache path and/or data protection scope not provided for the FilePersistenceWithDataProtection cache plugin");t=await R.create(e.cachePath,P.CurrentUser,void 0,e.loggerOptions)}else if(N.isMacPlatform()){if(!e.cachePath||!e.serviceName||!e.accountName)throw g.createPersistenceNotValidatedError("Cache path, service name and/or account name not provided for the KeychainPersistence cache plugin");t=await M.create(e.cachePath,e.serviceName,e.accountName,e.loggerOptions)}else{if(!N.isLinuxPlatform())throw g.createNotSupportedError("The current environment is not supported by msal-node-extensions yet.");if(!e.cachePath||!e.serviceName||!e.accountName)throw g.createPersistenceNotValidatedError("Cache path, service name and/or account name not provided for the LibSecretPersistence cache plugin");t=await x.create(e.cachePath,e.serviceName,e.accountName,e.loggerOptions)}return await t.verifyPersistence().catch((async r=>{if(N.isLinuxPlatform()&&e.usePlaintextFileOnLinux){if(!e.cachePath)throw g.createPersistenceNotValidatedError("Cache path not provided for the FilePersistence cache plugin");if(t=await T.create(e.cachePath,e.loggerOptions),await t.verifyPersistence())return t;throw g.createPersistenceNotVerifiedError("Persistence could not be verified")}throw r})),t}}var L,U,F=["win32"],q=["x64","ia32"];!function(e){e[e.Unexpected=0]="Unexpected",e[e.Reserved=1]="Reserved",e[e.InteractionRequired=2]="InteractionRequired",e[e.NoNetwork=3]="NoNetwork",e[e.NetworkTemporarilyUnavailable=4]="NetworkTemporarilyUnavailable",e[e.ServerTemporarilyUnavailable=5]="ServerTemporarilyUnavailable",e[e.ApiContractViolation=6]="ApiContractViolation",e[e.UserCanceled=7]="UserCanceled",e[e.ApplicationCanceled=8]="ApplicationCanceled",e[e.IncorrectConfiguration=9]="IncorrectConfiguration",e[e.InsufficientBuffer=10]="InsufficientBuffer",e[e.AuthorityUntrusted=11]="AuthorityUntrusted",e[e.UserSwitched=12]="UserSwitched",e[e.AccountUnusable=13]="AccountUnusable",e[e.UserDataRemovalRequired=14]="UserDataRemovalRequired",e[e.KeyNotFound=15]="KeyNotFound",e[e.AccountNotFound=16]="AccountNotFound"}(L||(L={})),function(e){e[e.Trace=1]="Trace",e[e.Debug=2]="Debug",e[e.Info=3]="Info",e[e.Warning=4]="Warning",e[e.Error=5]="Error",e[e.Fatal=6]="Fatal"}(U||(U={}));var H={errorCode:0,errorStatus:L.Unexpected,errorContext:"Platform and/or architecture are unsupported. Supported Platforms: ".concat(F.join(", "),". Supported Architectures: ").concat(q.join(", "),"."),errorTag:0},j={errorCode:0,errorStatus:L.Unexpected,errorContext:"Binaries could not be loaded. This is unexpected.",errorTag:0};function B(){return F.includes(process.platform)&&q.includes(process.arch)?j:H}var $,z=function(){function e(){}return e.prototype.CreateAuthParameters=function(){throw B()},e.prototype.SetRedirectUri=function(){throw B()},e.prototype.SetRequestedScopes=function(){throw B()},e.prototype.SetDecodedClaims=function(){throw B()},e.prototype.SetAccessTokenToRenew=function(){throw B()},e.prototype.SetPopParams=function(){throw B()},e.prototype.SetAdditionalParameter=function(){throw B()},e}(),V=function(){function e(){this.AuthParameters=z,this.StartupError=B()}return e.prototype.ReadAccountByIdAsync=function(){throw B()},e.prototype.SignInAsync=function(){throw B()},e.prototype.SignInSilentlyAsync=function(){throw B()},e.prototype.SignInInteractivelyAsync=function(){throw B()},e.prototype.AcquireTokenSilentlyAsync=function(){throw B()},e.prototype.AcquireTokenInteractivelyAsync=function(){throw B()},e.prototype.SignOutSilentlyAsync=function(){throw B()},e.prototype.RegisterLogger=function(){throw B()},e.prototype.DiscoverAccountsAsync=function(){throw B()},e}();try{$=r(7247)}catch(e){$=new V}class K extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,K.prototype),this.errorCode=e||I,this.errorMessage=t||I,this.subError=r||I,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}class G extends K{constructor(e,t,r,n){super(e,t),this.name="NativeAuthError",this.statusCode=r,this.tag=n,Object.setPrototypeOf(this,G.prototype)}}const W="@azure/msal-node-extensions",X="1.5.0",Y="no_account_found",Q="no_network_connectivity",J="user_canceled",Z={client_info_decoding_error:"The client info could not be parsed/decoded correctly",client_info_empty_error:"The client info was empty",token_parsing_error:"Token cannot be parsed",null_or_empty_token:"The token is null or empty",endpoints_resolution_error:"Endpoints cannot be resolved",network_error:"Network request failed",openid_config_error:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",hash_not_deserialized:"The hash parameters could not be deserialized",invalid_state:"State was not the expected format",state_mismatch:"State mismatch error",state_not_found:"State not found",nonce_mismatch:"Nonce mismatch error",auth_time_not_found:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",max_age_transpired:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",multiple_matching_tokens:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",multiple_matching_accounts:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",multiple_matching_appMetadata:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",request_cannot_be_made:"Token request cannot be made without authorization code or refresh token.",cannot_remove_empty_scope:"Cannot remove null or empty scope from ScopeSet",cannot_append_scopeset:"Cannot append ScopeSet",empty_input_scopeset:"Empty input ScopeSet cannot be processed",device_code_polling_cancelled:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",device_code_expired:"Device code is expired.",device_code_unknown_error:"Device code stopped polling for unknown reasons.",no_account_in_silent_request:"Please pass an account object, silent flow is not supported without account information",invalid_cache_record:"Cache record object was null or undefined.",invalid_cache_environment:"Invalid environment when attempting to create cache entry",[Y]:"No account found in cache for given key.",no_crypto_object:"No crypto object detected.",unexpected_credential_type:"Unexpected credential type.",invalid_assertion:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",invalid_client_credential:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",token_refresh_required:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",user_timeout_reached:"User defined timeout for device code polling reached",token_claims_cnf_required_for_signedjwt:"Cannot generate a POP jwt if the token_claims are not populated",authorization_code_missing_from_server_response:"Server response does not contain an authorization code to proceed",binding_key_not_removed:"Could not remove the credential's binding key from storage.",end_session_endpoint_not_supported:"The provided authority does not support logout",key_id_missing:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Q]:"No network connectivity. Check your internet connection.",[J]:"User cancelled the flow.",missing_tenant_id_error:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",method_not_implemented:"This method has not been implemented",nested_app_auth_bridge_disabled:"The nested app auth bridge is disabled"};class ee extends K{constructor(e,t){super(e,t?`${Z[e]}: ${t}`:Z[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,ee.prototype)}}function te(e,t){return new ee(e,t)}class re{constructor(e,t){this.cacheOutcome="0",this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||I,this.wrapperVer=e.wrapperVer||I,this.telemetryCacheKey=A.CACHE_KEY+"-"+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${A.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(A.VALUE_SEPARATOR),i=[e,this.getRegionDiscoveryFields()].join(A.VALUE_SEPARATOR);return[A.SCHEMA_VERSION,i,n].join(A.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=re.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(A.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(A.VALUE_SEPARATOR),i=e.errors.length,o=[i,t<i?A.OVERFLOW_TRUE:A.OVERFLOW_FALSE].join(A.VALUE_SEPARATOR);return[A.SCHEMA_VERSION,e.cacheHits,r,n,o].join(A.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=A.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof K?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(A.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=re.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const i=e.errors.length;for(t=0;t<i;t++){const i=e.failedRequests[2*t]||I,o=e.failedRequests[2*t+1]||I,s=e.errors[t]||I;if(n+=i.toString().length+o.toString().length+s.length+3,!(n<A.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||I),e.push(this.regionSource||I),e.push(this.regionOutcome||I),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return function(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:i,extensionVersion:o}=e,s=new Map([[0,[r,n]],[2,[i,o]]]);let a=[];if(t?.length){if(a=t.split(","),a.length<4)return t}else a=Array.from({length:4},(()=>"|"));return s.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:i}=e;r>=t.length||(t[r]=[n,i].join("|"))}({skuArr:a,index:t,skuName:e[0],skuVersion:e[1]})})),a.join(",")}(e)}}const ne="untrusted_authority",ie={redirect_uri_empty:"A redirect URI is required for all calls, and none has been set.",claims_request_parsing_error:"Could not parse the given claims request object.",authority_uri_insecure:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",url_parse_error:"URL could not be parsed into appropriate segments.",empty_url_error:"URL was empty or null.",empty_input_scopes_error:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",invalid_prompt_value:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",invalid_claims:"Given claims parameter must be a stringified JSON object.",token_request_empty:"Token request was empty and not found in cache.",logout_request_empty:"The logout request was null or undefined.",invalid_code_challenge_method:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',pkce_params_missing:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",invalid_cloud_discovery_metadata:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",invalid_authority_metadata:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[ne]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",missing_ssh_jwk:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",missing_ssh_kid:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",missing_nonce_authentication_header:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",invalid_authentication_header:"Invalid authentication header provided",cannot_set_OIDCOptions:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",cannot_allow_native_broker:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",authority_mismatch:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class oe extends K{constructor(e){super(e,ie[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,oe.prototype)}}class se extends K{constructor(e,t,r,n,i){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=i,Object.setPrototypeOf(this,se.prototype)}}class ae extends K{constructor(e,t,r,n,i,o,s,a){super(e,t,r),Object.setPrototypeOf(this,ae.prototype),this.timestamp=n||I,this.traceId=i||I,this.correlationId=o||I,this.claims=s||I,this.name="InteractionRequiredAuthError",this.errorNo=a}}const ce="x-client-xtra-sku";class ue{constructor(){this.logger=new E({loggerCallback:()=>{},piiLoggingEnabled:!1},W,X),this.isBrokerAvailable=!$.StartupError}setLogger(e){this.logger=new E(e,W,X);const t=(e,t,r)=>{switch(t){case U.Trace:case U.Debug:r?this.logger.tracePii(e):this.logger.trace(e);break;case U.Info:r?this.logger.infoPii(e):this.logger.info(e);break;case U.Warning:r?this.logger.warningPii(e):this.logger.warning(e);break;case U.Error:case U.Fatal:r?this.logger.errorPii(e):this.logger.error(e);break;default:r?this.logger.infoPii(e):this.logger.info(e)}};try{$.RegisterLogger(t,e.piiLoggingEnabled||!1)}catch(e){const t=this.wrapError(e);if(t)throw t}}async getAccountById(e,t){this.logger.trace("NativeBrokerPlugin - getAccountById called",t);const r=await this.readAccountById(e,t);return this.generateAccountInfo(r.account)}async getAllAccounts(e,t){return this.logger.trace("NativeBrokerPlugin - getAllAccounts called",t),new Promise(((r,n)=>{const i=e=>{try{e.CheckError()}catch(e){const t=this.wrapError(e);if(t)return void n(t)}const t=[];e.accounts.forEach((e=>{t.push(this.generateAccountInfo(e))})),r(t)};try{$.DiscoverAccountsAsync(e,t,i)}catch(e){const t=this.wrapError(e);t&&n(t)}}))}async acquireTokenSilent(e){this.logger.trace("NativeBrokerPlugin - acquireTokenSilent called",e.correlationId);const t=this.generateRequestParameters(e),r=await this.getAccount(e);return new Promise(((n,i)=>{const o=t=>{try{t.CheckError()}catch(e){const t=this.wrapError(e);if(t)return void i(t)}const r=this.getAuthenticationResult(e,t);n(r)};try{r?$.AcquireTokenSilentlyAsync(t,e.correlationId,r,o):$.SignInSilentlyAsync(t,e.correlationId,o)}catch(e){const t=this.wrapError(e);t&&i(t)}}))}async acquireTokenInteractive(e,t){this.logger.trace("NativeBrokerPlugin - acquireTokenInteractive called",e.correlationId);const r=this.generateRequestParameters(e),n=await this.getAccount(e),i=t||Buffer.from([0]);return new Promise(((t,o)=>{const s=r=>{try{r.CheckError()}catch(e){const t=this.wrapError(e);if(t)return void o(t)}const n=this.getAuthenticationResult(e,r);t(n)};try{switch(e.prompt){case"login":case"select_account":case"create":this.logger.info("Calling native interop SignInInteractively API",e.correlationId);const t=e.loginHint||I;$.SignInInteractivelyAsync(i,r,e.correlationId,t,s);break;case"none":n?(this.logger.info("Calling native interop AcquireTokenSilently API",e.correlationId),$.AcquireTokenSilentlyAsync(r,e.correlationId,n,s)):(this.logger.info("Calling native interop SignInSilently API",e.correlationId),$.SignInSilentlyAsync(r,e.correlationId,s));break;default:if(n)this.logger.info("Calling native interop AcquireTokenInteractively API",e.correlationId),$.AcquireTokenInteractivelyAsync(i,r,e.correlationId,n,s);else{this.logger.info("Calling native interop SignIn API",e.correlationId);const t=e.loginHint||I;$.SignInAsync(i,r,e.correlationId,t,s)}}}catch(e){const t=this.wrapError(e);t&&o(t)}}))}async signOut(e){this.logger.trace("NativeBrokerPlugin - signOut called",e.correlationId);const t=await this.getAccount(e);if(!t)throw te(Y);return new Promise(((r,n)=>{const i=e=>{try{e.CheckError()}catch(e){const t=this.wrapError(e);if(t)return void n(t)}r()};try{$.SignOutSilentlyAsync(e.clientId,e.correlationId,t,i)}catch(e){const t=this.wrapError(e);t&&n(t)}}))}async getAccount(e){return e.accountId?(await this.readAccountById(e.accountId,e.correlationId)).account:null}async readAccountById(e,t){return this.logger.trace("NativeBrokerPlugin - readAccountById called",t),new Promise(((r,n)=>{const i=e=>{try{e.CheckError()}catch(e){const t=this.wrapError(e);if(t)return void n(t)}r(e)};try{$.ReadAccountByIdAsync(e,t,i)}catch(e){const t=this.wrapError(e);t&&n(t)}}))}generateRequestParameters(e){this.logger.trace("NativeBrokerPlugin - generateRequestParameters called",e.correlationId);const t=new $.AuthParameters;try{if(t.CreateAuthParameters(e.clientId,e.authority),t.SetRedirectUri(e.redirectUri),t.SetRequestedScopes(e.scopes.join(" ")),e.claims&&t.SetDecodedClaims(e.claims),"pop"===e.authenticationScheme){if(!e.resourceRequestMethod||!e.resourceRequestUri)throw new Error("Authentication Scheme set to POP but one or more of the following parameters are missing: resourceRequestMethod, resourceRequestUri");const r=new URL(e.resourceRequestUri);t.SetPopParams(e.resourceRequestMethod,r.host,r.pathname,e.shrNonce||"")}e.extraParameters&&Object.entries(e.extraParameters).forEach((([e,r])=>{t.SetAdditionalParameter(e,r)}));const r=e.extraParameters&&e.extraParameters[ce]?.length?e.extraParameters[ce]:"";t.SetAdditionalParameter(ce,re.makeExtraSkuString({skus:r,extensionName:"msal.node.ext",extensionVersion:X}))}catch(e){const t=this.wrapError(e);if(t)throw t}return t}getAuthenticationResult(e,t){this.logger.trace("NativeBrokerPlugin - getAuthenticationResult called",e.correlationId);let r,n=!1;try{n=!!JSON.parse(t.telemetryData).is_cache}catch(t){this.logger.error("NativeBrokerPlugin: getAuthenticationResult - Error parsing telemetry data. Could not determine if response came from cache.",e.correlationId)}try{r=JSON.parse(t.idToken)}catch(e){throw new Error("Unable to parse idToken claims")}const i=this.generateAccountInfo(t.account,r);let o,s;return t.isPopAuthorization?(o=t.authorizationHeader.split(" ")[1],s="pop"):(o=t.accessToken,s="Bearer"),{authority:e.authority,uniqueId:r.oid||r.sub||"",tenantId:r.tid||"",scopes:t.grantedScopes.split(" "),account:i,idToken:t.rawIdToken,idTokenClaims:r,accessToken:o,fromCache:n,expiresOn:new Date(t.expiresOn),tokenType:s,correlationId:e.correlationId,fromNativeBroker:!0}}generateAccountInfo(e,t){return this.logger.trace("NativeBrokerPlugin - generateAccountInfo called"),{homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.realm,username:e.username,localAccountId:e.localAccountId,name:e.displayName,idTokenClaims:t,nativeAccountId:e.accountId}}isMsalRuntimeError(e){return e.hasOwnProperty("errorCode")||e.hasOwnProperty("errorStatus")||e.hasOwnProperty("errorContext")||e.hasOwnProperty("errorTag")}wrapError(e){if(e&&"object"==typeof e&&this.isMsalRuntimeError(e)){const{errorCode:t,errorStatus:r,errorContext:n,errorTag:i}=e;switch(r){case L.InteractionRequired:case L.AccountUnusable:return new ae("interaction_required",n);case L.NoNetwork:case L.NetworkTemporarilyUnavailable:return te(Q);case L.ServerTemporarilyUnavailable:return new se("server_unavailable",n);case L.UserCanceled:return te(J);case L.AuthorityUntrusted:return function(e){return new oe(e)}(ne);case L.UserSwitched:return null;case L.AccountNotFound:return te(Y);default:return new G(L[r],n,t,i)}}throw e}}},341:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AuthError:()=>$,AuthErrorCodes:()=>n,AuthErrorMessage:()=>B,AzureCloudInstance:()=>jr,ClientApplication:()=>Ao,ClientAssertion:()=>yo,ClientAuthError:()=>Le,ClientAuthErrorCodes:()=>i,ClientAuthErrorMessage:()=>De,ClientConfigurationError:()=>Lt,ClientConfigurationErrorCodes:()=>o,ClientConfigurationErrorMessage:()=>Dt,ClientCredentialClient:()=>_o,ConfidentialClientApplication:()=>ko,CryptoProvider:()=>co,DeviceCodeClient:()=>Eo,DistributedCachePlugin:()=>Ko,InteractionRequiredAuthError:()=>Jn,InteractionRequiredAuthErrorCodes:()=>a,InteractionRequiredAuthErrorMessage:()=>Qn,LogLevel:()=>qr,Logger:()=>Hr,ManagedIdentityApplication:()=>Vo,ManagedIdentitySourceNames:()=>hr,NodeStorage:()=>uo,OnBehalfOfClient:()=>bo,PromptValue:()=>w,ProtocolMode:()=>ze,PublicClientApplication:()=>To,ResponseMode:()=>I,ServerError:()=>Fr,TokenCache:()=>mo,TokenCacheContext:()=>ni,UsernamePasswordClient:()=>Io,internals:()=>s,version:()=>Co});var n={};r.r(n),r.d(n,{postRequestFailed:()=>H,unexpectedError:()=>q});var i={};r.r(i),r.d(i,{authTimeNotFound:()=>re,authorizationCodeMissingFromServerResponse:()=>Te,bindingKeyNotRemoved:()=>_e,cannotAppendScopeSet:()=>ue,cannotRemoveEmptyScope:()=>ce,clientInfoDecodingError:()=>z,clientInfoEmptyError:()=>V,deviceCodeExpired:()=>he,deviceCodePollingCancelled:()=>de,deviceCodeUnknownError:()=>fe,emptyInputScopeSet:()=>le,endSessionEndpointNotSupported:()=>be,endpointResolutionError:()=>W,hashNotDeserialized:()=>Q,invalidAssertion:()=>Ce,invalidCacheEnvironment:()=>me,invalidCacheRecord:()=>ge,invalidClientCredential:()=>Ie,invalidState:()=>J,keyIdMissing:()=>ke,maxAgeTranspired:()=>ne,methodNotImplemented:()=>Me,missingTenantIdError:()=>Oe,multipleMatchingAccounts:()=>oe,multipleMatchingAppMetadata:()=>se,multipleMatchingTokens:()=>ie,nestedAppAuthBridgeDisabled:()=>xe,networkError:()=>X,noAccountFound:()=>ve,noAccountInSilentRequest:()=>pe,noCryptoObject:()=>ye,noNetworkConnectivity:()=>Pe,nonceMismatch:()=>te,nullOrEmptyToken:()=>G,openIdConfigError:()=>Y,requestCannotBeMade:()=>ae,stateMismatch:()=>Z,stateNotFound:()=>ee,tokenClaimsCnfRequiredForSignedJwt:()=>Ee,tokenParsingError:()=>K,tokenRefreshRequired:()=>Ae,unexpectedCredentialType:()=>we,userCanceled:()=>Re,userTimeoutReached:()=>Se});var o={};r.r(o),r.d(o,{authorityMismatch:()=>xt,authorityUriInsecure:()=>pt,cannotAllowNativeBroker:()=>Mt,cannotSetOIDCOptions:()=>Ot,claimsRequestParsingError:()=>ft,emptyInputScopesError:()=>vt,invalidAuthenticationHeader:()=>Rt,invalidAuthorityMetadata:()=>Tt,invalidClaims:()=>wt,invalidCloudDiscoveryMetadata:()=>Et,invalidCodeChallengeMethod:()=>At,invalidPromptValue:()=>yt,logoutRequestEmpty:()=>It,missingNonceAuthenticationHeader:()=>Pt,missingSshJwk:()=>bt,missingSshKid:()=>kt,pkceParamsMissing:()=>St,redirectUriEmpty:()=>ht,tokenRequestEmpty:()=>Ct,untrustedAuthority:()=>_t,urlEmptyError:()=>mt,urlParseError:()=>gt});var s={};r.r(s),r.d(s,{Deserializer:()=>tr,Serializer:()=>c});var a={};r.r(a),r.d(a,{badToken:()=>Gn,consentRequired:()=>Vn,interactionRequired:()=>zn,loginRequired:()=>Kn,nativeAccountUnavailable:()=>Bn,noTokensFound:()=>jn,refreshTokenExpired:()=>$n});class c{static serializeJSONBlob(e){return JSON.stringify(e)}static serializeAccounts(e){const t={};return Object.keys(e).map((function(r){const n=e[r];t[r]={home_account_id:n.homeAccountId,environment:n.environment,realm:n.realm,local_account_id:n.localAccountId,username:n.username,authority_type:n.authorityType,name:n.name,client_info:n.clientInfo,last_modification_time:n.lastModificationTime,last_modification_app:n.lastModificationApp,tenantProfiles:n.tenantProfiles?.map((e=>JSON.stringify(e)))}})),t}static serializeIdTokens(e){const t={};return Object.keys(e).map((function(r){const n=e[r];t[r]={home_account_id:n.homeAccountId,environment:n.environment,credential_type:n.credentialType,client_id:n.clientId,secret:n.secret,realm:n.realm}})),t}static serializeAccessTokens(e){const t={};return Object.keys(e).map((function(r){const n=e[r];t[r]={home_account_id:n.homeAccountId,environment:n.environment,credential_type:n.credentialType,client_id:n.clientId,secret:n.secret,realm:n.realm,target:n.target,cached_at:n.cachedAt,expires_on:n.expiresOn,extended_expires_on:n.extendedExpiresOn,refresh_on:n.refreshOn,key_id:n.keyId,token_type:n.tokenType,requestedClaims:n.requestedClaims,requestedClaimsHash:n.requestedClaimsHash,userAssertionHash:n.userAssertionHash}})),t}static serializeRefreshTokens(e){const t={};return Object.keys(e).map((function(r){const n=e[r];t[r]={home_account_id:n.homeAccountId,environment:n.environment,credential_type:n.credentialType,client_id:n.clientId,secret:n.secret,family_id:n.familyId,target:n.target,realm:n.realm}})),t}static serializeAppMetadata(e){const t={};return Object.keys(e).map((function(r){const n=e[r];t[r]={client_id:n.clientId,environment:n.environment,family_id:n.familyId}})),t}static serializeAllCache(e){return{Account:this.serializeAccounts(e.accounts),IdToken:this.serializeIdTokens(e.idTokens),AccessToken:this.serializeAccessTokens(e.accessTokens),RefreshToken:this.serializeRefreshTokens(e.refreshTokens),AppMetadata:this.serializeAppMetadata(e.appMetadata)}}}const u={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},l=[u.OPENID_SCOPE,u.PROFILE_SCOPE,u.OFFLINE_ACCESS_SCOPE],d=[...l,u.EMAIL_SCOPE],h="Content-Type",f="Retry-After",p="X-AnchorMailbox",g="x-ms-request-id",m="x-ms-httpver",v={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},y="access_token",w={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},C={PLAIN:"plain",S256:"S256"},I={QUERY:"query",FRAGMENT:"fragment",FORM_POST:"form_post"},A="Generic",S={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},E={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},T="appmetadata",_="1",b="authority-metadata",k="config",P="cache",R="network",O="hardcoded_values",M={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},x={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},N="throttling",D="0",L="2",U="3",F="4",q="unexpected_error",H="post_request_failed",j={[q]:"Unexpected error in authentication.",[H]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},B={unexpectedError:{code:q,desc:j[q]},postRequestFailed:{code:H,desc:j[H]}};class $ extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,$.prototype),this.errorCode=e||u.EMPTY_STRING,this.errorMessage=t||u.EMPTY_STRING,this.subError=r||u.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}const z="client_info_decoding_error",V="client_info_empty_error",K="token_parsing_error",G="null_or_empty_token",W="endpoints_resolution_error",X="network_error",Y="openid_config_error",Q="hash_not_deserialized",J="invalid_state",Z="state_mismatch",ee="state_not_found",te="nonce_mismatch",re="auth_time_not_found",ne="max_age_transpired",ie="multiple_matching_tokens",oe="multiple_matching_accounts",se="multiple_matching_appMetadata",ae="request_cannot_be_made",ce="cannot_remove_empty_scope",ue="cannot_append_scopeset",le="empty_input_scopeset",de="device_code_polling_cancelled",he="device_code_expired",fe="device_code_unknown_error",pe="no_account_in_silent_request",ge="invalid_cache_record",me="invalid_cache_environment",ve="no_account_found",ye="no_crypto_object",we="unexpected_credential_type",Ce="invalid_assertion",Ie="invalid_client_credential",Ae="token_refresh_required",Se="user_timeout_reached",Ee="token_claims_cnf_required_for_signedjwt",Te="authorization_code_missing_from_server_response",_e="binding_key_not_removed",be="end_session_endpoint_not_supported",ke="key_id_missing",Pe="no_network_connectivity",Re="user_canceled",Oe="missing_tenant_id_error",Me="method_not_implemented",xe="nested_app_auth_bridge_disabled",Ne={[z]:"The client info could not be parsed/decoded correctly",[V]:"The client info was empty",[K]:"Token cannot be parsed",[G]:"The token is null or empty",[W]:"Endpoints cannot be resolved",[X]:"Network request failed",[Y]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Q]:"The hash parameters could not be deserialized",[J]:"State was not the expected format",[Z]:"State mismatch error",[ee]:"State not found",[te]:"Nonce mismatch error",[re]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[ne]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[ie]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[oe]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[se]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[ae]:"Token request cannot be made without authorization code or refresh token.",[ce]:"Cannot remove null or empty scope from ScopeSet",[ue]:"Cannot append ScopeSet",[le]:"Empty input ScopeSet cannot be processed",[de]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[he]:"Device code is expired.",[fe]:"Device code stopped polling for unknown reasons.",[pe]:"Please pass an account object, silent flow is not supported without account information",[ge]:"Cache record object was null or undefined.",[me]:"Invalid environment when attempting to create cache entry",[ve]:"No account found in cache for given key.",[ye]:"No crypto object detected.",[we]:"Unexpected credential type.",[Ce]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Ie]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Ae]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Se]:"User defined timeout for device code polling reached",[Ee]:"Cannot generate a POP jwt if the token_claims are not populated",[Te]:"Server response does not contain an authorization code to proceed",[_e]:"Could not remove the credential's binding key from storage.",[be]:"The provided authority does not support logout",[ke]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Pe]:"No network connectivity. Check your internet connection.",[Re]:"User cancelled the flow.",[Oe]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Me]:"This method has not been implemented",[xe]:"The nested app auth bridge is disabled"},De={clientInfoDecodingError:{code:z,desc:Ne[z]},clientInfoEmptyError:{code:V,desc:Ne[V]},tokenParsingError:{code:K,desc:Ne[K]},nullOrEmptyToken:{code:G,desc:Ne[G]},endpointResolutionError:{code:W,desc:Ne[W]},networkError:{code:X,desc:Ne[X]},unableToGetOpenidConfigError:{code:Y,desc:Ne[Y]},hashNotDeserialized:{code:Q,desc:Ne[Q]},invalidStateError:{code:J,desc:Ne[J]},stateMismatchError:{code:Z,desc:Ne[Z]},stateNotFoundError:{code:ee,desc:Ne[ee]},nonceMismatchError:{code:te,desc:Ne[te]},authTimeNotFoundError:{code:re,desc:Ne[re]},maxAgeTranspired:{code:ne,desc:Ne[ne]},multipleMatchingTokens:{code:ie,desc:Ne[ie]},multipleMatchingAccounts:{code:oe,desc:Ne[oe]},multipleMatchingAppMetadata:{code:se,desc:Ne[se]},tokenRequestCannotBeMade:{code:ae,desc:Ne[ae]},removeEmptyScopeError:{code:ce,desc:Ne[ce]},appendScopeSetError:{code:ue,desc:Ne[ue]},emptyInputScopeSetError:{code:le,desc:Ne[le]},DeviceCodePollingCancelled:{code:de,desc:Ne[de]},DeviceCodeExpired:{code:he,desc:Ne[he]},DeviceCodeUnknownError:{code:fe,desc:Ne[fe]},NoAccountInSilentRequest:{code:pe,desc:Ne[pe]},invalidCacheRecord:{code:ge,desc:Ne[ge]},invalidCacheEnvironment:{code:me,desc:Ne[me]},noAccountFound:{code:ve,desc:Ne[ve]},noCryptoObj:{code:ye,desc:Ne[ye]},unexpectedCredentialType:{code:we,desc:Ne[we]},invalidAssertion:{code:Ce,desc:Ne[Ce]},invalidClientCredential:{code:Ie,desc:Ne[Ie]},tokenRefreshRequired:{code:Ae,desc:Ne[Ae]},userTimeoutReached:{code:Se,desc:Ne[Se]},tokenClaimsRequired:{code:Ee,desc:Ne[Ee]},noAuthorizationCodeFromServer:{code:Te,desc:Ne[Te]},bindingKeyNotRemovedError:{code:_e,desc:Ne[_e]},logoutNotSupported:{code:be,desc:Ne[be]},keyIdMissing:{code:ke,desc:Ne[ke]},noNetworkConnectivity:{code:Pe,desc:Ne[Pe]},userCanceledError:{code:Re,desc:Ne[Re]},missingTenantIdError:{code:Oe,desc:Ne[Oe]},nestedAppAuthBridgeDisabled:{code:xe,desc:Ne[xe]}};class Le extends ${constructor(e,t){super(e,t?`${Ne[e]}: ${t}`:Ne[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Le.prototype)}}function Ue(e,t){return new Le(e,t)}function Fe(e,t){if(!e)throw Ue(V);try{const r=t(e);return JSON.parse(r)}catch(e){throw Ue(z)}}function qe(e){if(!e)throw Ue(z);const t=e.split(S.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?u.EMPTY_STRING:t[1]}}function He(e,t){return!!e&&!!t&&e===t.split(".")[1]}function je(e,t,r,n){if(n){const{oid:t,sub:r,tid:i,name:o,tfp:s,acr:a}=n,c=i||s||a||"";return{tenantId:c,localAccountId:t||r||"",name:o,isHomeTenant:He(c,e)}}return{tenantId:r,localAccountId:t,isHomeTenant:He(r,e)}}function Be(e,t,r,n){let i=e;if(t){const{isHomeTenant:r,...n}=t;i={...e,...n}}if(r){const{isHomeTenant:t,...o}=je(e.homeAccountId,e.localAccountId,e.tenantId,r);return i={...i,...o,idTokenClaims:r,idToken:n},i}return i}function $e(e){return e&&(e.tid||e.tfp||e.acr)||null}const ze={AAD:"AAD",OIDC:"OIDC"};class Ve{generateAccountId(){return[this.homeAccountId,this.environment].join(S.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Ve.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map((e=>[e.tenantId,e])))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(S.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){const n=new Ve;let i;1===t.authorityType?n.authorityType="ADFS":t.protocolMode===ze.AAD?n.authorityType="MSSTS":n.authorityType=A,e.clientInfo&&r&&(i=Fe(e.clientInfo,r)),n.clientInfo=e.clientInfo,n.homeAccountId=e.homeAccountId,n.nativeAccountId=e.nativeAccountId;const o=e.environment||t&&t.getPreferredCache();if(!o)throw Ue(me);n.environment=o,n.realm=i?.utid||$e(e.idTokenClaims)||"",n.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,a=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(n.username=s||a||"",n.name=e.idTokenClaims?.name||"",n.cloudGraphHostName=e.cloudGraphHostName,n.msGraphHost=e.msGraphHost,e.tenantProfiles)n.tenantProfiles=e.tenantProfiles;else{const t=je(e.homeAccountId,n.localAccountId,n.realm,e.idTokenClaims);n.tenantProfiles=[t]}return n}static createFromAccountInfo(e,t,r){const n=new Ve;return n.authorityType=e.authorityType||A,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,i){if(1!==t&&2!==t){if(e)try{const t=Fe(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},i=t.idTokenClaims||{};n=r.iat===i.iat&&r.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function Ke(e,t){const r=function(e){if(!e)throw Ue(G);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw Ue(K);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(e){throw Ue(K)}}function Ge(e,t){if(0===t||Date.now()-3e5>e+t)throw Ue(ne)}function We(){return Math.round((new Date).getTime()/1e3)}function Xe(e,t){const r=Number(e)||0;return We()+t>r}function Ye(e,t){return new Promise((r=>setTimeout((()=>r(t)),e)))}function Qe(e){return[rt(e),nt(e),it(e),ot(e),st(e)].join(S.CACHE_KEY_SEPARATOR).toLowerCase()}function Je(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function Ze(e){return!!e&&Je(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===E.ACCESS_TOKEN||e.credentialType===E.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function et(e){return!!e&&Je(e)&&e.hasOwnProperty("realm")&&e.credentialType===E.ID_TOKEN}function tt(e){return!!e&&Je(e)&&e.credentialType===E.REFRESH_TOKEN}function rt(e){return[e.homeAccountId,e.environment].join(S.CACHE_KEY_SEPARATOR).toLowerCase()}function nt(e){const t=e.credentialType===E.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(S.CACHE_KEY_SEPARATOR).toLowerCase()}function it(e){return(e.target||"").toLowerCase()}function ot(e){return(e.requestedClaimsHash||"").toLowerCase()}function st(e){return e.tokenType&&e.tokenType.toLowerCase()!==x.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function at(e,t){return!!t&&0===e.indexOf(T)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")}function ct(){return We()+86400}function ut(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function lt(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function dt(e){return e.expiresAt<=We()}const ht="redirect_uri_empty",ft="claims_request_parsing_error",pt="authority_uri_insecure",gt="url_parse_error",mt="empty_url_error",vt="empty_input_scopes_error",yt="invalid_prompt_value",wt="invalid_claims",Ct="token_request_empty",It="logout_request_empty",At="invalid_code_challenge_method",St="pkce_params_missing",Et="invalid_cloud_discovery_metadata",Tt="invalid_authority_metadata",_t="untrusted_authority",bt="missing_ssh_jwk",kt="missing_ssh_kid",Pt="missing_nonce_authentication_header",Rt="invalid_authentication_header",Ot="cannot_set_OIDCOptions",Mt="cannot_allow_native_broker",xt="authority_mismatch",Nt={[ht]:"A redirect URI is required for all calls, and none has been set.",[ft]:"Could not parse the given claims request object.",[pt]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[gt]:"URL could not be parsed into appropriate segments.",[mt]:"URL was empty or null.",[vt]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[yt]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[wt]:"Given claims parameter must be a stringified JSON object.",[Ct]:"Token request was empty and not found in cache.",[It]:"The logout request was null or undefined.",[At]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[St]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Et]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Tt]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[_t]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[bt]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[kt]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Pt]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Rt]:"Invalid authentication header provided",[Ot]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Mt]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[xt]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},Dt={redirectUriNotSet:{code:ht,desc:Nt[ht]},claimsRequestParsingError:{code:ft,desc:Nt[ft]},authorityUriInsecure:{code:pt,desc:Nt[pt]},urlParseError:{code:gt,desc:Nt[gt]},urlEmptyError:{code:mt,desc:Nt[mt]},emptyScopesError:{code:vt,desc:Nt[vt]},invalidPrompt:{code:yt,desc:Nt[yt]},invalidClaimsRequest:{code:wt,desc:Nt[wt]},tokenRequestEmptyError:{code:Ct,desc:Nt[Ct]},logoutRequestEmptyError:{code:It,desc:Nt[It]},invalidCodeChallengeMethod:{code:At,desc:Nt[At]},invalidCodeChallengeParams:{code:St,desc:Nt[St]},invalidCloudDiscoveryMetadata:{code:Et,desc:Nt[Et]},invalidAuthorityMetadata:{code:Tt,desc:Nt[Tt]},untrustedAuthority:{code:_t,desc:Nt[_t]},missingSshJwk:{code:bt,desc:Nt[bt]},missingSshKid:{code:kt,desc:Nt[kt]},missingNonceAuthenticationHeader:{code:Pt,desc:Nt[Pt]},invalidAuthenticationHeader:{code:Rt,desc:Nt[Rt]},cannotSetOIDCOptions:{code:Ot,desc:Nt[Ot]},cannotAllowNativeBroker:{code:Mt,desc:Nt[Mt]},authorityMismatch:{code:xt,desc:Nt[xt]}};class Lt extends ${constructor(e){super(e,Nt[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Lt.prototype)}}function Ut(e){return new Lt(e)}class Ft{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,i]=e.split(/=(.+)/g,2);r&&i&&(t[n(r)]=n(i))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class qt{constructor(e){const t=e?Ft.trimArrayEntries([...e]):[],r=t?Ft.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||u.EMPTY_STRING).split(" ");return new qt(t)}static createSearchScopes(e){const t=new qt(e);return t.containsOnlyOIDCScopes()?t.removeScope(u.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Ut(vt)}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new qt(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return d.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(e){throw Ue(ue)}}removeScope(e){if(!e)throw Ue(ce);this.scopes.delete(e.trim())}removeOIDCScopes(){d.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw Ue(le);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw Ue(le);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){return this.scopes?this.asArray().join(" "):u.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}const Ht="@azure/msal-common",jt="14.16.0";function Bt(e){if(!e||e.indexOf("=")<0)return null;try{const t=function(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.error||r.error_description||r.state)return r}catch(e){throw Ue(Q)}return null}class $t{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Ut(mt);e.includes("#")||(this._urlString=$t.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Ft.endsWith(t,"?")?t=t.slice(0,-1):Ft.endsWith(t,"?/")&&(t=t.slice(0,-2)),Ft.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw Ut(gt)}if(!e.HostNameAndPort||!e.PathSegments)throw Ut(gt);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Ut(pt)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return $t.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==v.COMMON&&r[0]!==v.ORGANIZATIONS||(r[0]=e),$t.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ut(gt);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let n=r.AbsolutePath.split("/");return n=n.filter((e=>e&&e.length>0)),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Ut(gt);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===u.FORWARD_SLASH){const r=new $t(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new $t(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Bt(e)}}const zt={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},Vt={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},Kt=new Set;function Gt(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){const i=Wt(t,e);if(i)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),i.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function Wt(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}Vt.metadata.forEach((e=>{e.aliases.forEach((e=>{Kt.add(e)}))}));const Xt="cache_quota_exceeded",Yt="cache_error_unknown",Qt={[Xt]:"Exceeded cache storage capacity.",[Yt]:"Unexpected error occurred when using cache storage."};class Jt extends Error{constructor(e,t){const r=t||(Qt[e]?Qt[e]:Qt[Yt]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Jt.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}class Zt{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(Ht,jt),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort((e=>e.idTokenClaims?-1:1))[0]:1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap((e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t)))}getTenantedAccountInfoByFilter(e,t,r,n){let i,o=null;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;const s=this.getIdToken(e,t,r.tenantId);return s&&(i=Ke(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,n))?null:(o=Be(e,r,i,s?.secret),o)}getTenantProfilesFromAccountEntity(e,t,r){const n=e.getAccountInfo();let i=n.tenantProfiles||new Map;const o=this.getTokenKeys();if(t){const e=i.get(t);if(!e)return[];i=new Map([[t,e]])}const s=[];return i.forEach((e=>{const t=this.getTenantedAccountInfoByFilter(n,o,e,r);t&&s.push(t)})),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||void 0!==t.isHomeTenant&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,r){if(!e)throw Ue(ge);try{e.account&&this.setAccount(e.account),e.idToken&&!1!==t?.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&!1!==t?.accessToken&&await this.saveAccessToken(e.accessToken),e.refreshToken&&!1!==t?.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e.message}`,r),"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new Jt(Xt)):new Jt(e.name,e.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e}`,r),new Jt(Yt))}}async saveAccessToken(e){const t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=qt.fromString(e.target),i=[];r.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,t,!1))return;const r=this.getAccessTokenCredential(e);r&&this.credentialMatchesFilter(r,t)&&qt.fromString(r.target).intersectingScopeSets(n)&&i.push(this.removeAccessToken(e))})),await Promise.all(i),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId))return;const n=this.getAccount(t,this.commonLogger);if(!n)return;if(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId))return;if(e.username&&!this.matchUsername(n.username,e.username))return;if(e.environment&&!this.matchEnvironment(n,e.environment))return;if(e.realm&&!this.matchRealm(n,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;const i={localAccountId:e?.localAccountId,name:e?.name},o=n.tenantProfiles?.filter((e=>this.tenantProfileMatchesFilter(e,i)));o&&0===o.length||r.push(n)})),r}isAccountKey(e,t,r){return!(e.split(S.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(S.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(E.ID_TOKEN.toLowerCase())&&-1===t.indexOf(E.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(E.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(E.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(E.REFRESH_TOKEN.toLowerCase())>-1){const e=`${E.REFRESH_TOKEN}${S.CACHE_KEY_SEPARATOR}${this.clientId}${S.CACHE_KEY_SEPARATOR}`,r=`${E.REFRESH_TOKEN}${S.CACHE_KEY_SEPARATOR}${_}${S.CACHE_KEY_SEPARATOR}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===E.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===x.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach((t=>{if(!this.isAppMetadata(t))return;const n=this.getAppMetadata(t);n&&(e.environment&&!this.matchEnvironment(n,e.environment)||e.clientId&&!this.matchClientId(n,e.clientId)||(r[t]=n))})),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await Promise.all(n)}updateOutdatedCachedAccount(e,t,r){if(t&&t.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const n=this.getAccountKeys().filter((e=>e.startsWith(t.homeAccountId))),i=[];n.forEach((e=>{const t=this.getCachedAccountEntity(e);t&&i.push(t)}));const o=i.find((e=>He(e.realm,e.homeAccountId)))||i[0];o.tenantProfiles=i.map((e=>({tenantId:e.realm,localAccountId:e.localAccountId,name:e.name,isHomeTenant:He(e.realm,e.homeAccountId)})));const s=Zt.toObject(new Ve,{...o}),a=s.generateAccountKey();return n.forEach((t=>{t!==a&&this.removeOutdatedAccount(e)})),this.setAccount(s),r?.verbose("Updated an outdated account entity in the cache"),s}return t}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===E.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===x.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw Ue(_e)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readAccountFromCache(e){const t=Ve.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,i){this.commonLogger.trace("CacheManager - getIdToken called");const o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:E.ID_TOKEN,clientId:this.clientId,realm:r},s=this.getIdTokensByFilter(o,t),a=s.size;if(a<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(a>1){let t=s;if(!r){const r=new Map;s.forEach(((t,n)=>{t.realm===e.tenantId&&r.set(n,t)}));const n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach(((e,t)=>{this.removeIdToken(t)})),n&&i&&n.addFields({multiMatchedID:s.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,i,o){this.commonLogger.trace("CacheManager - getAccessToken called");const s=qt.createSearchScopes(t.scopes),a=t.authenticationScheme||x.BEARER,c=a&&a.toLowerCase()!==x.BEARER.toLowerCase()?E.ACCESS_TOKEN_WITH_AUTH_SCHEME:E.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:n||e.tenantId,target:s,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},l=r&&r.accessToken||this.getTokenKeys().accessToken,d=[];l.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,u,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,u)&&d.push(t)}}));const h=d.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),d.forEach((e=>{this.removeAccessToken(Qe(e))})),i&&o&&i.addFields({multiMatchedAT:d.length},o),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),d[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,n,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=t?_:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:E.REFRESH_TOKEN,clientId:this.clientId,familyId:o},a=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];a.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,s)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,s)&&c.push(t)}}));const u=c.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&n&&i&&n.addFields({multiMatchedRT:u},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&-1===r.indexOf(t.familyId.toLowerCase())||!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),i=n.length;if(i<1)return null;if(i>1)throw Ue(se);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==_)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=function(e,t){let r;const n=e.canonicalAuthority;if(n){const i=new $t(n).getUrlComponents().HostNameAndPort;r=Gt(i,e.cloudDiscoveryMetadata?.metadata,k,t)||Gt(i,Vt.metadata,O,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){return!(e.credentialType!==E.ACCESS_TOKEN&&e.credentialType!==E.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&qt.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(T)}isAuthorityMetadata(e){return-1!==e.indexOf(b)}generateAuthorityMetadataCacheKey(e){return`${b}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class er extends Zt{setAccount(){throw Ue(Me)}getAccount(){throw Ue(Me)}getCachedAccountEntity(){throw Ue(Me)}setIdTokenCredential(){throw Ue(Me)}getIdTokenCredential(){throw Ue(Me)}setAccessTokenCredential(){throw Ue(Me)}getAccessTokenCredential(){throw Ue(Me)}setRefreshTokenCredential(){throw Ue(Me)}getRefreshTokenCredential(){throw Ue(Me)}setAppMetadata(){throw Ue(Me)}getAppMetadata(){throw Ue(Me)}setServerTelemetry(){throw Ue(Me)}getServerTelemetry(){throw Ue(Me)}setAuthorityMetadata(){throw Ue(Me)}getAuthorityMetadata(){throw Ue(Me)}getAuthorityMetadataKeys(){throw Ue(Me)}setThrottlingCache(){throw Ue(Me)}getThrottlingCache(){throw Ue(Me)}removeItem(){throw Ue(Me)}getKeys(){throw Ue(Me)}getAccountKeys(){throw Ue(Me)}getTokenKeys(){throw Ue(Me)}updateCredentialCacheKey(){throw Ue(Me)}removeOutdatedAccount(){throw Ue(Me)}}class tr{static deserializeJSONBlob(e){return e?JSON.parse(e):{}}static deserializeAccounts(e){const t={};return e&&Object.keys(e).map((function(r){const n=e[r],i={homeAccountId:n.home_account_id,environment:n.environment,realm:n.realm,localAccountId:n.local_account_id,username:n.username,authorityType:n.authority_type,name:n.name,clientInfo:n.client_info,lastModificationTime:n.last_modification_time,lastModificationApp:n.last_modification_app,tenantProfiles:n.tenantProfiles?.map((e=>JSON.parse(e)))},o=new Ve;Zt.toObject(o,i),t[r]=o})),t}static deserializeIdTokens(e){const t={};return e&&Object.keys(e).map((function(r){const n=e[r],i={homeAccountId:n.home_account_id,environment:n.environment,credentialType:n.credential_type,clientId:n.client_id,secret:n.secret,realm:n.realm};t[r]=i})),t}static deserializeAccessTokens(e){const t={};return e&&Object.keys(e).map((function(r){const n=e[r],i={homeAccountId:n.home_account_id,environment:n.environment,credentialType:n.credential_type,clientId:n.client_id,secret:n.secret,realm:n.realm,target:n.target,cachedAt:n.cached_at,expiresOn:n.expires_on,extendedExpiresOn:n.extended_expires_on,refreshOn:n.refresh_on,keyId:n.key_id,tokenType:n.token_type,requestedClaims:n.requestedClaims,requestedClaimsHash:n.requestedClaimsHash,userAssertionHash:n.userAssertionHash};t[r]=i})),t}static deserializeRefreshTokens(e){const t={};return e&&Object.keys(e).map((function(r){const n=e[r],i={homeAccountId:n.home_account_id,environment:n.environment,credentialType:n.credential_type,clientId:n.client_id,secret:n.secret,familyId:n.family_id,target:n.target,realm:n.realm};t[r]=i})),t}static deserializeAppMetadata(e){const t={};return e&&Object.keys(e).map((function(r){const n=e[r];t[r]={clientId:n.client_id,environment:n.environment,familyId:n.family_id}})),t}static deserializeAllCache(e){return{accounts:e.Account?this.deserializeAccounts(e.Account):{},idTokens:e.IdToken?this.deserializeIdTokens(e.IdToken):{},accessTokens:e.AccessToken?this.deserializeAccessTokens(e.AccessToken):{},refreshTokens:e.RefreshToken?this.deserializeRefreshTokens(e.RefreshToken):{},appMetadata:e.AppMetadata?this.deserializeAppMetadata(e.AppMetadata):{}}}}const rr="Metadata",nr="api-version",ir="resource",or="https://login.microsoftonline.com/managed_identity/",sr="AZURE_POD_IDENTITY_AUTHORITY_HOST",ar="IDENTITY_ENDPOINT",cr="IDENTITY_HEADER",ur="IDENTITY_SERVER_THUMBPRINT",lr="IMDS_ENDPOINT",dr="MSI_ENDPOINT",hr={APP_SERVICE:"AppService",AZURE_ARC:"AzureArc",CLOUD_SHELL:"CloudShell",DEFAULT_TO_IMDS:"DefaultToImds",IMDS:"Imds",SERVICE_FABRIC:"ServiceFabric"},fr="system-assigned",pr="user-assigned-client-id",gr="user-assigned-resource-id",mr="user-assigned-object-id",vr="get",yr="post",wr=200,Cr=299,Ir=500,Ar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",Sr="msal.js.node",Er="urn:ietf:params:oauth:client-assertion-type:jwt-bearer",Tr="authorization_pending",_r="http://",br="localhost",kr=[404,408,429,500,503,504];class Pr{constructor(e,t){this.cacheOutcome=D,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||u.EMPTY_STRING,this.wrapperVer=e.wrapperVer||u.EMPTY_STRING,this.telemetryCacheKey=M.CACHE_KEY+S.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${M.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);const n=t.join(M.VALUE_SEPARATOR),i=[e,this.getRegionDiscoveryFields()].join(M.VALUE_SEPARATOR);return[M.SCHEMA_VERSION,i,n].join(M.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Pr.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(M.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(M.VALUE_SEPARATOR),i=e.errors.length,o=[i,t<i?M.OVERFLOW_TRUE:M.OVERFLOW_FALSE].join(M.VALUE_SEPARATOR);return[M.SCHEMA_VERSION,e.cacheHits,r,n,o].join(M.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=M.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof $?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(M.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Pr.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const i=e.errors.length;for(t=0;t<i;t++){const i=e.failedRequests[2*t]||u.EMPTY_STRING,o=e.failedRequests[2*t+1]||u.EMPTY_STRING,s=e.errors[t]||u.EMPTY_STRING;if(n+=i.toString().length+o.toString().length+s.length+3,!(n<M.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||u.EMPTY_STRING),e.push(this.regionSource||u.EMPTY_STRING),e.push(this.regionOutcome||u.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return function(e){const{skus:t,libraryName:r,libraryVersion:n,extensionName:i,extensionVersion:o}=e,s=new Map([[0,[r,n]],[2,[i,o]]]);let a=[];if(t?.length){if(a=t.split(","),a.length<4)return t}else a=Array.from({length:4},(()=>"|"));return s.forEach(((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:r,skuName:n,skuVersion:i}=e;r>=t.length||(t[r]=[n,i].join("|"))}({skuArr:a,index:t,skuName:e[0],skuVersion:e[1]})})),a.join(",")}(e)}}const Rr="client_id",Or="redirect_uri",Mr="response_type",xr="token_type",Nr="req_cnf",Dr="return_spa_code",Lr="x-client-xtra-sku",Ur="brk_client_id";class Fr extends ${constructor(e,t,r,n,i){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=i,Object.setPrototypeOf(this,Fr.prototype)}}var qr;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(qr||(qr={}));class Hr{constructor(e,t,r){this.level=qr.Info;const n=e||Hr.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:qr.Info,this.correlationId=n.correlationId||u.EMPTY_STRING,this.packageName=t||u.EMPTY_STRING,this.packageVersion=r||u.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:qr.Info}}clone(e,t,r){return new Hr({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${qr[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,r,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:qr.Error,containsPii:!1,correlationId:t||u.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:qr.Error,containsPii:!0,correlationId:t||u.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:qr.Warning,containsPii:!1,correlationId:t||u.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:qr.Warning,containsPii:!0,correlationId:t||u.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:qr.Info,containsPii:!1,correlationId:t||u.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:qr.Info,containsPii:!0,correlationId:t||u.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:qr.Verbose,containsPii:!1,correlationId:t||u.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:qr.Verbose,containsPii:!0,correlationId:t||u.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:qr.Trace,containsPii:!1,correlationId:t||u.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:qr.Trace,containsPii:!0,correlationId:t||u.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const jr={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"},Br="networkClientSendPostRequestAsync",$r="refreshTokenClientExecutePostToTokenEndpoint",zr="authorizationCodeClientExecutePostToTokenEndpoint",Vr="refreshTokenClientExecuteTokenRequest",Kr="refreshTokenClientAcquireToken",Gr="refreshTokenClientAcquireTokenWithCachedRefreshToken",Wr="refreshTokenClientAcquireTokenByRefreshToken",Xr="refreshTokenClientCreateTokenRequestBody",Yr="silentFlowClientAcquireCachedToken",Qr="silentFlowClientGenerateResultFromCacheRecord",Jr="getAuthCodeUrl",Zr="updateTokenEndpointAuthority",en="authClientAcquireToken",tn="authClientExecuteTokenRequest",rn="authClientCreateTokenRequestBody",nn="authClientCreateQueryString",on="popTokenGenerateCnf",sn="popTokenGenerateKid",an="handleServerTokenResponse",cn="authorityFactoryCreateDiscoveredInstance",un="authorityResolveEndpointsAsync",ln="authorityGetCloudDiscoveryMetadataFromNetwork",dn="authorityUpdateCloudDiscoveryMetadata",hn="authorityGetEndpointMetadataFromNetwork",fn="authorityUpdateEndpointMetadata",pn="authorityUpdateMetadataWithRegionalInformation",gn="regionDiscoveryDetectRegion",mn="regionDiscoveryGetRegionFromIMDS",vn="regionDiscoveryGetCurrentVersion",yn="cacheManagerGetRefreshToken",wn=(new Map([["acquireTokenByCode","ATByCode"],["acquireTokenByRefreshToken","ATByRT"],["acquireTokenSilent","ATS"],["acquireTokenSilentAsync","ATSAsync"],["acquireTokenPopup","ATPopup"],["acquireTokenRedirect","ATRedirect"],["cryptoOptsGetPublicKeyThumbprint","CryptoGetPKThumb"],["cryptoOptsSignJwt","CryptoSignJwt"],["silentCacheClientAcquireToken","SltCacheClientAT"],["silentIframeClientAcquireToken","SltIframeClientAT"],["silentRefreshClientAcquireToken","SltRClientAT"],["ssoSilent","SsoSlt"],["standardInteractionClientGetDiscoveredAuthority","StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],["nativeInteractionClientAcquireToken","NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[Br,"NetClientSendPost"],[$r,"RTClientExecPost"],[zr,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[Vr,"RTClientExecTReq"],[Kr,"RTClientAT"],[Gr,"RTClientATWithCachedRT"],[Wr,"RTClientATByRT"],[Xr,"RTClientCreateTReqBody"],["acquireTokenFromCache","ATFromCache"],[Yr,"SltFlowClientATCached"],[Qr,"SltFlowClientGenResFromCache"],["acquireTokenBySilentIframe","ATBySltIframe"],["initializeBaseRequest","InitBaseReq"],["initializeSilentRequest","InitSltReq"],["initializeClientApplication","InitClientApplication"],["silentIframeClientTokenHelper","SIClientTHelper"],["silentHandlerInitiateAuthRequest","SHandlerInitAuthReq"],["silentHandlerMonitorIframeForHash","SltHandlerMonitorIframeForHash"],["silentHandlerLoadFrame","SHandlerLoadFrame"],["silentHandlerLoadFrameSync","SHandlerLoadFrameSync"],["standardInteractionClientCreateAuthCodeClient","StdIntClientCreateAuthCodeClient"],["standardInteractionClientGetClientConfiguration","StdIntClientGetClientConf"],["standardInteractionClientInitializeAuthorizationRequest","StdIntClientInitAuthReq"],["standardInteractionClientInitializeAuthorizationCodeRequest","StdIntClientInitAuthCodeReq"],[Jr,"GetAuthCodeUrl"],["handleCodeResponseFromServer","HandleCodeResFromServer"],["handleCodeResponse","HandleCodeResp"],[Zr,"UpdTEndpointAuth"],[en,"AuthClientAT"],[tn,"AuthClientExecTReq"],[rn,"AuthClientCreateTReqBody"],[nn,"AuthClientCreateQueryStr"],[on,"PopTGenCnf"],[sn,"PopTGenKid"],[an,"HandleServerTRes"],["deserializeResponse","DeserializeRes"],[cn,"AuthFactCreateDiscInst"],[un,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[ln,"AuthGetCDMetaFromNet"],[dn,"AuthUpdCDMeta"],[hn,"AuthUpdCDMetaFromNet"],[fn,"AuthUpdEndpointMeta"],[pn,"AuthUpdMetaWithRegInfo"],[gn,"RegDiscDetectReg"],[mn,"RegDiscGetRegFromIMDS"],[vn,"RegDiscGetCurrentVer"],["acquireTokenByCodeAsync","ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],["handleRedirectPromise","HandleRedirectPromise"],["handleNativeRedirectPromise","HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],["nativeMessageHandlerHandshake","NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],["removeHiddenIframe","RemoveHiddenIframe"],["clearTokensAndKeysWithClaims","ClearTAndKeysWithClaims"],[yn,"CacheManagerGetRT"],["generatePkceCodes","GenPkceCodes"],["generateCodeVerifier","GenCodeVerifier"],["generateCodeChallengeFromVerifier","GenCodeChallengeFromVerifier"],["sha256Digest","Sha256Digest"],["getRandomValues","GetRandomValues"]]),new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"]),(e,t,r,n,i)=>(...o)=>{r.trace(`Executing function ${t}`);const s=n?.startMeasurement(t,i);if(i){const e=t+"CallCount";n?.incrementFields({[e]:1},i)}return n?.setPreQueueTime(t,i),e(...o).then((e=>(r.trace(`Returning result from ${t}`),s?.end({success:!0}),e))).catch((e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw s?.end({success:!1},e),e}))});class Cn{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(gn,this.correlationId);let r=e;if(r)t.region_source="3";else{const e=Cn.IMDS_OPTIONS;try{const n=await wn(this.getRegionFromIMDS.bind(this),mn,this.logger,this.performanceClient,this.correlationId)(u.IMDS_VERSION,e);if(200===n.status&&(r=n.body,t.region_source="4"),400===n.status){const n=await wn(this.getCurrentVersion.bind(this),vn,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source="1",null;const i=await wn(this.getRegionFromIMDS.bind(this),mn,this.logger,this.performanceClient,this.correlationId)(n,e);200===i.status&&(r=i.body,t.region_source="4")}}catch(e){return t.region_source="1",null}}return r||(t.region_source="1"),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(mn,this.correlationId),this.networkInterface.sendGetRequestAsync(`${u.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,u.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(vn,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${u.IMDS_ENDPOINT}?format=json`,e);return 400===t.status&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(e){return null}}}Cn.IMDS_OPTIONS={headers:{Metadata:"true"}};class In{constructor(e,t,r,n,i,o,s,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=o,this.managedIdentity=a||!1,this.regionDiscovery=new Cn(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(u.CIAM_AUTH_URL))return 3;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case u.ADFS:return 1;case u.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new $t(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Ue(W)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Ue(W)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Ue(W)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Ue(be);return this.replacePath(this.metadata.end_session_endpoint)}throw Ue(W)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Ue(W)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Ue(W)}canReplaceTenant(e){return 1===e.PathSegments.length&&!In.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&this.protocolMode===ze.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new $t(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,i)=>{let o=n[i];if(0===i&&this.canReplaceTenant(r)){const e=new $t(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];o!==e&&(this.logger.verbose(`Replacing tenant domain name ${o} with id ${e}`),o=e)}e!==o&&(t=t.replace(`/${o}/`,`/${e}/`))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||this.protocolMode!==ze.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(un,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await wn(this.updateCloudDiscoveryMetadata.bind(this),dn,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await wn(this.updateEndpointMetadata.bind(this),fn,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:ct(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==P&&r?.source!==P&&(e.expiresAt=ct(),e.canonical_authority=this.canonicalAuthority);const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(fn,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===O&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(ut(e,await wn(this.updateMetadataWithRegionalInformation.bind(this),pn,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await wn(this.getEndpointMetadataFromNetwork.bind(this),hn,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await wn(this.updateMetadataWithRegionalInformation.bind(this),pn,this.logger,this.performanceClient,this.correlationId)(r)),ut(e,r,!0),R;throw Ue(Y,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),ut(e,t,!1),{source:k};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return ut(e,t,!1),{source:O,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=dt(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:P}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new $t(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Ut(Tt)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(hn,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const r=await this.networkInterface.sendGetRequestAsync(t,e),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(r.body);return n?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in zt?zt[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(pn,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==u.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome="2",this.regionDiscoveryMetadata.region_used=t,In.replaceWithRegionalInformation(e,t);const r=await wn(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),gn,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome="4",this.regionDiscoveryMetadata.region_used=r,In.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome="5"}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(dn,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await wn(this.getCloudDiscoveryMetadataFromNetwork.bind(this),ln,this.logger,this.performanceClient,this.correlationId)();if(r)return lt(e,r,!0),R;throw Ut(_t)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||u.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||u.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||u.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),lt(e,t,!1),k;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,Wt(Vt.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),lt(e,t,!1),O;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const n=dt(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),P):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),In.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=Wt(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ut(Et)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),In.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(ln,this.correlationId);const e=`${u.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const n=await this.networkInterface.sendGetRequestAsync(e,t);let i,o;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body))i=n.body,o=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(n.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${n.status}`),i=n.body,i.error===u.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Wt(o,this.hostnameAndPort)}catch(e){if(e instanceof $)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=In.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>e&&$t.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==jr.None){const e=t.tenant?t.tenant:u.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return u.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Ue(W)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Kt.has(e)}static isPublicCloudAuthority(e){return u.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new $t(e);n.validateAsUri();const i=n.getUrlComponents();let o=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(o=`${t}.${u.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const s=$t.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:o}).urlString;return r?`${s}?${r}`:s}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=In.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=In.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=In.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new $t(e).getUrlComponents();return 0===r.PathSegments.length&&r.HostNameAndPort.endsWith(u.CIAM_AUTH_URL)&&(t=`${t}${r.HostNameAndPort.split(".")[0]}${u.AAD_TENANT_DOMAIN_SUFFIX}`),t}}function An(e){return e.endsWith(u.FORWARD_SLASH)?e:`${e}${u.FORWARD_SLASH}`}In.reservedTenantDomains=new Set(["{tenant}","{tenantid}",v.COMMON,v.CONSUMERS,v.ORGANIZATIONS]);const Sn={createNewGuid:()=>{throw Ue(Me)},base64Decode:()=>{throw Ue(Me)},base64Encode:()=>{throw Ue(Me)},base64UrlEncode:()=>{throw Ue(Me)},encodeKid:()=>{throw Ue(Me)},async getPublicKeyThumbprint(){throw Ue(Me)},async removeTokenBindingKey(){throw Ue(Me)},async clearKeystore(){throw Ue(Me)},async signJwt(){throw Ue(Me)},async hashString(){throw Ue(Me)}},En={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Tn={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:qr.Info,correlationId:u.EMPTY_STRING},_n={claimsBasedCachingEnabled:!1},bn={async sendGetRequestAsync(){throw Ue(Me)},async sendPostRequestAsync(){throw Ue(Me)}},kn={sku:u.SKU,version:jt,cpu:u.EMPTY_STRING,os:u.EMPTY_STRING},Pn={clientSecret:u.EMPTY_STRING,clientAssertion:void 0},Rn={azureCloudInstance:jr.None,tenant:`${u.DEFAULT_COMMON_TENANT}`},On={application:{appName:"",appVersion:""}};function Mn(e){return e.authOptions.authority.options.protocolMode===ze.OIDC}const xn="home_account_id",Nn="UPN";class Dn{static validateRedirectUri(e){if(!e)throw Ut(ht)}static validatePrompt(e){const t=[];for(const e in w)t.push(w[e]);if(t.indexOf(e)<0)throw Ut(yt)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw Ut(wt)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Ut(St);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([C.PLAIN,C.S256].indexOf(e)<0)throw Ut(At)}}class Ln{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(Mr,encodeURIComponent(u.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Mr,encodeURIComponent(`${u.TOKEN_RESPONSE_TYPE} ${u.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set("response_mode",encodeURIComponent(e||I.QUERY))}addNativeBroker(){this.parameters.set("nativebroker",encodeURIComponent("1"))}addScopes(e,t=!0,r=l){!t||r.includes("openid")||e.includes("openid")||r.push("openid");const n=t?[...e||[],...r]:e||[],i=new qt(n);this.parameters.set("scope",encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(Rr,encodeURIComponent(e))}addRedirectUri(e){Dn.validateRedirectUri(e),this.parameters.set(Or,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Dn.validateRedirectUri(e),this.parameters.set("post_logout_redirect_uri",encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set("id_token_hint",encodeURIComponent(e))}addDomainHint(e){this.parameters.set("domain_hint",encodeURIComponent(e))}addLoginHint(e){this.parameters.set("login_hint",encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(p,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(p,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set("sid",encodeURIComponent(e))}addClaims(e,t){const r=this.addClientCapabilitiesToClaims(e,t);Dn.validateClaims(r),this.parameters.set("claims",encodeURIComponent(r))}addCorrelationId(e){this.parameters.set("client-request-id",encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set("x-client-SKU",e.sku),this.parameters.set("x-client-VER",e.version),e.os&&this.parameters.set("x-client-OS",e.os),e.cpu&&this.parameters.set("x-client-CPU",e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set("x-app-name",e.appName),e?.appVersion&&this.parameters.set("x-app-ver",e.appVersion)}addPrompt(e){Dn.validatePrompt(e),this.parameters.set("prompt",encodeURIComponent(e))}addState(e){e&&this.parameters.set("state",encodeURIComponent(e))}addNonce(e){this.parameters.set("nonce",encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Dn.validateCodeChallengeParams(e,t),!e||!t)throw Ut(St);this.parameters.set("code_challenge",encodeURIComponent(e)),this.parameters.set("code_challenge_method",encodeURIComponent(t))}addAuthorizationCode(e){this.parameters.set("code",encodeURIComponent(e))}addDeviceCode(e){this.parameters.set("device_code",encodeURIComponent(e))}addRefreshToken(e){this.parameters.set("refresh_token",encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set("code_verifier",encodeURIComponent(e))}addClientSecret(e){this.parameters.set("client_secret",encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set("client_assertion",encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set("client_assertion_type",encodeURIComponent(e))}addOboAssertion(e){this.parameters.set("assertion",encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set("requested_token_use",encodeURIComponent(e))}addGrantType(e){this.parameters.set("grant_type",encodeURIComponent(e))}addClientInfo(){this.parameters.set("client_info","1")}addExtraQueryParameters(e){Object.entries(e).forEach((([e,t])=>{!this.parameters.has(e)&&t&&this.parameters.set(e,t)}))}addClientCapabilitiesToClaims(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw Ut(wt)}else r={};return t&&t.length>0&&(r.hasOwnProperty(y)||(r[y]={}),r[y].xms_cc={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set("username",encodeURIComponent(e))}addPassword(e){this.parameters.set("password",encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(xr,x.POP),this.parameters.set(Nr,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(xr,x.SSH),this.parameters.set(Nr,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),this.parameters.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set("x-ms-lib-capability","retry-after, h429")}addLogoutHint(e){this.parameters.set("logout_hint",encodeURIComponent(e))}addBrokerParameters(e){const t={};t[Ur]=e.brokerClientId,t.brk_redirect_uri=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach(((t,r)=>{e.push(`${r}=${t}`)})),function(e,t,r){if(!t)return;const n=e.get(Rr);n&&e.has(Ur)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(Or)},t)}(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}async function Un(e,t,r,n,i,o,s){s?.addQueueMeasurement(cn,o);const a=In.transformCIAMAuthority(An(e)),c=new In(a,t,r,n,i,o,s);try{return await wn(c.resolveEndpointsAsync.bind(c),un,i,s,o)(),c}catch(e){throw Ue(W)}}class Fn{static generateThrottlingStorageKey(e){return`${N}.${JSON.stringify(e)}`}static preProcess(e,t){const r=Fn.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r);throw new Fr(n.errorCodes?.join(" ")||u.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(Fn.checkResponseStatus(r)||Fn.checkResponseForRetryAfter(r)){const n={throttleTime:Fn.calculateThrottleTime(parseInt(r.headers[f])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Fn.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(f)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))}static removeThrottle(e,t,r,n){const i={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},o=this.generateThrottlingStorageKey(i);e.removeItem(o)}}class qn extends ${constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,qn.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}class Hn{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:i,networkInterface:o,cryptoInterface:s,clientCredentials:a,libraryInfo:c,telemetry:u,serverTelemetryManager:l,persistencePlugin:d,serializableCache:h}){const f={...Tn,...r};return{authOptions:(p=e,{clientCapabilities:[],azureCloudOptions:Rn,skipAuthorityMetadataCache:!1,instanceAware:!1,...p}),systemOptions:{...En,...t},loggerOptions:f,cacheOptions:{..._n,...n},storageInterface:i||new er(e.clientId,Sn,new Hr(f)),networkInterface:o||bn,cryptoInterface:s||Sn,clientCredentials:a||Pn,libraryInfo:{...kn,...c},telemetry:{...On,...u},serverTelemetryManager:l||null,persistencePlugin:d||null,serializableCache:h||null};var p}(e),this.logger=new Hr(this.config.loggerOptions,Ht,jt),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[h]=u.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case xn:try{const r=qe(e.credential);t[p]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Nn:t[p]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,i,o){o&&this.performanceClient?.addQueueMeasurement(o,i);const s=await this.sendPostRequest(n,e,{body:t,headers:r},i);return this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async sendPostRequest(e,t,r,n){let i;Fn.preProcess(this.cacheManager,e);try{i=await wn(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Br,this.logger,this.performanceClient,n)(t,r);const e=i.headers||{};this.performanceClient?.addFields({refreshTokenSize:i.body.refresh_token?.length||0,httpVerToken:e[m]||"",requestId:e[g]||""},n)}catch(e){if(e instanceof qn){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[m]||"",requestId:t[g]||"",contentTypeHeader:t[h]||void 0,contentLengthHeader:t["Content-Length"]||void 0,httpStatus:e.httpStatus},n),e.error}throw e instanceof $?e:Ue(X)}return Fn.postProcess(this.cacheManager,e,i),i}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(Zr,t);const r=`https://${e}/${this.authority.tenant}/`,n=await Un(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){const t=new Ln(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}const jn="no_tokens_found",Bn="native_account_unavailable",$n="refresh_token_expired",zn="interaction_required",Vn="consent_required",Kn="login_required",Gn="bad_token",Wn=[zn,Vn,Kn,Gn],Xn=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Yn={[jn]:"No refresh token found in the cache. Please sign-in.",[Bn]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[$n]:"Refresh token has expired.",[Gn]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},Qn={noTokensFoundError:{code:jn,desc:Yn[jn]},native_account_unavailable:{code:Bn,desc:Yn[Bn]},bad_token:{code:Gn,desc:Yn[Gn]}};class Jn extends ${constructor(e,t,r,n,i,o,s,a){super(e,t,r),Object.setPrototypeOf(this,Jn.prototype),this.timestamp=n||u.EMPTY_STRING,this.traceId=i||u.EMPTY_STRING,this.correlationId=o||u.EMPTY_STRING,this.claims=s||u.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=a}}function Zn(e,t,r){const n=!!e&&Wn.indexOf(e)>-1,i=!!r&&Xn.indexOf(r)>-1,o=!!t&&Wn.some((e=>t.indexOf(e)>-1));return n||o||i}function ei(e){return new Jn(e,Yn[e])}class ti{static setRequestState(e,t,r){const n=ti.generateLibraryState(e,r);return t?`${n}${u.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw Ue(ye);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw Ue(ye);if(!t)throw Ue(J);try{const r=t.split(u.RESOURCE_DELIM),n=r[0],i=r.length>1?r.slice(1).join(u.RESOURCE_DELIM):u.EMPTY_STRING,o=e.base64Decode(n),s=JSON.parse(o);return{userRequestState:i||u.EMPTY_STRING,libraryState:s}}catch(e){throw Ue(J)}}}class ri{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(on,e.correlationId);const r=await wn(this.generateKid.bind(this),on,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(sn,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:i,resourceRequestUri:o,shrClaims:s,shrNonce:a,shrOptions:c}=r,u=o?new $t(o):void 0,l=u?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:We(),m:i?.toUpperCase(),u:l?.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:l?.AbsolutePath,q:l?.QueryString?[[],l.QueryString]:void 0,client_claims:s||void 0,...n},t,c,r.correlationId)}}class ni{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class ii{constructor(e,t,r,n,i,o,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=i,this.persistencePlugin=o,this.performanceClient=s}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?Ue(ee,"Cached State"):Ue(ee,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(t){throw Ue(J,e.state)}try{n=decodeURIComponent(t)}catch(t){throw Ue(J,e.state)}if(r!==n)throw Ue(Z);if(e.error||e.error_description||e.suberror){const t=function(e){const t=e.error_uri?.lastIndexOf("code=");return t&&t>=0?e.error_uri?.substring(t+5):void 0}(e);if(Zn(e.error,e.error_description,e.suberror))throw new Jn(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Fr(e.error||"",e.error_description,e.suberror,t)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||u.NOT_AVAILABLE} - Timestamp: ${e.timestamp||u.NOT_AVAILABLE} - Description: ${e.error_description||u.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||u.NOT_AVAILABLE} - Trace ID: ${e.trace_id||u.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,i=new Fr(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${i}`);if(t&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${i}`);if(Zn(e.error,e.error_description,e.suberror))throw new Jn(e.error,e.error_description,e.suberror,e.timestamp||u.EMPTY_STRING,e.trace_id||u.EMPTY_STRING,e.correlation_id||u.EMPTY_STRING,e.claims||u.EMPTY_STRING,n);throw i}}async handleServerTokenResponse(e,t,r,n,i,o,s,a,c){let l,d;if(this.performanceClient?.addQueueMeasurement(an,e.correlation_id),e.id_token){if(l=Ke(e.id_token||u.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&l.nonce!==i.nonce)throw Ue(te);if(n.maxAge||0===n.maxAge){const e=l.auth_time;if(!e)throw Ue(re);Ge(e,n.maxAge)}}this.homeAccountIdentifier=Ve.generateHomeAccountId(e.client_info||u.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,l),i&&i.state&&(d=ti.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||n.sshKid||void 0;const h=this.generateCacheRecord(e,t,r,n,l,o,i);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new ni(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),s&&!a&&h.account){const e=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await ii.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,l,d,void 0,c)}await this.cacheStorage.saveCacheRecord(h,n.storeInCache,n.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return ii.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,l,d,e,c)}generateCacheRecord(e,t,r,n,i,o,s){const a=t.getPreferredCache();if(!a)throw Ue(me);const c=$e(i);let u,l;var d,h,f,p,g;e.id_token&&i&&(d=this.homeAccountIdentifier,h=a,f=e.id_token,p=this.clientId,g=c||"",u={credentialType:E.ID_TOKEN,homeAccountId:d,environment:h,clientId:p,secret:f,realm:g},l=function(e,t,r,n,i,o,s,a,c,u,l){l?.verbose("setCachedAccount called");const d=e.getAccountKeys().find((e=>e.startsWith(r)));let h=null;d&&(h=e.getAccount(d,l));const f=h||Ve.createAccount({homeAccountId:r,idTokenClaims:i,clientInfo:o,environment:s,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:void 0},t,n),p=f.tenantProfiles||[],g=a||f.realm;if(g&&!p.find((e=>e.tenantId===g))){const e=je(r,f.localAccountId,g,i);p.push(e)}return f.tenantProfiles=p,f}(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,a,c,s,0,this.logger));let m=null;if(e.access_token){const i=e.scope?qt.fromString(e.scope):new qt(n.scopes||[]),s=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,u=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,l=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,d=r+s,h=d+u,f=l&&l>0?r+l:void 0;m=function(e,t,r,n,i,o,s,a,c,u,l,d,h,f,p){const g={homeAccountId:e,credentialType:E.ACCESS_TOKEN,secret:r,cachedAt:We().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:t,clientId:n,realm:i,target:o,tokenType:l||x.BEARER};if(d&&(g.userAssertionHash=d),u&&(g.refreshOn=u.toString()),f&&(g.requestedClaims=f,g.requestedClaimsHash=p),g.tokenType?.toLowerCase()!==x.BEARER.toLowerCase())switch(g.credentialType=E.ACCESS_TOKEN_WITH_AUTH_SCHEME,g.tokenType){case x.POP:const e=Ke(r,c);if(!e?.cnf?.kid)throw Ue(Ee);g.keyId=e.cnf.kid;break;case x.SSH:g.keyId=h}return g}(this.homeAccountIdentifier,a,e.access_token,this.clientId,c||t.tenant||"",i.printScopes(),d,h,this.cryptoObj.base64Decode,f,e.token_type,o,e.key_id,n.claims,n.requestedClaimsHash)}let v=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),v=function(e,t,r,n,i,o,s){const a={credentialType:E.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return o&&(a.userAssertionHash=o),i&&(a.familyId=i),s&&(a.expiresOn=s.toString()),a}(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci,o,t)}let y=null;return e.foci&&(y={clientId:this.clientId,environment:a,familyId:e.foci}),{account:l,idToken:u,accessToken:m,refreshToken:v,appMetadata:y}}static async generateAuthenticationResult(e,t,r,n,i,o,s,a,c){let l,d,h=u.EMPTY_STRING,f=[],p=null,g=u.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==x.POP||i.popKid)h=r.accessToken.secret;else{const t=new ri(e),{secret:n,keyId:o}=r.accessToken;if(!o)throw Ue(ke);h=await t.signPopToken(n,o,i)}f=qt.fromString(r.accessToken.target).asArray(),p=new Date(1e3*Number(r.accessToken.expiresOn)),l=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),r.accessToken.refreshOn&&(d=new Date(1e3*Number(r.accessToken.refreshOn)))}r.appMetadata&&(g=r.appMetadata.familyId===_?_:"");const m=o?.oid||o?.sub||"",v=o?.tid||"";a?.spa_accountid&&r.account&&(r.account.nativeAccountId=a?.spa_accountid);const y=r.account?Be(r.account.getAccountInfo(),void 0,o,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:m,tenantId:v,scopes:f,account:y,idToken:r?.idToken?.secret||"",idTokenClaims:o||{},accessToken:h,fromCache:n,expiresOn:p,extExpiresOn:l,refreshOn:d,correlationId:i.correlationId,requestId:c||u.EMPTY_STRING,familyId:g,tokenType:r.accessToken?.tokenType||u.EMPTY_STRING,state:s?s.userRequestState:u.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||u.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||u.EMPTY_STRING,code:a?.spa_code,fromNativeBroker:!1}}}async function oi(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class si extends Hn{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(e){this.performanceClient?.addQueueMeasurement(Jr,e.correlationId);const t=await wn(this.createAuthCodeUrlQueryString.bind(this),nn,this.logger,this.performanceClient,e.correlationId)(e);return $t.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(en,e.correlationId),!e.code)throw Ue(ae);const r=We(),n=await wn(this.executeTokenRequest.bind(this),tn,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=n.headers?.[g],o=new ii(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return o.validateTokenResponse(n.body),wn(o.handleServerTokenResponse.bind(o),an,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,i)}handleFragmentResponse(e,t){if(new ii(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw Ue(Te);return e}getLogoutUri(e){if(!e)throw Ut(It);const t=this.createLogoutUrlQueryString(e);return $t.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(tn,t.correlationId);const r=this.createTokenQueryParameters(t),n=$t.appendQueryString(e.tokenEndpoint,r),i=await wn(this.createTokenRequestBody.bind(this),rn,this.logger,this.performanceClient,t.correlationId)(t);let o;if(t.clientInfo)try{const e=Fe(t.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${e.uid}${S.CLIENT_INFO_SEPARATOR}${e.utid}`,type:xn}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const s=this.createTokenRequestHeaders(o||t.ccsCredential),a={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return wn(this.executePostToTokenEndpoint.bind(this),zr,this.logger,this.performanceClient,t.correlationId)(n,i,s,a,t.correlationId,zr)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(rn,e.correlationId);const t=new Ln(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||e.tokenBodyParameters?.[Rr]||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Dn.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!Mn(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const r=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await oi(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(r.assertionType)}if(t.addGrantType("authorization_code"),t.addClientInfo(),e.authenticationScheme===x.POP){const r=new ri(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await wn(r.generateCnf.bind(r),on,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(n)}else if(e.authenticationScheme===x.SSH){if(!e.sshJwk)throw Ut(bt);t.addSshJwk(e.sshJwk)}let r;if((!Ft.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Fe(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${t.uid}${S.CLIENT_INFO_SEPARATOR}${t.utid}`,type:xn}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case xn:try{const e=qe(r.credential);t.addCcsOid(e)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Nn:t.addCcsUpn(r.credential)}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Dr]||t.addExtraQueryParameters({[Dr]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){const t=e.correlationId||this.config.cryptoInterface.createNewGuid();this.performanceClient?.addQueueMeasurement(nn,t);const r=new Ln(t,this.performanceClient);r.addClientId(e.embeddedClientId||e.extraQueryParameters?.[Rr]||this.config.authOptions.clientId);const n=[...e.scopes||[],...e.extraScopesToConsent||[]];if(r.addScopes(n,!0,this.oidcDefaultScopes),r.addRedirectUri(e.redirectUri),r.addCorrelationId(t),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),Mn(this.config)||r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==w.SELECT_ACCOUNT)if(e.sid&&e.prompt===w.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){const t=this.extractAccountSid(e.account);let n=this.extractLoginHint(e.account);if(n&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),n=null),n){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(n);try{const t=qe(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t&&e.prompt===w.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(t);try{const t=qe(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{const t=qe(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,r),e.nativeBroker&&(r.addNativeBroker(),e.authenticationScheme===x.POP)){const t=new ri(this.cryptoUtils);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await wn(t.generateCnf.bind(t),on,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(n)}return r.createQueryString()}createLogoutUrlQueryString(e){const t=new Ln(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}class ai extends Hn{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Kr,e.correlationId);const t=We(),r=await wn(this.executeTokenRequest.bind(this),Vr,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[g],i=new ii(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(r.body),wn(i.handleServerTokenResponse.bind(i),an,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw Ut(Ct);if(this.performanceClient?.addQueueMeasurement(Wr,e.correlationId),!e.account)throw Ue(pe);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await wn(this.acquireTokenWithCachedRefreshToken.bind(this),Gr,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const r=t instanceof Jn&&t.errorCode===jn,n=t instanceof Fr&&"invalid_grant"===t.errorCode&&"client_mismatch"===t.subError;if(r||n)return wn(this.acquireTokenWithCachedRefreshToken.bind(this),Gr,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return wn(this.acquireTokenWithCachedRefreshToken.bind(this),Gr,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(Gr,e.correlationId);const r=(n=this.cacheManager.getRefreshToken.bind(this.cacheManager),i=yn,o=this.logger,s=this.performanceClient,a=e.correlationId,(...e)=>{o.trace(`Executing function ${i}`);const t=s?.startMeasurement(i,a);if(a){const e=i+"CallCount";s?.incrementFields({[e]:1},a)}try{const r=n(...e);return t?.end({success:!0}),o.trace(`Returning result from ${i}`),r}catch(e){o.trace(`Error occurred in ${i}`);try{o.trace(JSON.stringify(e))}catch(e){o.trace("Unable to print error message.")}throw t?.end({success:!1},e),e}})(e.account,t,void 0,this.performanceClient,e.correlationId);var n,i,o,s,a;if(!r)throw ei(jn);if(r.expiresOn&&Xe(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw ei($n);const c={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||x.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:xn}};try{return await wn(this.acquireToken.bind(this),Kr,this.logger,this.performanceClient,e.correlationId)(c)}catch(e){if(e instanceof Jn&&e.subError===Gn){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const e=Qe(r);this.cacheManager.removeRefreshToken(e)}throw e}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Vr,e.correlationId);const r=this.createTokenQueryParameters(e),n=$t.appendQueryString(t.tokenEndpoint,r),i=await wn(this.createTokenRequestBody.bind(this),Xr,this.logger,this.performanceClient,e.correlationId)(e),o=this.createTokenRequestHeaders(e.ccsCredential),s={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return wn(this.executePostToTokenEndpoint.bind(this),$r,this.logger,this.performanceClient,e.correlationId)(n,i,o,s,e.correlationId,$r)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Xr,e.correlationId);const t=e.correlationId,r=new Ln(t,this.performanceClient);if(r.addClientId(e.embeddedClientId||e.tokenBodyParameters?.[Rr]||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),r.addGrantType("refresh_token"),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!Mn(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const t=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await oi(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(t.assertionType)}if(e.authenticationScheme===x.POP){const t=new ri(this.cryptoUtils,this.performanceClient);let n;n=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await wn(t.generateCnf.bind(t),on,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(n)}else if(e.authenticationScheme===x.SSH){if(!e.sshJwk)throw Ut(bt);r.addSshJwk(e.sshJwk)}if((!Ft.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case xn:try{const t=qe(e.ccsCredential.credential);r.addCcsOid(t)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Nn:r.addCcsUpn(e.ccsCredential.credential)}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}class ci extends Hn{constructor(e,t){super(e,t)}async acquireToken(e){try{const[t,r]=await this.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...l]});return r===F&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new ai(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch((()=>{}))),t}catch(t){if(t instanceof Le&&t.errorCode===Ae)return new ai(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw t}}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Yr,e.correlationId);let t=D;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Ft.isEmptyObj(e.claims))throw this.setCacheOutcome("1",e.correlationId),Ue(Ae);if(!e.account)throw Ue(pe);const r=e.account.tenantId||function(e){const t=new $t(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case v.COMMON:case v.ORGANIZATIONS:case v.CONSUMERS:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(!i)throw this.setCacheOutcome(L,e.correlationId),Ue(Ae);if(o=i.cachedAt,Number(o)>We()||Xe(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(U,e.correlationId),Ue(Ae);var o;i.refreshOn&&Xe(i.refreshOn,0)&&(t=F);const s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await wn(this.generateResultFromCacheRecord.bind(this),Qr,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==D&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(Qr,t.correlationId),e.idToken&&(r=Ke(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=r?.auth_time;if(!e)throw Ue(re);Ge(e,t.maxAge)}return ii.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class ui{static getNetworkResponse(e,t,r){return{headers:e,body:t,status:r}}static urlToHttpOptions(e){const t={protocol:e.protocol,hostname:e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return""!==e.port&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${decodeURIComponent(e.username)}:${decodeURIComponent(e.password)}`),t}}var li=r(8611),di=r(5692);class hi{constructor(e,t){this.proxyUrl=e||"",this.customAgentOptions=t||{}}async sendGetRequestAsync(e,t,r){return this.proxyUrl?fi(e,this.proxyUrl,vr,t,this.customAgentOptions,r):pi(e,vr,t,this.customAgentOptions,r)}async sendPostRequestAsync(e,t){return this.proxyUrl?fi(e,this.proxyUrl,yr,t,this.customAgentOptions):pi(e,yr,t,this.customAgentOptions)}}const fi=(e,t,r,n,i,o)=>{const s=new URL(e),a=new URL(t),c=n?.headers||{},u={host:a.hostname,port:a.port,method:"CONNECT",path:s.hostname,headers:c};i&&Object.keys(i).length&&(u.agent=new li.Agent(i));let l="";if(r===yr){const e=n?.body||"";l=`Content-Type: application/x-www-form-urlencoded\r\nContent-Length: ${e.length}\r\n\r\n${e}`}else o&&(u.timeout=o);const d=`${r.toUpperCase()} ${s.href} HTTP/1.1\r\nHost: ${s.host}\r\nConnection: close\r\n`+l+"\r\n";return new Promise(((e,t)=>{const r=li.request(u);o&&r.on("timeout",(()=>{r.destroy(),t(new Error("Request time out"))})),r.end(),r.on("connect",((n,i)=>{const o=n?.statusCode||Ir;(o<wr||o>Cr)&&(r.destroy(),i.destroy(),t(new Error(`Error connecting to proxy. Http status code: ${n.statusCode}. Http status message: ${n?.statusMessage||"Unknown"}`))),i.write(d);const s=[];i.on("data",(e=>{s.push(e)})),i.on("end",(()=>{const t=Buffer.concat([...s]).toString().split("\r\n"),n=parseInt(t[0].split(" ")[1]),i=t[0].split(" ").slice(2).join(" "),o=t[t.length-1],a=t.slice(1,t.length-2),c=new Map;a.forEach((e=>{const t=e.split(new RegExp(/:\s(.*)/s)),r=t[0];let n=t[1];try{const e=JSON.parse(n);e&&"object"==typeof e&&(n=e)}catch(e){}c.set(r,n)}));const u=Object.fromEntries(c),l=ui.getNetworkResponse(u,gi(n,i,u,o),n);(n<200||n>299)&&l.body.error!==Tr&&r.destroy(),e(l)})),i.on("error",(e=>{r.destroy(),i.destroy(),t(new Error(e.toString()))}))})),r.on("error",(e=>{r.destroy(),t(new Error(e.toString()))}))}))},pi=(e,t,r,n,i)=>{const o=t===yr,s=r?.body||"",a=new URL(e),c={method:t,headers:r?.headers||{},...ui.urlToHttpOptions(a)};return n&&Object.keys(n).length&&(c.agent=new di.Agent(n)),o?c.headers={...c.headers,"Content-Length":s.length}:i&&(c.timeout=i),new Promise(((e,t)=>{let r;r="http:"===c.protocol?li.request(c):di.request(c),o&&r.write(s),i&&r.on("timeout",(()=>{r.destroy(),t(new Error("Request time out"))})),r.end(),r.on("response",(t=>{const n=t.headers,i=t.statusCode,o=t.statusMessage,s=[];t.on("data",(e=>{s.push(e)})),t.on("end",(()=>{const t=Buffer.concat([...s]).toString(),a=n,c=ui.getNetworkResponse(a,gi(i,o,a,t),i);(i<200||i>299)&&c.body.error!==Tr&&r.destroy(),e(c)}))})),r.on("error",(e=>{r.destroy(),t(new Error(e.toString()))}))}))},gi=(e,t,r,n)=>{let i;try{i=JSON.parse(n)}catch(n){let o,s;e>=400&&e<=499?(o="client_error",s="A client"):e>=500&&e<=599?(o="server_error",s="A server"):(o="unknown_error",s="An unknown"),i={error:o,error_description:`${s} error occured.\nHttp status code: ${e}\nHttp status message: ${t||"Unknown"}\nHeaders: ${JSON.stringify(r)}`}}return i},mi="invalid_file_extension",vi="invalid_file_path",yi="invalid_managed_identity_id_type",wi="invalid_secret",Ci="platform_not_supported",Ii="unable_to_create_azure_arc",Ai="unable_to_create_cloud_shell",Si="unable_to_create_source",Ei="unable_to_read_secret_file",Ti="www_authenticate_header_missing",_i="www_authenticate_header_unsupported_format",bi={[sr]:"azure_pod_identity_authority_host_url_malformed",[ar]:"identity_endpoint_url_malformed",[lr]:"imds_endpoint_url_malformed",[dr]:"msi_endpoint_url_malformed"},ki={[mi]:"The file path in the WWW-Authenticate header does not contain a .key file.",[vi]:"The file path in the WWW-Authenticate header is not in a valid Windows or Linux Format.",[yi]:"More than one ManagedIdentityIdType was provided.",[wi]:"The secret in the file on the file path in the WWW-Authenticate header is greater than 4096 bytes.",[Ci]:"The platform is not supported by Azure Arc. Azure Arc only supports Windows and Linux.",missing_client_id:"A ManagedIdentityId id was not provided.",[bi.AZURE_POD_IDENTITY_AUTHORITY_HOST]:`The Managed Identity's '${sr}' environment variable is malformed.`,[bi.IDENTITY_ENDPOINT]:`The Managed Identity's '${ar}' environment variable is malformed.`,[bi.IMDS_ENDPOINT]:`The Managed Identity's '${lr}' environment variable is malformed.`,[bi.MSI_ENDPOINT]:`The Managed Identity's '${dr}' environment variable is malformed.`,network_unavailable:"Authentication unavailable. The request to the managed identity endpoint timed out.",[Ii]:"Azure Arc Managed Identities can only be system assigned.",[Ai]:"Cloud Shell Managed Identities can only be system assigned.",[Si]:"Unable to create a Managed Identity source based on environment variables.",[Ei]:"Unable to read the secret file.",user_assigned_not_available_at_runtime:"Service Fabric user assigned managed identity ClientId or ResourceId is not configurable at runtime.",[Ti]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is missing.",[_i]:"A 401 response was received form the Azure Arc Managed Identity, but the www-authenticate header is in an unsupported format."};class Pi extends ${constructor(e){super(e,ki[e]),this.name="ManagedIdentityError",Object.setPrototypeOf(this,Pi.prototype)}}function Ri(e){return new Pi(e)}class Oi{get id(){return this._id}set id(e){this._id=e}get idType(){return this._idType}set idType(e){this._idType=e}constructor(e){const t=e?.userAssignedClientId,r=e?.userAssignedResourceId,n=e?.userAssignedObjectId;if(t){if(r||n)throw Ri(yi);this.id=t,this.idType=pr}else if(r){if(t||n)throw Ri(yi);this.id=r,this.idType=gr}else if(n){if(t||r)throw Ri(yi);this.id=n,this.idType=mr}else this.id="system_assigned_managed_identity",this.idType=fr}}class Mi{constructor(e,t,r){this.maxRetries=e,this.retryDelay=t,this.httpStatusCodesToRetryOn=r}retryAfterMillisecondsToSleep(e){if(!e)return 0;let t=Math.round(1e3*parseFloat(e));return isNaN(t)&&(t=Math.max(0,new Date(e).valueOf()-(new Date).valueOf())),t}async pauseForRetry(e,t,r){if(this.httpStatusCodesToRetryOn.includes(e)&&t<this.maxRetries){const e=this.retryAfterMillisecondsToSleep(r);return await new Promise((t=>setTimeout(t,e||this.retryDelay))),!0}return!1}}class xi{constructor(e,t){this.httpClientNoRetries=e,this.retryPolicy=t}async sendNetworkRequestAsyncHelper(e,t,r){return e===vr?this.httpClientNoRetries.sendGetRequestAsync(t,r):this.httpClientNoRetries.sendPostRequestAsync(t,r)}async sendNetworkRequestAsync(e,t,r){let n=await this.sendNetworkRequestAsyncHelper(e,t,r),i=0;for(;await this.retryPolicy.pauseForRetry(n.status,i,n.headers[f]);)n=await this.sendNetworkRequestAsyncHelper(e,t,r),i++;return n}async sendGetRequestAsync(e,t){return this.sendNetworkRequestAsync(vr,e,t)}async sendPostRequestAsync(e,t){return this.sendNetworkRequestAsync(yr,e,t)}}const Ni="invalid_loopback_server_address_type",Di="Loopback server address is not type string. This is unexpected.",Li="unable_to_load_redirectUrl",Ui="Loopback server callback was invoked without a url. This is unexpected.",Fi="no_auth_code_in_response",qi="No auth code found in the server response. Please check your network trace to determine what happened.",Hi="no_loopback_server_exists",ji="No loopback server exists yet.",Bi="loopback_server_already_exists",$i="Loopback server already exists. Cannot create another.",zi="loopback_server_timeout",Vi="Timed out waiting for auth code listener to be registered.",Ki="state_not_found",Gi="State not found. Please verify that the request originated from msal.",Wi="thumbprint_missing_from_client_certificate",Xi="Client certificate does not contain a SHA-1 or SHA-256 thumbprint.";class Yi extends ${constructor(e,t){super(e,t),this.name="NodeAuthError"}static createInvalidLoopbackAddressTypeError(){return new Yi(Ni,`${Di}`)}static createUnableToLoadRedirectUrlError(){return new Yi(Li,`${Ui}`)}static createNoAuthCodeInResponseError(){return new Yi(Fi,`${qi}`)}static createNoLoopbackServerExistsError(){return new Yi(Hi,`${ji}`)}static createLoopbackServerAlreadyExistsError(){return new Yi(Bi,`${$i}`)}static createLoopbackServerTimeoutError(){return new Yi(zi,`${Vi}`)}static createStateNotFoundError(){return new Yi(Ki,Gi)}static createThumbprintMissingError(){return new Yi(Wi,Xi)}}const Qi={clientId:u.EMPTY_STRING,authority:u.DEFAULT_AUTHORITY,clientSecret:u.EMPTY_STRING,clientAssertion:u.EMPTY_STRING,clientCertificate:{thumbprint:u.EMPTY_STRING,thumbprintSha256:u.EMPTY_STRING,privateKey:u.EMPTY_STRING,x5c:u.EMPTY_STRING},knownAuthorities:[],cloudDiscoveryMetadata:u.EMPTY_STRING,authorityMetadata:u.EMPTY_STRING,clientCapabilities:[],protocolMode:ze.AAD,azureCloudOptions:{azureCloudInstance:jr.None,tenant:u.EMPTY_STRING},skipAuthorityMetadataCache:!1},Ji={claimsBasedCachingEnabled:!1},Zi={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:qr.Info},eo={loggerOptions:Zi,networkClient:new hi,proxyUrl:u.EMPTY_STRING,customAgentOptions:{},disableInternalRetries:!1},to={application:{appName:u.EMPTY_STRING,appVersion:u.EMPTY_STRING}};var ro=r(2107);class no{generateGuid(){return(0,ro.v4)()}isGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}}class io{static base64Encode(e,t){return Buffer.from(e,t).toString("base64")}static base64EncodeUrl(e,t){return io.base64Encode(e,t).replace(/=/g,u.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")}static base64Decode(e){return Buffer.from(e,"base64").toString("utf8")}static base64DecodeUrl(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4;)t+="=";return io.base64Decode(t)}}var oo=r(6982);class so{sha256(e){return oo.createHash("sha256").update(e).digest()}}class ao{constructor(){this.hashUtils=new so}async generatePkceCodes(){const e=this.generateCodeVerifier();return{verifier:e,challenge:this.generateCodeChallengeFromVerifier(e)}}generateCodeVerifier(){const e=[];for(;e.length<=32;){const t=oo.randomBytes(1)[0];if(t>=198)continue;const r=t%66;e.push(Ar[r])}const t=e.join(u.EMPTY_STRING);return io.base64EncodeUrl(t)}generateCodeChallengeFromVerifier(e){return io.base64EncodeUrl(this.hashUtils.sha256(e).toString("base64"),"base64")}}class co{constructor(){this.pkceGenerator=new ao,this.guidGenerator=new no,this.hashUtils=new so}base64UrlEncode(){throw new Error("Method not implemented.")}encodeKid(){throw new Error("Method not implemented.")}createNewGuid(){return this.guidGenerator.generateGuid()}base64Encode(e){return io.base64Encode(e)}base64Decode(e){return io.base64Decode(e)}generatePkceCodes(){return this.pkceGenerator.generatePkceCodes()}getPublicKeyThumbprint(){throw new Error("Method not implemented.")}removeTokenBindingKey(){throw new Error("Method not implemented.")}clearKeystore(){throw new Error("Method not implemented.")}signJwt(){throw new Error("Method not implemented.")}async hashString(e){return io.base64EncodeUrl(this.hashUtils.sha256(e).toString("base64"),"base64")}}class uo extends Zt{constructor(e,t,r,n){super(t,r,e,n),this.cache={},this.changeEmitters=[],this.logger=e}registerChangeEmitter(e){this.changeEmitters.push(e)}emitChange(){this.changeEmitters.forEach((e=>e.call(null)))}cacheToInMemoryCache(e){const t={accounts:{},idTokens:{},accessTokens:{},refreshTokens:{},appMetadata:{}};for(const r in e){const n=e[r];if("object"==typeof n)if(n instanceof Ve)t.accounts[r]=n;else if(et(n))t.idTokens[r]=n;else if(Ze(n))t.accessTokens[r]=n;else if(tt(n))t.refreshTokens[r]=n;else{if(!at(r,n))continue;t.appMetadata[r]=n}}return t}inMemoryCacheToCache(e){let t=this.getCache();return t={...t,...e.accounts,...e.idTokens,...e.accessTokens,...e.refreshTokens,...e.appMetadata},t}getInMemoryCache(){return this.logger.trace("Getting in-memory cache"),this.cacheToInMemoryCache(this.getCache())}setInMemoryCache(e){this.logger.trace("Setting in-memory cache");const t=this.inMemoryCacheToCache(e);this.setCache(t),this.emitChange()}getCache(){return this.logger.trace("Getting cache key-value store"),this.cache}setCache(e){this.logger.trace("Setting cache key value store"),this.cache=e,this.emitChange()}getItem(e){return this.logger.tracePii(`Item key: ${e}`),this.getCache()[e]}setItem(e,t){this.logger.tracePii(`Item key: ${e}`);const r=this.getCache();r[e]=t,this.setCache(r)}getAccountKeys(){const e=this.getInMemoryCache();return Object.keys(e.accounts)}getTokenKeys(){const e=this.getInMemoryCache();return{idToken:Object.keys(e.idTokens),accessToken:Object.keys(e.accessTokens),refreshToken:Object.keys(e.refreshTokens)}}getAccount(e){const t=this.getCachedAccountEntity(e);return t&&Ve.isAccountEntity(t)?this.updateOutdatedCachedAccount(e,t):null}getCachedAccountEntity(e){return this.getItem(e)?Object.assign(new Ve,this.getItem(e)):null}setAccount(e){const t=e.generateAccountKey();this.setItem(t,e)}getIdTokenCredential(e){const t=this.getItem(e);return et(t)?t:null}setIdTokenCredential(e){const t=Qe(e);this.setItem(t,e)}getAccessTokenCredential(e){const t=this.getItem(e);return Ze(t)?t:null}setAccessTokenCredential(e){const t=Qe(e);this.setItem(t,e)}getRefreshTokenCredential(e){const t=this.getItem(e);return tt(t)?t:null}setRefreshTokenCredential(e){const t=Qe(e);this.setItem(t,e)}getAppMetadata(e){const t=this.getItem(e);return at(e,t)?t:null}setAppMetadata(e){const t=function({environment:e,clientId:t}){return[T,e,t].join(S.CACHE_KEY_SEPARATOR).toLowerCase()}(e);this.setItem(t,e)}getServerTelemetry(e){const t=this.getItem(e);return t&&function(e,t){const r=0===e.indexOf(M.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,t)?t:null}setServerTelemetry(e,t){this.setItem(e,t)}getAuthorityMetadata(e){const t=this.getItem(e);return t&&function(e,t){return!!t&&0===e.indexOf(b)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,t)?t:null}getAuthorityMetadataKeys(){return this.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setAuthorityMetadata(e,t){this.setItem(e,t)}getThrottlingCache(e){const t=this.getItem(e);return t&&function(e,t){let r=!1;e&&(r=0===e.indexOf(N));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}(e,t)?t:null}setThrottlingCache(e,t){this.setItem(e,t)}removeItem(e){this.logger.tracePii(`Item key: ${e}`);let t=!1;const r=this.getCache();return r[e]&&(delete r[e],t=!0),t&&(this.setCache(r),this.emitChange()),t}removeOutdatedAccount(e){this.removeItem(e)}containsKey(e){return this.getKeys().includes(e)}getKeys(){this.logger.trace("Retrieving all cache keys");const e=this.getCache();return[...Object.keys(e)]}clear(){this.logger.trace("Clearing cache entries created by MSAL"),this.getKeys().forEach((e=>{this.removeItem(e)})),this.emitChange()}static generateInMemoryCache(e){return tr.deserializeAllCache(tr.deserializeJSONBlob(e))}static generateJsonCache(e){return c.serializeAllCache(e)}updateCredentialCacheKey(e,t){const r=Qe(t);if(e!==r){const n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}}const lo={},ho={},fo={},po={},go={};class mo{constructor(e,t,r){this.cacheHasChanged=!1,this.storage=e,this.storage.registerChangeEmitter(this.handleChangeEvent.bind(this)),r&&(this.persistence=r),this.logger=t}hasChanged(){return this.cacheHasChanged}serialize(){this.logger.trace("Serializing in-memory cache");let e=c.serializeAllCache(this.storage.getInMemoryCache());return this.cacheSnapshot?(this.logger.trace("Reading cache snapshot from disk"),e=this.mergeState(JSON.parse(this.cacheSnapshot),e)):this.logger.trace("No cache snapshot to merge"),this.cacheHasChanged=!1,JSON.stringify(e)}deserialize(e){if(this.logger.trace("Deserializing JSON to in-memory cache"),this.cacheSnapshot=e,this.cacheSnapshot){this.logger.trace("Reading cache snapshot from disk");const e=tr.deserializeAllCache(this.overlayDefaults(JSON.parse(this.cacheSnapshot)));this.storage.setInMemoryCache(e)}else this.logger.trace("No cache snapshot to deserialize")}getKVStore(){return this.storage.getCache()}async getAllAccounts(){let e;this.logger.trace("getAllAccounts called");try{return this.persistence&&(e=new ni(this,!1),await this.persistence.beforeCacheAccess(e)),this.storage.getAllAccounts()}finally{this.persistence&&e&&await this.persistence.afterCacheAccess(e)}}async getAccountByHomeId(e){const t=await this.getAllAccounts();return e&&t&&t.length&&t.filter((t=>t.homeAccountId===e))[0]||null}async getAccountByLocalId(e){const t=await this.getAllAccounts();return e&&t&&t.length&&t.filter((t=>t.localAccountId===e))[0]||null}async removeAccount(e){let t;this.logger.trace("removeAccount called");try{this.persistence&&(t=new ni(this,!0),await this.persistence.beforeCacheAccess(t)),await this.storage.removeAccount(Ve.generateAccountCacheKey(e))}finally{this.persistence&&t&&await this.persistence.afterCacheAccess(t)}}handleChangeEvent(){this.cacheHasChanged=!0}mergeState(e,t){this.logger.trace("Merging in-memory cache with cache snapshot");const r=this.mergeRemovals(e,t);return this.mergeUpdates(r,t)}mergeUpdates(e,t){return Object.keys(t).forEach((r=>{const n=t[r];if(e.hasOwnProperty(r)){const t=null!==n,i="object"==typeof n,o=!Array.isArray(n),s=void 0!==e[r]&&null!==e[r];t&&i&&o&&s?this.mergeUpdates(e[r],n):e[r]=n}else null!==n&&(e[r]=n)})),e}mergeRemovals(e,t){this.logger.trace("Remove updated entries in cache");const r=e.Account?this.mergeRemovalsDict(e.Account,t.Account):e.Account,n=e.AccessToken?this.mergeRemovalsDict(e.AccessToken,t.AccessToken):e.AccessToken,i=e.RefreshToken?this.mergeRemovalsDict(e.RefreshToken,t.RefreshToken):e.RefreshToken,o=e.IdToken?this.mergeRemovalsDict(e.IdToken,t.IdToken):e.IdToken,s=e.AppMetadata?this.mergeRemovalsDict(e.AppMetadata,t.AppMetadata):e.AppMetadata;return{...e,Account:r,AccessToken:n,RefreshToken:i,IdToken:o,AppMetadata:s}}mergeRemovalsDict(e,t){const r={...e};return Object.keys(e).forEach((e=>{t&&t.hasOwnProperty(e)||delete r[e]})),r}overlayDefaults(e){return this.logger.trace("Overlaying input cache with the default cache"),{Account:{...lo,...e.Account},IdToken:{...ho,...e.IdToken},AccessToken:{...fo,...e.AccessToken},RefreshToken:{...po,...e.RefreshToken},AppMetadata:{...go,...e.AppMetadata}}}}var vo=r(4040);class yo{static fromAssertion(e){const t=new yo;return t.jwt=e,t}static fromCertificate(e,t,r){const n=new yo;return n.privateKey=t,n.thumbprint=e,n.useSha256=!1,r&&(n.publicCertificate=this.parseCertificate(r)),n}static fromCertificateWithSha256Thumbprint(e,t,r){const n=new yo;return n.privateKey=t,n.thumbprint=e,n.useSha256=!0,r&&(n.publicCertificate=this.parseCertificate(r)),n}getJwt(e,t,r){if(this.privateKey&&this.thumbprint)return this.jwt&&!this.isExpired()&&t===this.issuer&&r===this.jwtAudience?this.jwt:this.createJwt(e,t,r);if(this.jwt)return this.jwt;throw Ue(Ce)}createJwt(e,t,r){this.issuer=t,this.jwtAudience=r;const n=We();this.expirationTime=n+600;const i={alg:this.useSha256?"PS256":"RS256"},o=this.useSha256?"x5t#S256":"x5t";Object.assign(i,{[o]:io.base64EncodeUrl(this.thumbprint,"hex")}),this.publicCertificate&&Object.assign(i,{x5c:this.publicCertificate});const s={aud:this.jwtAudience,exp:this.expirationTime,iss:this.issuer,sub:this.issuer,nbf:n,jti:e.createNewGuid()};return this.jwt=vo.sign(s,this.privateKey,{header:i}),this.jwt}isExpired(){return this.expirationTime<We()}static parseCertificate(e){const t=/-----BEGIN CERTIFICATE-----\r*\n(.+?)\r*\n-----END CERTIFICATE-----/gs,r=[];let n;for(;null!==(n=t.exec(e));)r.push(n[1].replace(/\r*\n/g,u.EMPTY_STRING));return r}}const wo="@azure/msal-node",Co="2.16.2";class Io extends Hn{constructor(e){super(e)}async acquireToken(e){this.logger.info("in acquireToken call in username-password client");const t=We(),r=await this.executeTokenRequest(this.authority,e),n=new ii(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return n.validateTokenResponse(r.body),n.handleServerTokenResponse(r.body,this.authority,t,e)}async executeTokenRequest(e,t){const r=this.createTokenQueryParameters(t),n=$t.appendQueryString(e.tokenEndpoint,r),i=await this.createTokenRequestBody(t),o=this.createTokenRequestHeaders({credential:t.username,type:Nn}),s={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return this.executePostToTokenEndpoint(n,i,o,s,t.correlationId)}async createTokenRequestBody(e){const t=new Ln;t.addClientId(this.config.authOptions.clientId),t.addUsername(e.username),t.addPassword(e.password),t.addScopes(e.scopes),t.addResponseTypeForTokenAndIdToken(),t.addGrantType("password"),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager);const r=e.correlationId||this.config.cryptoInterface.createNewGuid();t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret);const n=this.config.clientCredentials.clientAssertion;return n&&(t.addClientAssertion(await oi(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(n.assertionType)),(!Ft.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.username&&t.addCcsUpn(e.username),t.createQueryString()}}class Ao{constructor(e){this.config=function({auth:e,broker:t,cache:r,system:n,telemetry:i}){const o={...eo,networkClient:new hi(n?.proxyUrl,n?.customAgentOptions),loggerOptions:n?.loggerOptions||Zi,disableInternalRetries:n?.disableInternalRetries||!1};if(e.clientCertificate&&!e.clientCertificate.thumbprint&&!e.clientCertificate.thumbprintSha256)throw Yi.createStateNotFoundError();return{auth:{...Qi,...e},broker:{...t},cache:{...Ji,...r},system:{...o,...n},telemetry:{...to,...i}}}(e),this.cryptoProvider=new co,this.logger=new Hr(this.config.system.loggerOptions,wo,Co),this.storage=new uo(this.logger,this.config.auth.clientId,this.cryptoProvider,function(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(e){throw Ut(Et)}return{canonicalAuthority:e.authority?An(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth)),this.tokenCache=new mo(this.storage,this.logger,this.config.cache.cachePlugin)}async getAuthCodeUrl(e){this.logger.info("getAuthCodeUrl called",e.correlationId);const t={...e,...await this.initializeBaseRequest(e),responseMode:e.responseMode||I.QUERY,authenticationScheme:x.BEARER},r=await this.buildOauthClientConfiguration(t.authority,t.correlationId,t.redirectUri,void 0,void 0,e.azureCloudOptions),n=new si(r);return this.logger.verbose("Auth code client created",t.correlationId),n.getAuthCodeUrl(t)}async acquireTokenByCode(e,t){this.logger.info("acquireTokenByCode called"),e.state&&t&&(this.logger.info("acquireTokenByCode - validating state"),this.validateState(e.state,t.state||""),t={...t,state:""});const r={...e,...await this.initializeBaseRequest(e),authenticationScheme:x.BEARER},n=this.initializeServerTelemetryManager(871,r.correlationId);try{const i=await this.buildOauthClientConfiguration(r.authority,r.correlationId,r.redirectUri,n,void 0,e.azureCloudOptions),o=new si(i);return this.logger.verbose("Auth code client created",r.correlationId),await o.acquireToken(r,t)}catch(e){throw e instanceof $&&e.setCorrelationId(r.correlationId),n.cacheFailedRequest(e),e}}async acquireTokenByRefreshToken(e){this.logger.info("acquireTokenByRefreshToken called",e.correlationId);const t={...e,...await this.initializeBaseRequest(e),authenticationScheme:x.BEARER},r=this.initializeServerTelemetryManager(872,t.correlationId);try{const n=await this.buildOauthClientConfiguration(t.authority,t.correlationId,t.redirectUri||"",r,void 0,e.azureCloudOptions),i=new ai(n);return this.logger.verbose("Refresh token client created",t.correlationId),await i.acquireToken(t)}catch(e){throw e instanceof $&&e.setCorrelationId(t.correlationId),r.cacheFailedRequest(e),e}}async acquireTokenSilent(e){const t={...e,...await this.initializeBaseRequest(e),forceRefresh:e.forceRefresh||!1},r=this.initializeServerTelemetryManager(62,t.correlationId,t.forceRefresh);try{const n=await this.buildOauthClientConfiguration(t.authority,t.correlationId,t.redirectUri||"",r,void 0,e.azureCloudOptions),i=new ci(n);return this.logger.verbose("Silent flow client created",t.correlationId),await i.acquireToken(t)}catch(e){throw e instanceof $&&e.setCorrelationId(t.correlationId),r.cacheFailedRequest(e),e}}async acquireTokenByUsernamePassword(e){this.logger.info("acquireTokenByUsernamePassword called",e.correlationId);const t={...e,...await this.initializeBaseRequest(e)},r=this.initializeServerTelemetryManager(371,t.correlationId);try{const n=await this.buildOauthClientConfiguration(t.authority,t.correlationId,"",r,void 0,e.azureCloudOptions),i=new Io(n);return this.logger.verbose("Username password client created",t.correlationId),await i.acquireToken(t)}catch(e){throw e instanceof $&&e.setCorrelationId(t.correlationId),r.cacheFailedRequest(e),e}}getTokenCache(){return this.logger.info("getTokenCache called"),this.tokenCache}validateState(e,t){if(!e)throw Yi.createStateNotFoundError();if(e!==t)throw Ue(Z)}getLogger(){return this.logger}setLogger(e){this.logger=e}async buildOauthClientConfiguration(e,t,r,n,i,o){this.logger.verbose("buildOauthClientConfiguration called",t);const s=o||this.config.auth.azureCloudOptions,a=await this.createAuthority(e,t,i,s);return this.logger.info(`Building oauth client configuration with the following authority: ${a.tokenEndpoint}.`,t),n?.updateRegionDiscoveryMetadata(a.regionDiscoveryMetadata),{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:r},loggerOptions:{logLevel:this.config.system.loggerOptions.logLevel,loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,correlationId:t},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.cryptoProvider,networkInterface:this.config.system.networkClient,storageInterface:this.storage,serverTelemetryManager:n,clientCredentials:{clientSecret:this.clientSecret,clientAssertion:await this.getClientAssertion(a)},libraryInfo:{sku:Sr,version:Co,cpu:process.arch||u.EMPTY_STRING,os:process.platform||u.EMPTY_STRING},telemetry:this.config.telemetry,persistencePlugin:this.config.cache.cachePlugin,serializableCache:this.tokenCache}}async getClientAssertion(e){return this.developerProvidedClientAssertion&&(this.clientAssertion=yo.fromAssertion(await oi(this.developerProvidedClientAssertion,this.config.auth.clientId,e.tokenEndpoint))),this.clientAssertion&&{assertion:this.clientAssertion.getJwt(this.cryptoProvider,this.config.auth.clientId,e.tokenEndpoint),assertionType:Er}}async initializeBaseRequest(e){return this.logger.verbose("initializeRequestScopes called",e.correlationId),e.authenticationScheme&&e.authenticationScheme===x.POP&&this.logger.verbose("Authentication Scheme 'pop' is not supported yet, setting Authentication Scheme to 'Bearer' for request",e.correlationId),e.authenticationScheme=x.BEARER,this.config.cache.claimsBasedCachingEnabled&&e.claims&&!Ft.isEmptyObj(e.claims)&&(e.requestedClaimsHash=await this.cryptoProvider.hashString(e.claims)),{...e,scopes:[...e&&e.scopes||[],...l],correlationId:e&&e.correlationId||this.cryptoProvider.createNewGuid(),authority:e.authority||this.config.auth.authority}}initializeServerTelemetryManager(e,t,r){const n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1};return new Pr(n,this.storage)}async createAuthority(e,t,r,n){this.logger.verbose("createAuthority called",t);const i=In.generateAuthority(e,n),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,azureRegionConfiguration:r,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};return Un(i,this.config.system.networkClient,this.storage,o,this.logger,t)}clearCache(){this.storage.clear()}}class So{async listenForAuthCode(e,t){if(this.server)throw Yi.createLoopbackServerAlreadyExistsError();return new Promise(((r,n)=>{this.server=li.createServer(((i,o)=>{const s=i.url;if(!s)return o.end(t||"Error occurred loading redirectUrl"),void n(Yi.createUnableToLoadRedirectUrlError());if(s===u.FORWARD_SLASH)return void o.end(e||"Auth code was successfully acquired. You can close this window now.");const a=this.getRedirectUri(),c=Bt(new URL(s,a).search)||{};c.code&&(o.writeHead(302,{location:a}),o.end()),c.error&&o.end(t||`Error occurred: ${c.error}`),r(c)})),this.server.listen(0,"127.0.0.1")}))}getRedirectUri(){if(!this.server||!this.server.listening)throw Yi.createNoLoopbackServerExistsError();const e=this.server.address();if(!e||"string"==typeof e||!e.port)throw this.closeServer(),Yi.createInvalidLoopbackAddressTypeError();const t=e&&e.port;return`${_r}${br}:${t}`}closeServer(){this.server&&(this.server.close(),"function"==typeof this.server.closeAllConnections&&this.server.closeAllConnections(),this.server.unref(),this.server=void 0)}}class Eo extends Hn{constructor(e){super(e)}async acquireToken(e){const t=await this.getDeviceCode(e);e.deviceCodeCallback(t);const r=We(),n=await this.acquireTokenWithDeviceCode(e,t),i=new ii(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n),i.handleServerTokenResponse(n,this.authority,r,e)}async getDeviceCode(e){const t=this.createExtraQueryParameters(e),r=$t.appendQueryString(this.authority.deviceCodeEndpoint,t),n=this.createQueryString(e),i=this.createTokenRequestHeaders(),o={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return this.executePostRequestToDeviceCodeEndpoint(r,n,i,o,e.correlationId)}createExtraQueryParameters(e){const t=new Ln;return e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()}async executePostRequestToDeviceCodeEndpoint(e,t,r,n,i){const{body:{user_code:o,device_code:s,verification_uri:a,expires_in:c,interval:u,message:l}}=await this.sendPostRequest(n,e,{body:t,headers:r},i);return{userCode:o,deviceCode:s,verificationUri:a,expiresIn:c,interval:u,message:l}}createQueryString(e){const t=new Ln;return t.addScopes(e.scopes),t.addClientId(this.config.authOptions.clientId),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}continuePolling(e,t,r){if(r)throw this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),Ue(de);if(t&&t<e&&We()>t)throw this.logger.error(`User defined timeout for device code polling reached. The timeout was set for ${t}`),Ue(Se);if(We()>e)throw t&&this.logger.verbose(`User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for ${t}`),this.logger.error(`Device code expired. Expiration time of device code was ${e}`),Ue(he);return!0}async acquireTokenWithDeviceCode(e,t){const r=this.createTokenQueryParameters(e),n=$t.appendQueryString(this.authority.tokenEndpoint,r),i=this.createTokenRequestBody(e,t),o=this.createTokenRequestHeaders(),s=e.timeout?We()+e.timeout:void 0,a=We()+t.expiresIn,c=1e3*t.interval;for(;this.continuePolling(a,s,e.cancel);){const t={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},r=await this.executePostToTokenEndpoint(n,i,o,t,e.correlationId);if(!r.body||!r.body.error)return this.logger.verbose("Authorization completed successfully. Polling stopped."),r.body;if(r.body.error!==u.AUTHORIZATION_PENDING)throw this.logger.info("Unexpected error in polling from the server"),l=H,d=r.body.error,new $(l,d?`${j[l]} ${d}`:j[l]);this.logger.info("Authorization pending. Continue polling."),await Ye(c)}var l,d;throw this.logger.error("Polling stopped for unknown reasons."),Ue(fe)}createTokenRequestBody(e,t){const r=new Ln;r.addScopes(e.scopes),r.addClientId(this.config.authOptions.clientId),r.addGrantType("device_code"),r.addDeviceCode(t.deviceCode);const n=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(n),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&r.addServerTelemetry(this.serverTelemetryManager),(!Ft.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),r.createQueryString()}}class To extends Ao{constructor(e){super(e),this.config.broker.nativeBrokerPlugin&&(this.config.broker.nativeBrokerPlugin.isBrokerAvailable?(this.nativeBrokerPlugin=this.config.broker.nativeBrokerPlugin,this.nativeBrokerPlugin.setLogger(this.config.system.loggerOptions)):this.logger.warning("NativeBroker implementation was provided but the broker is unavailable.")),this.skus=Pr.makeExtraSkuString({libraryName:Sr,libraryVersion:Co})}async acquireTokenByDeviceCode(e){this.logger.info("acquireTokenByDeviceCode called",e.correlationId);const t=Object.assign(e,await this.initializeBaseRequest(e)),r=this.initializeServerTelemetryManager(671,t.correlationId);try{const n=await this.buildOauthClientConfiguration(t.authority,t.correlationId,"",r,void 0,e.azureCloudOptions),i=new Eo(n);return this.logger.verbose("Device code client created",t.correlationId),await i.acquireToken(t)}catch(e){throw e instanceof $&&e.setCorrelationId(t.correlationId),r.cacheFailedRequest(e),e}}async acquireTokenInteractive(e){const t=e.correlationId||this.cryptoProvider.createNewGuid();this.logger.trace("acquireTokenInteractive called",t);const{openBrowser:r,successTemplate:n,errorTemplate:i,windowHandle:o,loopbackClient:s,...a}=e;if(this.nativeBrokerPlugin){const r={...a,clientId:this.config.auth.clientId,scopes:e.scopes||l,redirectUri:`${_r}${br}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...a.extraQueryParameters,...a.tokenQueryParameters,[Lr]:this.skus},accountId:a.account?.nativeAccountId};return this.nativeBrokerPlugin.acquireTokenInteractive(r,o)}const{verifier:c,challenge:d}=await this.cryptoProvider.generatePkceCodes(),h=s||new So;let f={},p=null;try{const o=h.listenForAuthCode(n,i).then((e=>{f=e})).catch((e=>{p=e})),s=await this.waitForRedirectUri(h),g={...a,correlationId:t,scopes:e.scopes||l,redirectUri:s,responseMode:I.QUERY,codeChallenge:d,codeChallengeMethod:C.S256},m=await this.getAuthCodeUrl(g);if(await r(m),await o,p)throw p;if(f.error)throw new Fr(f.error,f.error_description,f.suberror);if(!f.code)throw Yi.createNoAuthCodeInResponseError();const v=f.client_info,y={code:f.code,codeVerifier:c,clientInfo:v||u.EMPTY_STRING,...g};return await this.acquireTokenByCode(y)}finally{h.closeServer()}}async acquireTokenSilent(e){const t=e.correlationId||this.cryptoProvider.createNewGuid();if(this.logger.trace("acquireTokenSilent called",t),this.nativeBrokerPlugin){const r={...e,clientId:this.config.auth.clientId,scopes:e.scopes||l,redirectUri:`${_r}${br}`,authority:e.authority||this.config.auth.authority,correlationId:t,extraParameters:{...e.tokenQueryParameters,[Lr]:this.skus},accountId:e.account.nativeAccountId,forceRefresh:e.forceRefresh||!1};return this.nativeBrokerPlugin.acquireTokenSilent(r)}return super.acquireTokenSilent(e)}async signOut(e){if(this.nativeBrokerPlugin&&e.account.nativeAccountId){const t={clientId:this.config.auth.clientId,accountId:e.account.nativeAccountId,correlationId:e.correlationId||this.cryptoProvider.createNewGuid()};await this.nativeBrokerPlugin.signOut(t)}await this.getTokenCache().removeAccount(e.account)}async getAllAccounts(){if(this.nativeBrokerPlugin){const e=this.cryptoProvider.createNewGuid();return this.nativeBrokerPlugin.getAllAccounts(this.config.auth.clientId,e)}return this.getTokenCache().getAllAccounts()}async waitForRedirectUri(e){return new Promise(((t,r)=>{let n=0;const i=setInterval((()=>{if(50<n)return clearInterval(i),void r(Yi.createLoopbackServerTimeoutError());try{const r=e.getRedirectUri();return clearInterval(i),void t(r)}catch(e){return e instanceof $&&e.errorCode===Hi?void n++:(clearInterval(i),void r(e))}}),100)}))}}class _o extends Hn{constructor(e,t){super(e),this.appTokenProvider=t}async acquireToken(e){if(e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority);const[t,r]=await this.getCachedAuthenticationResult(e,this.config,this.cryptoUtils,this.authority,this.cacheManager,this.serverTelemetryManager);if(t){if(r===F){this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");const t=!0;await this.executeTokenRequest(e,this.authority,t)}return t}return this.executeTokenRequest(e,this.authority)}async getCachedAuthenticationResult(e,t,r,n,i,o){const s=t,a=t;let c,u=D;s.serializableCache&&s.persistencePlugin&&(c=new ni(s.serializableCache,!1),await s.persistencePlugin.beforeCacheAccess(c));const l=this.readAccessTokenFromCache(n,a.managedIdentityId?.id||s.authOptions.clientId,new qt(e.scopes||[]),i);return s.serializableCache&&s.persistencePlugin&&c&&await s.persistencePlugin.afterCacheAccess(c),l?Xe(l.expiresOn,s.systemOptions?.tokenRenewalOffsetSeconds||300)?(o?.setCacheOutcome(U),[null,U]):(l.refreshOn&&Xe(l.refreshOn.toString(),0)&&(u=F,o?.setCacheOutcome(F)),[await ii.generateAuthenticationResult(r,n,{account:null,idToken:null,accessToken:l,refreshToken:null,appMetadata:null},!0,e),u]):(o?.setCacheOutcome(L),[null,L])}readAccessTokenFromCache(e,t,r,n){const i={homeAccountId:u.EMPTY_STRING,environment:e.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:E.ACCESS_TOKEN,clientId:t,realm:e.tenant,target:qt.createSearchScopes(r.asArray())},o=n.getAccessTokensByFilter(i);if(o.length<1)return null;if(o.length>1)throw Ue(ie);return o[0]}async executeTokenRequest(e,t,r){let n,i;if(this.appTokenProvider){this.logger.info("Using appTokenProvider extensibility.");const t={correlationId:e.correlationId,tenantId:this.config.authOptions.authority.tenant,scopes:e.scopes,claims:e.claims};i=We();const r=await this.appTokenProvider(t);n={access_token:r.accessToken,expires_in:r.expiresInSeconds,refresh_in:r.refreshInSeconds,token_type:x.BEARER}}else{const r=this.createTokenQueryParameters(e),o=$t.appendQueryString(t.tokenEndpoint,r),s=await this.createTokenRequestBody(e),a=this.createTokenRequestHeaders(),c={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};this.logger.info("Sending token request to endpoint: "+t.tokenEndpoint),i=We();const u=await this.executePostToTokenEndpoint(o,s,a,c,e.correlationId);n=u.body,n.status=u.status}const o=new ii(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n,r),await o.handleServerTokenResponse(n,this.authority,i,e)}async createTokenRequestBody(e){const t=new Ln;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes,!1),t.addGrantType("client_credentials"),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager);const r=e.correlationId||this.config.cryptoInterface.createNewGuid();t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret);const n=e.clientAssertion||this.config.clientCredentials.clientAssertion;return n&&(t.addClientAssertion(await oi(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(n.assertionType)),(!Ft.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}}class bo extends Hn{constructor(e){super(e)}async acquireToken(e){if(this.scopeSet=new qt(e.scopes||[]),this.userAssertionHash=await this.cryptoUtils.hashString(e.oboAssertion),e.skipCache||e.claims)return this.executeTokenRequest(e,this.authority,this.userAssertionHash);try{return await this.getCachedAuthenticationResult(e)}catch(t){return await this.executeTokenRequest(e,this.authority,this.userAssertionHash)}}async getCachedAuthenticationResult(e){const t=this.readAccessTokenFromCacheForOBO(this.config.authOptions.clientId,e);if(!t)throw this.serverTelemetryManager?.setCacheOutcome(L),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),Ue(Ae);if(Xe(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.serverTelemetryManager?.setCacheOutcome(U),this.logger.info(`OnbehalfofFlow:getCachedAuthenticationResult - Cached access token is expired or will expire within ${this.config.systemOptions.tokenRenewalOffsetSeconds} seconds.`),Ue(Ae);const r=this.readIdTokenFromCacheForOBO(t.homeAccountId);let n,i=null;if(r){n=Ke(r.secret,io.base64Decode);const e=n.oid||n.sub,t={homeAccountId:r.homeAccountId,environment:r.environment,tenantId:r.realm,username:u.EMPTY_STRING,localAccountId:e||u.EMPTY_STRING};i=this.cacheManager.readAccountFromCache(t)}return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),ii.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:i,accessToken:t,idToken:r,refreshToken:null,appMetadata:null},!0,e,n)}readIdTokenFromCacheForOBO(e){const t={homeAccountId:e,environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:E.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant},r=this.cacheManager.getIdTokensByFilter(t);return Object.values(r).length<1?null:Object.values(r)[0]}readAccessTokenFromCacheForOBO(e,t){const r=t.authenticationScheme||x.BEARER,n={credentialType:r&&r.toLowerCase()!==x.BEARER.toLowerCase()?E.ACCESS_TOKEN_WITH_AUTH_SCHEME:E.ACCESS_TOKEN,clientId:e,target:qt.createSearchScopes(this.scopeSet.asArray()),tokenType:r,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash,userAssertionHash:this.userAssertionHash},i=this.cacheManager.getAccessTokensByFilter(n),o=i.length;if(o<1)return null;if(o>1)throw Ue(ie);return i[0]}async executeTokenRequest(e,t,r){const n=this.createTokenQueryParameters(e),i=$t.appendQueryString(t.tokenEndpoint,n),o=await this.createTokenRequestBody(e),s=this.createTokenRequestHeaders(),a={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid},c=We(),u=await this.executePostToTokenEndpoint(i,o,s,a,e.correlationId),l=new ii(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return l.validateTokenResponse(u.body),await l.handleServerTokenResponse(u.body,this.authority,c,e,void 0,r)}async createTokenRequestBody(e){const t=new Ln;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType("urn:ietf:params:oauth:grant-type:jwt-bearer"),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager);const r=e.correlationId||this.config.cryptoInterface.createNewGuid();t.addCorrelationId(r),t.addRequestTokenUse("on_behalf_of"),t.addOboAssertion(e.oboAssertion),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret);const n=this.config.clientCredentials.clientAssertion;return n&&(t.addClientAssertion(await oi(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(n.assertionType)),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}}class ko extends Ao{constructor(e){super(e),this.setClientCredential(),this.appTokenProvider=void 0}SetAppTokenProvider(e){this.appTokenProvider=e}async acquireTokenByClientCredential(e){let t;this.logger.info("acquireTokenByClientCredential called",e.correlationId),e.clientAssertion&&(t={assertion:await oi(e.clientAssertion,this.config.auth.clientId),assertionType:Er});const r=await this.initializeBaseRequest(e),n={...r,scopes:r.scopes.filter((e=>!l.includes(e)))},i={...e,...n,clientAssertion:t},o=new $t(i.authority).getUrlComponents().PathSegments[0];if(Object.values(v).includes(o))throw Ue(Oe);const s=process.env.MSAL_FORCE_REGION;let a;"DisableMsalForceRegion"!==i.azureRegion&&(a=!i.azureRegion&&s?s:i.azureRegion);const c={azureRegion:a,environmentRegion:process.env.REGION_NAME},u=this.initializeServerTelemetryManager(771,i.correlationId,i.skipCache);try{const t=await this.buildOauthClientConfiguration(i.authority,i.correlationId,"",u,c,e.azureCloudOptions),r=new _o(t,this.appTokenProvider);return this.logger.verbose("Client credential client created",i.correlationId),await r.acquireToken(i)}catch(e){throw e instanceof $&&e.setCorrelationId(i.correlationId),u.cacheFailedRequest(e),e}}async acquireTokenOnBehalfOf(e){this.logger.info("acquireTokenOnBehalfOf called",e.correlationId);const t={...e,...await this.initializeBaseRequest(e)};try{const r=await this.buildOauthClientConfiguration(t.authority,t.correlationId,"",void 0,void 0,e.azureCloudOptions),n=new bo(r);return this.logger.verbose("On behalf of client created",t.correlationId),await n.acquireToken(t)}catch(e){throw e instanceof $&&e.setCorrelationId(t.correlationId),e}}setClientCredential(){const e=!!this.config.auth.clientSecret,t=!!this.config.auth.clientAssertion,r=!(!this.config.auth.clientCertificate?.thumbprint&&!this.config.auth.clientCertificate?.thumbprintSha256||!this.config.auth.clientCertificate?.privateKey);if(!this.appTokenProvider){if(e&&t||t&&r||e&&r)throw Ue(Ie);if(this.config.auth.clientSecret)this.clientSecret=this.config.auth.clientSecret;else if(this.config.auth.clientAssertion)this.developerProvidedClientAssertion=this.config.auth.clientAssertion;else{if(!r)throw Ue(Ie);this.clientAssertion=this.config.auth.clientCertificate.thumbprintSha256?yo.fromCertificateWithSha256Thumbprint(this.config.auth.clientCertificate.thumbprintSha256,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c):yo.fromCertificate(this.config.auth.clientCertificate.thumbprint,this.config.auth.clientCertificate.privateKey,this.config.auth.clientCertificate.x5c)}}}}class Po{constructor(e,t,r,n){this.logger=e,this.nodeStorage=t,this.networkClient=r,this.cryptoProvider=n}async getServerTokenResponseAsync(e,t,r,n){return this.getServerTokenResponse(e)}getServerTokenResponse(e){let t,r;return e.body.expires_on&&(r=e.body.expires_on-We(),r>7200&&(t=r/2)),{status:e.status,access_token:e.body.access_token,expires_in:r,scope:e.body.resource,token_type:e.body.token_type,refresh_in:t,correlation_id:e.body.correlation_id||e.body.correlationId,error:"string"==typeof e.body.error?e.body.error:e.body.error?.code,error_description:e.body.message||("string"==typeof e.body.error?e.body.error_description:e.body.error?.message),error_codes:e.body.error_codes,timestamp:e.body.timestamp,trace_id:e.body.trace_id}}async acquireTokenWithManagedIdentity(e,t,r,n){const i=this.createRequest(e.resource,t),o=i.headers;o[h]=u.URL_FORM_CONTENT_TYPE;const s={headers:o};Object.keys(i.bodyParameters).length&&(s.body=i.computeParametersBodyString());const a=We();let c;try{c=i.httpMethod===yr?await this.networkClient.sendPostRequestAsync(i.computeUri(),s):await this.networkClient.sendGetRequestAsync(i.computeUri(),s)}catch(e){throw e instanceof $?e:Ue(X)}const l=new ii(t.id,this.nodeStorage,this.cryptoProvider,this.logger,null,null),d=await this.getServerTokenResponseAsync(c,this.networkClient,i,s);return l.validateTokenResponse(d,n),l.handleServerTokenResponse(d,r,a,e)}getManagedIdentityUserAssignedIdQueryParameterKey(e){switch(e){case pr:return this.logger.info("[Managed Identity] Adding user assigned client id to the request."),"client_id";case gr:return this.logger.info("[Managed Identity] Adding user assigned resource id to the request."),"mi_res_id";case mr:return this.logger.info("[Managed Identity] Adding user assigned object id to the request."),"object_id";default:throw Ri(yi)}}}Po.getValidatedEnvVariableUrlString=(e,t,r,n)=>{try{return new $t(t).urlString}catch(t){throw n.info(`[Managed Identity] ${r} managed identity is unavailable because the '${e}' environment variable is malformed.`),Ri(bi[e])}};class Ro{constructor(e,t){this.httpMethod=e,this._baseEndpoint=t,this.headers={},this.bodyParameters={},this.queryParameters={}}computeUri(){const e=new Ln;this.queryParameters&&e.addExtraQueryParameters(this.queryParameters);const t=e.createQueryString();return $t.appendQueryString(this._baseEndpoint,t)}computeParametersBodyString(){const e=new Ln;return this.bodyParameters&&e.addExtraQueryParameters(this.bodyParameters),e.createQueryString()}}class Oo extends Po{constructor(e,t,r,n,i,o){super(e,t,r,n),this.identityEndpoint=i,this.identityHeader=o}static getEnvironmentVariables(){return[process.env[ar],process.env[cr]]}static tryCreate(e,t,r,n){const[i,o]=Oo.getEnvironmentVariables();if(!i||!o)return e.info(`[Managed Identity] ${hr.APP_SERVICE} managed identity is unavailable because one or both of the '${cr}' and '${ar}' environment variables are not defined.`),null;const s=Oo.getValidatedEnvVariableUrlString(ar,i,hr.APP_SERVICE,e);return e.info(`[Managed Identity] Environment variables validation passed for ${hr.APP_SERVICE} managed identity. Endpoint URI: ${s}. Creating ${hr.APP_SERVICE} managed identity.`),new Oo(e,t,r,n,i,o)}createRequest(e,t){const r=new Ro(vr,this.identityEndpoint);return r.headers["X-IDENTITY-HEADER"]=this.identityHeader,r.queryParameters[nr]="2019-08-01",r.queryParameters[ir]=e,t.idType!==fr&&(r.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),r}}var Mo=r(9896),xo=r(6928);const No="http://127.0.0.1:40342/metadata/identity/oauth2/token",Do="N/A: himds executable exists",Lo={win32:`${process.env.ProgramData}\\AzureConnectedMachineAgent\\Tokens\\`,linux:"/var/opt/azcmagent/tokens/"},Uo={win32:`${process.env.ProgramFiles}\\AzureConnectedMachineAgent\\himds.exe`,linux:"/opt/azcmagent/bin/himds"};class Fo extends Po{constructor(e,t,r,n,i){super(e,t,r,n),this.identityEndpoint=i}static getEnvironmentVariables(){let e=process.env[ar],t=process.env[lr];if(!e||!t){const r=Uo[process.platform];try{(0,Mo.accessSync)(r,Mo.constants.F_OK|Mo.constants.R_OK),e=No,t=Do}catch(e){}}return[e,t]}static tryCreate(e,t,r,n,i){const[o,s]=Fo.getEnvironmentVariables();if(!o||!s)return e.info(`[Managed Identity] ${hr.AZURE_ARC} managed identity is unavailable through environment variables because one or both of '${ar}' and '${lr}' are not defined. ${hr.AZURE_ARC} managed identity is also unavailable through file detection.`),null;if(s===Do)e.info(`[Managed Identity] ${hr.AZURE_ARC} managed identity is available through file detection. Defaulting to known ${hr.AZURE_ARC} endpoint: ${No}. Creating ${hr.AZURE_ARC} managed identity.`);else{const t=Fo.getValidatedEnvVariableUrlString(ar,o,hr.AZURE_ARC,e);t.endsWith("/")&&t.slice(0,-1),Fo.getValidatedEnvVariableUrlString(lr,s,hr.AZURE_ARC,e),e.info(`[Managed Identity] Environment variables validation passed for ${hr.AZURE_ARC} managed identity. Endpoint URI: ${t}. Creating ${hr.AZURE_ARC} managed identity.`)}if(i.idType!==fr)throw Ri(Ii);return new Fo(e,t,r,n,o)}createRequest(e){const t=new Ro(vr,this.identityEndpoint.replace("localhost","127.0.0.1"));return t.headers[rr]="true",t.queryParameters[nr]="2019-11-01",t.queryParameters[ir]=e,t}async getServerTokenResponseAsync(e,t,r,n){let i;if(401===e.status){const o=e.headers["www-authenticate"];if(!o)throw Ri(Ti);if(!o.includes("Basic realm="))throw Ri(_i);const s=o.split("Basic realm=")[1];if(!Lo.hasOwnProperty(process.platform))throw Ri(Ci);const a=Lo[process.platform],c=xo.basename(s);if(!c.endsWith(".key"))throw Ri(mi);if(a+c!==s)throw Ri(vi);let u,l;try{u=await(0,Mo.statSync)(s).size}catch(e){throw Ri(Ei)}if(u>4096)throw Ri(wi);try{l=(0,Mo.readFileSync)(s,"utf-8")}catch(e){throw Ri(Ei)}const d=`Basic ${l}`;this.logger.info("[Managed Identity] Adding authorization header to the request."),r.headers.Authorization=d;try{i=await t.sendGetRequestAsync(r.computeUri(),n)}catch(e){throw e instanceof $?e:Ue(X)}}return this.getServerTokenResponse(i||e)}}class qo extends Po{constructor(e,t,r,n,i){super(e,t,r,n),this.msiEndpoint=i}static getEnvironmentVariables(){return[process.env[dr]]}static tryCreate(e,t,r,n,i){const[o]=qo.getEnvironmentVariables();if(!o)return e.info(`[Managed Identity] ${hr.CLOUD_SHELL} managed identity is unavailable because the '${dr} environment variable is not defined.`),null;const s=qo.getValidatedEnvVariableUrlString(dr,o,hr.CLOUD_SHELL,e);if(e.info(`[Managed Identity] Environment variable validation passed for ${hr.CLOUD_SHELL} managed identity. Endpoint URI: ${s}. Creating ${hr.CLOUD_SHELL} managed identity.`),i.idType!==fr)throw Ri(Ai);return new qo(e,t,r,n,o)}createRequest(e){const t=new Ro(yr,this.msiEndpoint);return t.headers[rr]="true",t.bodyParameters[ir]=e,t}}const Ho="/metadata/identity/oauth2/token",jo=`http://169.254.169.254${Ho}`;class Bo extends Po{constructor(e,t,r,n,i){super(e,t,r,n),this.identityEndpoint=i}static tryCreate(e,t,r,n){let i;return process.env[sr]?(e.info(`[Managed Identity] Environment variable ${sr} for ${hr.IMDS} returned endpoint: ${process.env[sr]}`),i=Bo.getValidatedEnvVariableUrlString(sr,`${process.env[sr]}${Ho}`,hr.IMDS,e)):(e.info(`[Managed Identity] Unable to find ${sr} environment variable for ${hr.IMDS}, using the default endpoint.`),i=jo),new Bo(e,t,r,n,i)}createRequest(e,t){const r=new Ro(vr,this.identityEndpoint);return r.headers[rr]="true",r.queryParameters[nr]="2018-02-01",r.queryParameters[ir]=e,t.idType!==fr&&(r.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),r}}class $o extends Po{constructor(e,t,r,n,i,o){super(e,t,r,n),this.identityEndpoint=i,this.identityHeader=o}static getEnvironmentVariables(){return[process.env[ar],process.env[cr],process.env[ur]]}static tryCreate(e,t,r,n,i){const[o,s,a]=$o.getEnvironmentVariables();if(!o||!s||!a)return e.info(`[Managed Identity] ${hr.SERVICE_FABRIC} managed identity is unavailable because one or all of the '${cr}', '${ar}' or '${ur}' environment variables are not defined.`),null;const c=$o.getValidatedEnvVariableUrlString(ar,o,hr.SERVICE_FABRIC,e);return e.info(`[Managed Identity] Environment variables validation passed for ${hr.SERVICE_FABRIC} managed identity. Endpoint URI: ${c}. Creating ${hr.SERVICE_FABRIC} managed identity.`),i.idType!==fr&&e.warning(`[Managed Identity] ${hr.SERVICE_FABRIC} user assigned managed identity is configured in the cluster, not during runtime. See also: https://learn.microsoft.com/en-us/azure/service-fabric/configure-existing-cluster-enable-managed-identity-token-service.`),new $o(e,t,r,n,o,s)}createRequest(e,t){const r=new Ro(vr,this.identityEndpoint);return r.headers.secret=this.identityHeader,r.queryParameters[nr]="2019-07-01-preview",r.queryParameters[ir]=e,t.idType!==fr&&(r.queryParameters[this.getManagedIdentityUserAssignedIdQueryParameterKey(t.idType)]=t.id),r}}class zo{constructor(e,t,r,n){this.logger=e,this.nodeStorage=t,this.networkClient=r,this.cryptoProvider=n}async sendManagedIdentityTokenRequest(e,t,r,n){return zo.identitySource||(zo.identitySource=this.selectManagedIdentitySource(this.logger,this.nodeStorage,this.networkClient,this.cryptoProvider,t)),zo.identitySource.acquireTokenWithManagedIdentity(e,t,r,n)}allEnvironmentVariablesAreDefined(e){return Object.values(e).every((e=>void 0!==e))}getManagedIdentitySource(){return zo.sourceName=this.allEnvironmentVariablesAreDefined($o.getEnvironmentVariables())?hr.SERVICE_FABRIC:this.allEnvironmentVariablesAreDefined(Oo.getEnvironmentVariables())?hr.APP_SERVICE:this.allEnvironmentVariablesAreDefined(qo.getEnvironmentVariables())?hr.CLOUD_SHELL:this.allEnvironmentVariablesAreDefined(Fo.getEnvironmentVariables())?hr.AZURE_ARC:hr.DEFAULT_TO_IMDS,zo.sourceName}selectManagedIdentitySource(e,t,r,n,i){const o=$o.tryCreate(e,t,r,n,i)||Oo.tryCreate(e,t,r,n)||qo.tryCreate(e,t,r,n,i)||Fo.tryCreate(e,t,r,n,i)||Bo.tryCreate(e,t,r,n);if(!o)throw Ri(Si);return o}}class Vo{constructor(e){this.config=function({managedIdentityIdParams:e,system:t}){const r=new Oi(e),n=t?.loggerOptions||Zi;let i;if(i=t?.networkClient?t.networkClient:new hi(t?.proxyUrl,t?.customAgentOptions),!t?.disableInternalRetries){const e=new Mi(3,1e3,kr);i=new xi(i,e)}return{managedIdentityId:r,system:{loggerOptions:n,networkClient:i}}}(e||{}),this.logger=new Hr(this.config.system.loggerOptions,wo,Co);const t={canonicalAuthority:u.DEFAULT_AUTHORITY};Vo.nodeStorage||(Vo.nodeStorage=new uo(this.logger,this.config.managedIdentityId.id,Sn,t)),this.networkClient=this.config.system.networkClient,this.cryptoProvider=new co;const r={protocolMode:ze.AAD,knownAuthorities:[or],cloudDiscoveryMetadata:"",authorityMetadata:""};this.fakeAuthority=new In(or,this.networkClient,Vo.nodeStorage,r,this.logger,this.cryptoProvider.createNewGuid(),void 0,!0),this.fakeClientCredentialClient=new _o({authOptions:{clientId:this.config.managedIdentityId.id,authority:this.fakeAuthority}}),this.managedIdentityClient=new zo(this.logger,Vo.nodeStorage,this.networkClient,this.cryptoProvider)}async acquireToken(e){if(!e.resource)throw Ut(mt);const t={forceRefresh:e.forceRefresh,resource:e.resource.replace("/.default",""),scopes:[e.resource.replace("/.default","")],authority:this.fakeAuthority.canonicalAuthority,correlationId:this.cryptoProvider.createNewGuid()};if(e.claims||t.forceRefresh)return this.managedIdentityClient.sendManagedIdentityTokenRequest(t,this.config.managedIdentityId,this.fakeAuthority);const[r,n]=await this.fakeClientCredentialClient.getCachedAuthenticationResult(t,this.config,this.cryptoProvider,this.fakeAuthority,Vo.nodeStorage);if(r){if(n===F){this.logger.info("ClientCredentialClient:getCachedAuthenticationResult - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");const e=!0;await this.managedIdentityClient.sendManagedIdentityTokenRequest(t,this.config.managedIdentityId,this.fakeAuthority,e)}return r}return this.managedIdentityClient.sendManagedIdentityTokenRequest(t,this.config.managedIdentityId,this.fakeAuthority)}getManagedIdentitySource(){return zo.sourceName||this.managedIdentityClient.getManagedIdentitySource()}}class Ko{constructor(e,t){this.client=e,this.partitionManager=t}async beforeCacheAccess(e){const t=await this.partitionManager.getKey(),r=await this.client.get(t);e.tokenCache.deserialize(r)}async afterCacheAccess(e){if(e.cacheHasChanged){const t=e.tokenCache.getKVStore(),r=Object.values(t).filter((e=>Ve.isAccountEntity(e)));let n;if(r.length>0){const e=r[0];n=await this.partitionManager.extractKey(e)}else n=await this.partitionManager.getKey();await this.client.set(n,e.tokenCache.serialize())}}}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=r(5256),i=exports;for(var o in n)i[o]=n[o];n.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();
//# sourceMappingURL=https://main.vscode-cdn.net/sourcemaps/258e40fedc6cb8edf399a463ce3a9d32e7e1f6f3/extensions/microsoft-authentication/dist/extension.js.map